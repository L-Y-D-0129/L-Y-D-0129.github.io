<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="ÂâçË®Ä HelloÔºåÂêÑ‰ΩçÂ•ΩÔºåÊàëÊòØÂàòÁÖúÈºéÔºÅ\nËøôÁØáÊñáÊ°£ÈõÜÂêà‰∫Ü‰∏Ä‰∫õRedisÁü•ËØÜ\n‰∏ªË¶Å‰∏∫Êï∞ÊçÆÁªìÊûÑ„ÄÅÊåÅ‰πÖÂåñ„ÄÅÈõÜÁæ§„ÄÅÁºìÂ≠òÁ≠âÁõ∏ÂÖ≥Áü•ËØÜ„ÄÇ\nRedisÂ∏∏ËßÅÊï∞ÊçÆÁ±ªÂûãÂíåÂ∫îÁî®Âú∫ÊôØ Redis‰∏≠Â∏∏ËßÅÁöÑÊï∞ÊçÆÁ±ªÂûãÊúâ‰∫îÁßçÔºöStringÔºàÂ≠óÁ¨¶‰∏≤ÔºâÔºåHashÔºàÂìàÂ∏åÔºâÔºåListÔºàÂàóË°®ÔºâÔºåSetÔºàÈõÜÂêàÔºâÔºåZsetÔºàÊúâÂ∫èÈõÜÂêàÔºâ„ÄÇ\n">
<title>Redis</title>

<link rel='canonical' href='https://L-Y-D-0129.github.io/p/redis/'>

<link rel="stylesheet" href="/scss/style.min.663803bebe609202d5b39d848f2d7c2dc8b598a2d879efa079fa88893d29c49c.css"><meta property='og:title' content="Redis">
<meta property='og:description' content="ÂâçË®Ä HelloÔºåÂêÑ‰ΩçÂ•ΩÔºåÊàëÊòØÂàòÁÖúÈºéÔºÅ\nËøôÁØáÊñáÊ°£ÈõÜÂêà‰∫Ü‰∏Ä‰∫õRedisÁü•ËØÜ\n‰∏ªË¶Å‰∏∫Êï∞ÊçÆÁªìÊûÑ„ÄÅÊåÅ‰πÖÂåñ„ÄÅÈõÜÁæ§„ÄÅÁºìÂ≠òÁ≠âÁõ∏ÂÖ≥Áü•ËØÜ„ÄÇ\nRedisÂ∏∏ËßÅÊï∞ÊçÆÁ±ªÂûãÂíåÂ∫îÁî®Âú∫ÊôØ Redis‰∏≠Â∏∏ËßÅÁöÑÊï∞ÊçÆÁ±ªÂûãÊúâ‰∫îÁßçÔºöStringÔºàÂ≠óÁ¨¶‰∏≤ÔºâÔºåHashÔºàÂìàÂ∏åÔºâÔºåListÔºàÂàóË°®ÔºâÔºåSetÔºàÈõÜÂêàÔºâÔºåZsetÔºàÊúâÂ∫èÈõÜÂêàÔºâ„ÄÇ\n">
<meta property='og:url' content='https://L-Y-D-0129.github.io/p/redis/'>
<meta property='og:site_name' content='ÂàòÁÖúÈºédeÂ≠¶‰π†Êó•ËÆ∞'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:published_time' content='2024-01-21T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2024-01-21T00:00:00&#43;00:00'/><meta property='og:image' content='https://L-Y-D-0129.github.io/p/redis/2109242356423Y8-0-lp.jpg' />
<meta name="twitter:title" content="Redis">
<meta name="twitter:description" content="ÂâçË®Ä HelloÔºåÂêÑ‰ΩçÂ•ΩÔºåÊàëÊòØÂàòÁÖúÈºéÔºÅ\nËøôÁØáÊñáÊ°£ÈõÜÂêà‰∫Ü‰∏Ä‰∫õRedisÁü•ËØÜ\n‰∏ªË¶Å‰∏∫Êï∞ÊçÆÁªìÊûÑ„ÄÅÊåÅ‰πÖÂåñ„ÄÅÈõÜÁæ§„ÄÅÁºìÂ≠òÁ≠âÁõ∏ÂÖ≥Áü•ËØÜ„ÄÇ\nRedisÂ∏∏ËßÅÊï∞ÊçÆÁ±ªÂûãÂíåÂ∫îÁî®Âú∫ÊôØ Redis‰∏≠Â∏∏ËßÅÁöÑÊï∞ÊçÆÁ±ªÂûãÊúâ‰∫îÁßçÔºöStringÔºàÂ≠óÁ¨¶‰∏≤ÔºâÔºåHashÔºàÂìàÂ∏åÔºâÔºåListÔºàÂàóË°®ÔºâÔºåSetÔºàÈõÜÂêàÔºâÔºåZsetÔºàÊúâÂ∫èÈõÜÂêàÔºâ„ÄÇ\n"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://L-Y-D-0129.github.io/p/redis/2109242356423Y8-0-lp.jpg' />
    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="ÂàáÊç¢ËèúÂçï">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu11432763322269111238.png" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">ü§î</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">ÂàòÁÖúÈºédeÂ≠¶‰π†Êó•ËÆ∞</a></h1>
            <h2 class="site-description">Ê¨¢ËøéÊù•Âà∞ÊàëÁöÑÁΩëÁ´ô</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://github.com/L-Y-D-0129'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>‰∏ªÈ°µ</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E5%85%B3%E4%BA%8E/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>ÂÖ≥‰∫é</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>ÂΩíÊ°£</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>ÊêúÁ¥¢</span>
            </a>
        </li>
        
        
        <li >
            <a href='/links/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>Links</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>ÊöóËâ≤Ê®°Âºè</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">ÁõÆÂΩï</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#string">String</a>
      <ol>
        <li><a href="#‰ªãÁªç">‰ªãÁªç</a></li>
        <li><a href="#ÂÜÖÈÉ®ÂÆûÁé∞">ÂÜÖÈÉ®ÂÆûÁé∞</a></li>
        <li><a href="#Â∏∏Áî®Êìç‰Ωú">Â∏∏Áî®Êìç‰Ωú</a></li>
        <li><a href="#Â∫îÁî®Âú∫ÊôØ">Â∫îÁî®Âú∫ÊôØ</a>
          <ol>
            <li><a href="#ÁºìÂ≠òÂØπË±°">ÁºìÂ≠òÂØπË±°</a></li>
            <li><a href="#Â∏∏ËßÑËÆ°Êï∞">Â∏∏ËßÑËÆ°Êï∞</a></li>
            <li><a href="#ÂàÜÂ∏ÉÂºèÈîÅ">ÂàÜÂ∏ÉÂºèÈîÅ</a></li>
            <li><a href="#ÂÖ±‰∫´session‰ø°ÊÅØ">ÂÖ±‰∫´session‰ø°ÊÅØ</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#list">List</a>
      <ol>
        <li><a href="#‰ªãÁªç-1">‰ªãÁªç</a></li>
        <li><a href="#ÂÜÖÈÉ®ÂÆûÁé∞-1">ÂÜÖÈÉ®ÂÆûÁé∞</a></li>
        <li><a href="#Â∏∏Áî®Êìç‰Ωú-1">Â∏∏Áî®Êìç‰Ωú</a></li>
        <li><a href="#Â∫îÁî®Âú∫ÊôØ-1">Â∫îÁî®Âú∫ÊôØ</a>
          <ol>
            <li><a href="#Ê∂àÊÅØÈòüÂàó">Ê∂àÊÅØÈòüÂàó</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#hash">Hash</a>
      <ol>
        <li><a href="#‰ªãÁªç-2">‰ªãÁªç</a></li>
        <li><a href="#ÂÜÖÈÉ®ÂÆûÁé∞-2">ÂÜÖÈÉ®ÂÆûÁé∞</a></li>
        <li><a href="#Â∏∏Áî®Êìç‰Ωú-2">Â∏∏Áî®Êìç‰Ωú</a></li>
        <li><a href="#Â∫îÁî®Âú∫ÊôØ-2">Â∫îÁî®Âú∫ÊôØ</a>
          <ol>
            <li><a href="#ÁºìÂ≠òÂØπË±°-1">ÁºìÂ≠òÂØπË±°</a></li>
            <li><a href="#Ë¥≠Áâ©ËΩ¶">Ë¥≠Áâ©ËΩ¶</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#set">Set</a>
      <ol>
        <li><a href="#‰ªãÁªç-3">‰ªãÁªç</a></li>
        <li><a href="#ÂÜÖÈÉ®ÂÆûÁé∞-3">ÂÜÖÈÉ®ÂÆûÁé∞</a></li>
        <li><a href="#Â∏∏Áî®Êìç‰Ωú-3">Â∏∏Áî®Êìç‰Ωú</a></li>
        <li><a href="#Â∫îÁî®Âú∫ÊôØ-3">Â∫îÁî®Âú∫ÊôØ</a>
          <ol>
            <li><a href="#ÁÇπËµû">ÁÇπËµû</a></li>
            <li><a href="#ÂÖ±ÂêåÂÖ≥Ê≥®">ÂÖ±ÂêåÂÖ≥Ê≥®</a></li>
            <li><a href="#ÊäΩÂ•ñÊ¥ªÂä®">ÊäΩÂ•ñÊ¥ªÂä®</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#zset">Zset</a>
      <ol>
        <li><a href="#‰ªãÁªç-4">‰ªãÁªç</a></li>
        <li><a href="#ÂÜÖÈÉ®ÂÆûÁé∞-4">ÂÜÖÈÉ®ÂÆûÁé∞</a></li>
        <li><a href="#Â∏∏Áî®Êìç‰Ωú-4">Â∏∏Áî®Êìç‰Ωú</a></li>
        <li><a href="#Â∫îÁî®Âú∫ÊôØ-4">Â∫îÁî®Âú∫ÊôØ</a>
          <ol>
            <li><a href="#ÊéíË°åÊ¶ú">ÊéíË°åÊ¶ú</a></li>
            <li><a href="#ÁîµËØùÂßìÂêçÊéíÂ∫è">ÁîµËØù„ÄÅÂßìÂêçÊéíÂ∫è</a></li>
          </ol>
        </li>
      </ol>
    </li>
  </ol>

  <ol>
    <li><a href="#ÈîÆÂÄºÂØπÊï∞ÊçÆÂ∫ìÊòØÊÄé‰πàÂÆûÁé∞ÁöÑ">ÈîÆÂÄºÂØπÊï∞ÊçÆÂ∫ìÊòØÊÄé‰πàÂÆûÁé∞ÁöÑÔºü</a></li>
    <li><a href="#sds">SDS</a>
      <ol>
        <li><a href="#sdsÁªìÊûÑËÆæËÆ°">SDSÁªìÊûÑËÆæËÆ°</a></li>
      </ol>
    </li>
    <li><a href="#ÈìæË°®">ÈìæË°®</a>
      <ol>
        <li><a href="#ÈìæË°®ËäÇÁÇπÁªìÊûÑËÆæËÆ°">ÈìæË°®ËäÇÁÇπÁªìÊûÑËÆæËÆ°</a></li>
        <li><a href="#ÈìæË°®ÁªìÊûÑËÆæËÆ°">ÈìæË°®ÁªìÊûÑËÆæËÆ°</a></li>
        <li><a href="#ÈìæË°®ÁöÑ‰ºòÂäø‰∏éÁº∫Èô∑">ÈìæË°®ÁöÑ‰ºòÂäø‰∏éÁº∫Èô∑</a></li>
      </ol>
    </li>
    <li><a href="#ÂéãÁº©ÂàóË°®">ÂéãÁº©ÂàóË°®</a>
      <ol>
        <li><a href="#ÂéãÁº©ÂàóË°®ÁªìÊûÑËÆæËÆ°">ÂéãÁº©ÂàóË°®ÁªìÊûÑËÆæËÆ°</a></li>
        <li><a href="#ÂéãÁº©ÂàóË°®ÁöÑÁº∫Èô∑">ÂéãÁº©ÂàóË°®ÁöÑÁº∫Èô∑</a>
          <ol>
            <li><a href="#ËøûÈîÅÊõ¥Êñ∞ÈóÆÈ¢ò">ËøûÈîÅÊõ¥Êñ∞ÈóÆÈ¢ò</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#ÂìàÂ∏åË°®">ÂìàÂ∏åË°®</a>
      <ol>
        <li><a href="#ÂìàÂ∏åË°®ÁªìÊûÑËÆæËÆ°">ÂìàÂ∏åË°®ÁªìÊûÑËÆæËÆ°</a></li>
        <li><a href="#ÂìàÂ∏åÂÜ≤Á™Å">ÂìàÂ∏åÂÜ≤Á™Å</a>
          <ol>
            <li><a href="#‰ªÄ‰πàÊòØÂìàÂ∏åÂÜ≤Á™ÅÂë¢">‰ªÄ‰πàÊòØÂìàÂ∏åÂÜ≤Á™ÅÂë¢</a></li>
          </ol>
        </li>
        <li><a href="#ÈìæÂºèÂìàÂ∏å">ÈìæÂºèÂìàÂ∏å</a>
          <ol>
            <li><a href="#ÈìæÂºèÂìàÂ∏åÊÄé‰πàÂÆûÁé∞ÁöÑ">ÈìæÂºèÂìàÂ∏åÊÄé‰πàÂÆûÁé∞ÁöÑÔºü</a></li>
          </ol>
        </li>
        <li><a href="#rehash">rehash</a></li>
        <li><a href="#Ê∏êËøõÂºèrehash">Ê∏êËøõÂºèrehash</a></li>
      </ol>
    </li>
    <li><a href="#Êï¥Êï∞ÈõÜÂêà">Êï¥Êï∞ÈõÜÂêà</a>
      <ol>
        <li><a href="#Êï¥Êï∞ÈõÜÂêàÁªìÊûÑËÆæËÆ°">Êï¥Êï∞ÈõÜÂêàÁªìÊûÑËÆæËÆ°</a></li>
        <li><a href="#Êï¥Êï∞ÈõÜÂêàÁöÑÂçáÁ∫ßÊìç‰Ωú">Êï¥Êï∞ÈõÜÂêàÁöÑÂçáÁ∫ßÊìç‰Ωú</a>
          <ol>
            <li><a href="#Êï¥Êï∞ÈõÜÂêàÂçáÁ∫ßÊúâ‰ªÄ‰πàÂ•ΩÂ§ÑÂë¢">Êï¥Êï∞ÈõÜÂêàÂçáÁ∫ßÊúâ‰ªÄ‰πàÂ•ΩÂ§ÑÂë¢Ôºü</a></li>
            <li><a href="#Êï¥Êï∞ÈõÜÂêàÊîØÊåÅÈôçÁ∫ßÊìç‰ΩúÂêó">Êï¥Êï∞ÈõÜÂêàÊîØÊåÅÈôçÁ∫ßÊìç‰ΩúÂêóÔºü</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#Ë∑≥Ë°®">Ë∑≥Ë°®</a>
      <ol>
        <li><a href="#Ë∑≥Ë°®ÁªìÊûÑËÆæËÆ°">Ë∑≥Ë°®ÁªìÊûÑËÆæËÆ°</a></li>
        <li><a href="#Ë∑≥Ë°®ËäÇÁÇπÊü•ËØ¢ËøáÁ®ã">Ë∑≥Ë°®ËäÇÁÇπÊü•ËØ¢ËøáÁ®ã</a></li>
        <li><a href="#Ë∑≥Ë°®ËäÇÁÇπÂ±ÇÊï∞ËÆæÁΩÆ">Ë∑≥Ë°®ËäÇÁÇπÂ±ÇÊï∞ËÆæÁΩÆ</a>
          <ol>
            <li><a href="#ÈÇ£ÊÄéÊ†∑ÊâçËÉΩÁª¥ÊåÅÁõ∏ÈÇª‰∏§Â±ÇÁöÑËäÇÁÇπÊï∞ÈáèÁöÑÊØî‰æã‰∏∫-2--1-Âë¢">ÈÇ£ÊÄéÊ†∑ÊâçËÉΩÁª¥ÊåÅÁõ∏ÈÇª‰∏§Â±ÇÁöÑËäÇÁÇπÊï∞ÈáèÁöÑÊØî‰æã‰∏∫ 2 : 1 Âë¢Ôºü</a></li>
          </ol>
        </li>
        <li><a href="#‰∏∫‰ªÄ‰πàÁî®Ë∑≥Ë°®ËÄå‰∏çÁî®Âπ≥Ë°°Ê†ë">‰∏∫‰ªÄ‰πàÁî®Ë∑≥Ë°®ËÄå‰∏çÁî®Âπ≥Ë°°Ê†ëÔºü</a></li>
      </ol>
    </li>
    <li><a href="#quicklist">quicklist</a></li>
    <li><a href="#listpack">listpack</a></li>
  </ol>

  <ol>
    <li><a href="#aofÊó•Âøó">AOFÊó•Âøó</a></li>
    <li><a href="#‰∏âÁßçÂÜôÂõûÁ≠ñÁï•">‰∏âÁßçÂÜôÂõûÁ≠ñÁï•</a></li>
    <li><a href="#aofÈáçÂÜôÊú∫Âà∂">AOFÈáçÂÜôÊú∫Âà∂</a></li>
    <li><a href="#aofÂêéÂè∞ÈáçÂÜô">AOFÂêéÂè∞ÈáçÂÜô</a></li>
    <li><a href="#ÊÄªÁªì-1">ÊÄªÁªì</a></li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/redis/">
                <img src="/p/redis/2109242356423Y8-0-lp_hu11024188421021465833.jpg"
                        srcset="/p/redis/2109242356423Y8-0-lp_hu11024188421021465833.jpg 800w, /p/redis/2109242356423Y8-0-lp_hu15644524752345769741.jpg 1600w"
                        width="800" 
                        height="449" 
                        loading="lazy"
                        alt="Featured image of post Redis" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" >
                Êï∞ÊçÆÁªìÊûÑ
            </a>
        
            <a href="/categories/%E7%BC%93%E5%AD%98/" >
                ÁºìÂ≠ò
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/redis/">Redis</a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">2024-01-21</time>
            </div>
        

        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h1 id="ÂâçË®Ä">ÂâçË®Ä
</h1><blockquote>
<p>HelloÔºåÂêÑ‰ΩçÂ•ΩÔºåÊàëÊòØÂàòÁÖúÈºéÔºÅ</p>
<p>ËøôÁØáÊñáÊ°£ÈõÜÂêà‰∫Ü‰∏Ä‰∫õRedisÁü•ËØÜ</p>
</blockquote>
<p>‰∏ªË¶Å‰∏∫Êï∞ÊçÆÁªìÊûÑ„ÄÅÊåÅ‰πÖÂåñ„ÄÅÈõÜÁæ§„ÄÅÁºìÂ≠òÁ≠âÁõ∏ÂÖ≥Áü•ËØÜ„ÄÇ</p>
<h1 id="redisÂ∏∏ËßÅÊï∞ÊçÆÁ±ªÂûãÂíåÂ∫îÁî®Âú∫ÊôØ">RedisÂ∏∏ËßÅÊï∞ÊçÆÁ±ªÂûãÂíåÂ∫îÁî®Âú∫ÊôØ
</h1><p>Redis‰∏≠Â∏∏ËßÅÁöÑÊï∞ÊçÆÁ±ªÂûãÊúâ‰∫îÁßçÔºö<strong>StringÔºàÂ≠óÁ¨¶‰∏≤ÔºâÔºåHashÔºàÂìàÂ∏åÔºâÔºåListÔºàÂàóË°®ÔºâÔºåSetÔºàÈõÜÂêàÔºâÔºåZsetÔºàÊúâÂ∫èÈõÜÂêàÔºâ„ÄÇ</strong></p>
<p>ÈöèÁùÄRedisÁâàÊú¨ÁöÑÊõ¥Êñ∞ÔºåÂêéÈù¢ÂèàÊîØÊåÅ‰∫ÜÂõõÁßçÊï∞ÊçÆÁ±ªÂûãÔºö<strong>BitMapÔºà2.2 ÁâàÊñ∞Â¢ûÔºâ„ÄÅHyperLogLogÔºà2.8 ÁâàÊñ∞Â¢ûÔºâ„ÄÅGEOÔºà3.2 ÁâàÊñ∞Â¢ûÔºâ„ÄÅStreamÔºà5.0 ÁâàÊñ∞Â¢ûÔºâ„ÄÇ</strong></p>
<h2 id="string">String
</h2><h3 id="‰ªãÁªç">‰ªãÁªç
</h3><p>String ÊòØÊúÄÂü∫Êú¨ÁöÑ key-value ÁªìÊûÑÔºåkey ÊòØÂîØ‰∏ÄÊ†áËØÜÔºåvalue ÊòØÂÖ∑‰ΩìÁöÑÂÄºÔºåvalueÂÖ∂ÂÆû‰∏ç‰ªÖÊòØÂ≠óÁ¨¶‰∏≤Ôºå‰πüÂèØ‰ª•ÊòØÊï∞Â≠ó(Êï¥Êï∞ÊàñÊµÆÁÇπÊï∞)Ôºåvalue ÊúÄÂ§öÂèØ‰ª•ÂÆπÁ∫≥ÁöÑÊï∞ÊçÆÈïøÂ∫¶ÊòØ512M„ÄÇ</p>
<h3 id="ÂÜÖÈÉ®ÂÆûÁé∞">ÂÜÖÈÉ®ÂÆûÁé∞
</h3><p>StringÁ±ªÂûãÁöÑÂ∫ïÂ±ÇÁöÑÊï∞ÊçÆÁªìÊûÑÂÆûÁé∞‰∏ªË¶ÅÊòØintÂíåSDSÔºàÁÆÄÂçïÂä®ÊÄÅÂ≠óÁ¨¶‰∏≤Ôºâ„ÄÇ</p>
<p>SDSÁõ∏ÊØî‰∫éCÁöÑÂéüÁîüÂ≠óÁ¨¶‰∏≤Ôºö</p>
<ul>
<li>**SDS ‰∏ç‰ªÖÂèØ‰ª•‰øùÂ≠òÊñáÊú¨Êï∞ÊçÆÔºåËøòÂèØ‰ª•‰øùÂ≠ò‰∫åËøõÂà∂Êï∞ÊçÆ„ÄÇ**Âõ†‰∏∫SDS‰ΩøÁî® len Â±ûÊÄßÁöÑÂÄºËÄå‰∏çÊòØÁ©∫Â≠óÁ¨¶Êù•Âà§Êñ≠Â≠óÁ¨¶‰∏≤ÊòØÂê¶ÁªìÊùüÔºåÂπ∂‰∏î SDS ÁöÑÊâÄÊúâ API ÈÉΩ‰ºö‰ª•Â§ÑÁêÜ‰∫åËøõÂà∂ÁöÑÊñπÂºèÊù•Â§ÑÁêÜ SDS Â≠òÊîæÂú® buf[]Êï∞ÁªÑÈáåÁöÑÊï∞ÊçÆ„ÄÇÊâÄ‰ª• SDS ‰∏çÂÖâËÉΩÂ≠òÊîæÊñáÊú¨Êï∞ÊçÆÔºåËÄå‰∏îËÉΩ‰øùÂ≠òÂõæÁâá„ÄÅÈü≥È¢ë„ÄÅËßÜÈ¢ë„ÄÅÂéãÁº©Êñá‰ª∂ËøôÊ†∑ÁöÑ‰∫åËøõÂà∂Êï∞ÊçÆ„ÄÇ</li>
<li>**SDS Ëé∑ÂèñÂ≠óÁ¨¶‰∏≤ÈïøÂ∫¶ÁöÑÊó∂Èó¥Â§çÊùÇÂ∫¶ÊòØ O(1)„ÄÇ**Âõ†‰∏∫CËØ≠Ë®ÄÁöÑÂ≠óÁ¨¶‰∏≤Âπ∂‰∏çËÆ∞ÂΩïËá™Ë∫´ÈïøÂ∫¶ÔºåÊâÄ‰ª•Ëé∑ÂèñÈïøÂ∫¶ÁöÑÂ§çÊùÇÂ∫¶‰∏∫ O(n);ËÄå SDS ÁªìÊûÑÈáåÁî® len Â±ûÊÄßËÆ∞ÂΩï‰∫ÜÂ≠óÁ¨¶‰∏≤ÈïøÂ∫¶ÔºåÊâÄ‰ª•Â§çÊùÇÂ∫¶‰∏∫ O(1)„ÄÇ</li>
<li>Redis ÁöÑ SDS API ÊòØÂÆâÂÖ®ÁöÑÔºåÊãºÊé•Â≠óÁ¨¶‰∏≤‰∏ç‰ºöÈÄ†ÊàêÁºìÂÜ≤Âå∫Ê∫¢Âá∫„ÄÇÂõ†‰∏∫ SDS Âú®ÊãºÊé•Â≠óÁ¨¶‰∏≤‰πãÂâç‰ºöÊ£ÄÊü•SDS Á©∫Èó¥ÊòØÂê¶Êª°Ë∂≥Ë¶ÅÊ±ÇÔºåÂ¶ÇÊûúÁ©∫Èó¥‰∏çÂ§ü‰ºöËá™Âä®Êâ©ÂÆπÔºåÊâÄ‰ª•‰∏ç‰ºöÂØºËá¥ÁºìÂÜ≤Âå∫Ê∫¢Âá∫ÁöÑÈóÆÈ¢ò„ÄÇ</li>
</ul>
<p><strong>Â≠óÁ¨¶‰∏≤ÁöÑÂÜÖÈÉ®ÁºñÁ†ÅÔºàencodingÔºâÊúâ‰∏âÁßçÔºöint„ÄÅrawÂíåembstrÔºàrawÂíåembstr‰∏∫SDSÔºàÁÆÄÂçïÂä®ÊÄÅÂ≠óÁ¨¶‰∏≤ÔºâÔºâ„ÄÇ</strong></p>
<p>Â¶ÇÊûú‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ÂØπË±°‰øùÂ≠òÁöÑÊòØÊï¥Êï∞ÂÄºÔºåÂπ∂‰∏îËøô‰∏™Êï¥Êï∞ÂÄºÂèØ‰ª•Áî® longÁ±ªÂûãÊù•Ë°®Á§∫ÔºåÈÇ£‰πàÂ≠óÁ¨¶‰∏≤ÂØπË±°‰ºöÂ∞ÜÊï¥Êï∞ÂÄº‰øùÂ≠òÂú®Â≠óÁ¨¶‰∏≤ÂØπË±°ÁªìÊûÑÁöÑ ptr Â±ûÊÄßÈáåÈù¢(Â∞Ü void*ËΩ¨Êç¢Êàê long)ÔºåÂπ∂Â∞ÜÂ≠óÁ¨¶‰∏≤ÂØπË±°ÁöÑÁºñÁ†ÅËÆæÁΩÆ‰∏∫int „ÄÇ</p>
<p>Â¶ÇÊûúÂ≠óÁ¨¶‰∏≤ÂØπË±°‰øùÂ≠òÁöÑÊòØ‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ÂàôÊúâ‰∏§ÁßçÊÉÖÂÜµÔºö</p>
<ol>
<li>Â≠óÁ¨¶‰∏≤ÈïøÂ∫¶Â∞è‰∫éÁ≠â‰∫é32Â≠óËäÇÔºàredis2.+ÁâàÊú¨Ôºâ
Â≠óÁ¨¶‰∏≤ÂØπË±°Â∞Ü‰ΩøÁî®‰∏Ä‰∏™ÁÆÄÂçïÂä®ÊÄÅÂ≠óÁ¨¶‰∏≤(SDS)Êù•‰øùÂ≠òËøô‰∏™Â≠óÁ¨¶‰∏≤ÔºåÂπ∂Â∞ÜÂØπË±°ÁöÑÁºñÁ†ÅËÆæÁΩÆ‰∏∫ embstrÔºåembstr ÁºñÁ†ÅÊòØ‰∏ìÈó®Áî®‰∫é‰øùÂ≠òÁü≠Â≠óÁ¨¶‰∏≤ÁöÑ‰∏ÄÁßç‰ºòÂåñÁºñÁ†ÅÊñπÂºè„ÄÇ</li>
<li>Â≠óÁ¨¶‰∏≤ÈïøÂ∫¶Â§ß‰∫é32Â≠óËäÇÔºàredis2.+ÁâàÊú¨Ôºâ
ÈÇ£‰πàÂ≠óÁ¨¶‰∏≤ÂØπË±°Â∞Ü‰ΩøÁî®‰∏Ä‰∏™ÁÆÄÂçïÂä®ÊÄÅÂ≠óÁ¨¶‰∏≤(SDS)Êù•‰øùÂ≠òËøô‰∏™Â≠óÁ¨¶‰∏≤ÔºåÂπ∂Â∞ÜÂØπË±°ÁöÑÁºñÁ†ÅËÆæÁΩÆ‰∏∫ raw„ÄÇ</li>
</ol>
<p>ÂèØ‰ª•ÁúãÂà∞ embstr Âíå raw ÁºñÁ†ÅÈÉΩ‰ºö‰ΩøÁî® SDS Êù•‰øùÂ≠òÂÄºÔºå‰ΩÜ<strong>‰∏çÂêå‰πãÂ§ÑÂú®‰∫é</strong> embstr ‰ºöÈÄöËøá<strong>‰∏ÄÊ¨°ÂÜÖÂ≠òÂàÜÈÖç</strong>ÂáΩÊï∞Êù•ÂàÜÈÖç‰∏ÄÂùóËøûÁª≠ÁöÑÂÜÖÂ≠òÁ©∫Èó¥Êù•‰øùÂ≠ò redisobiect Âíå SDS ÔºåËÄå raw ÁºñÁ†Å‰ºöÈÄöËøáË∞ÉÁî®<strong>‰∏§Ê¨°ÂÜÖÂ≠òÂàÜÈÖç</strong>ÂáΩÊï∞Êù•ÂàÜÂà´ÂàÜÈÖç‰∏§ÂùóÁ©∫Èó¥Êù•‰øùÂ≠ò redisobject Âíå SDS „ÄÇRedisËøôÊ†∑ÂÅö‰ºöÊúâÂæàÂ§öÂ•ΩÂ§Ñ:</p>
<ul>
<li>embstr ÁºñÁ†ÅÂ∞ÜÂàõÂª∫Â≠óÁ¨¶‰∏≤ÂØπË±°ÊâÄÈúÄÁöÑÂÜÖÂ≠òÂàÜÈÖçÊ¨°Êï∞‰ªé rawÁºñÁ†ÅÁöÑ‰∏§Ê¨°Èôç‰Ωé‰∏∫‰∏ÄÊ¨°;</li>
<li>ÈáäÊîæ embstr ÁºñÁ†ÅÁöÑÂ≠óÁ¨¶‰∏≤ÂØπË±°ÂêåÊ†∑Âè™ÈúÄË¶ÅË∞ÉÁî®‰∏ÄÊ¨°ÂÜÖÂ≠òÈáäÊîæÂáΩÊï∞;</li>
<li>Âõ†‰∏∫ embstr ÁºñÁ†ÅÁöÑÂ≠óÁ¨¶‰∏≤ÂØπË±°ÁöÑÊâÄÊúâÊï∞ÊçÆÈÉΩ‰øùÂ≠òÂú®‰∏ÄÂùóËøûÁª≠ÁöÑÂÜÖÂ≠òÈáåÈù¢ÂèØ‰ª•Êõ¥Â•ΩÁöÑÂà©Áî® CPU ÁºìÂ≠òÊèêÂçáÊÄßËÉΩ„ÄÇ</li>
</ul>
<p>‰ΩÜÊòØ embstr ‰πüÊúâÁº∫ÁÇπÁöÑ:</p>
<ul>
<li>Â¶ÇÊûúÂ≠óÁ¨¶‰∏≤ÁöÑÈïøÂ∫¶Â¢ûÂä†ÈúÄË¶ÅÈáçÊñ∞ÂàÜÈÖçÂÜÖÂ≠òÊó∂ÔºåÊï¥‰∏™redisObjectÂíåsdsÈÉΩÈúÄË¶ÅÈáçÊñ∞ÂàÜÈÖçÁ©∫Èó¥ÔºåÊâÄ‰ª•<strong>embstrÁºñÁ†ÅÁöÑÂ≠óÁ¨¶‰∏≤ÂØπË±°ÂÆûÈôÖ‰∏äÊòØÂè™ËØªÁöÑ</strong>ÔºåredisÊ≤°Êúâ‰∏∫embstrÁºñÁ†ÅÁöÑÂ≠óÁ¨¶‰∏≤ÂØπË±°ÁºñÂÜô‰ªª‰ΩïÁõ∏Â∫îÁöÑ‰øÆÊîπÁ®ãÂ∫è„ÄÇÂΩìÊàë‰ª¨ÂØπembstrÁºñÁ†ÅÁöÑÂ≠óÁ¨¶‰∏≤ÂØπË±°ÊâßË°å‰ªª‰Ωï‰øÆÊîπÂëΩ‰ª§(‰æãÂ¶Çappend)Êó∂ÔºåÁ®ãÂ∫è‰ºöÂÖàÂ∞Ü<strong>ÂØπË±°ÁöÑÁºñÁ†Å‰ªéembstrËΩ¨Êç¢Êàêraw</strong>ÔºåÁÑ∂ÂêéÂÜçÊâßË°å‰øÆÊîπÂëΩ‰ª§„ÄÇ</li>
</ul>
<h3 id="Â∏∏Áî®Êìç‰Ωú">Â∏∏Áî®Êìç‰Ωú
</h3><ul>
<li>setÔºöËÆæÁΩÆÂ≠óÁ¨¶‰∏≤</li>
<li>getÔºöËØªÂèñÂ≠óÁ¨¶‰∏≤</li>
<li>incrÔºöËá™Â¢ûÔºà1Ôºâ</li>
<li>decrÔºöËá™ÂáèÔºà1Ôºâ</li>
<li>existsÔºöÂà§Êñ≠Êüê‰∏™keyÊòØÂê¶Â≠òÂú®</li>
<li>strlenÔºöËøîÂõûÂ≠óÁ¨¶‰∏≤ÈïøÂ∫¶</li>
<li>delÔºöÂà†Èô§key</li>
<li>expireÔºöËÆæÁΩÆËøáÊúüÊó∂Èó¥</li>
<li>ttlÔºöÊü•ÁúãÂâ©‰ΩôËøáÊúüÊó∂Èó¥</li>
<li>set nxÔºö‰∏çÂ≠òÂú®Â∞±ÊèíÂÖ•ÔºàÊàêÂäüËøîÂõû1ÔºåÂ§±Ë¥•ËøîÂõû0Ôºâ</li>
<li>msetÔºöÊâπÈáèËÆæÁΩÆÂ≠óÁ¨¶‰∏≤</li>
<li>mgetÔºöÊâπÈáèËØªÂèñÂ≠óÁ¨¶‰∏≤</li>
</ul>
<h3 id="Â∫îÁî®Âú∫ÊôØ">Â∫îÁî®Âú∫ÊôØ
</h3><h4 id="ÁºìÂ≠òÂØπË±°">ÁºìÂ≠òÂØπË±°
</h4><p>‰ΩøÁî® String Êù•ÁºìÂ≠òÂØπË±°Êúâ‰∏§ÁßçÊñπÂºè:</p>
<ul>
<li>
<p>Áõ¥Êé•ÁºìÂ≠òÊï¥‰∏™ÂØπË±°ÁöÑJSONÔºåÂëΩ‰ª§‰æãÂ≠ê:SET user:1&rsquo;{&ldquo;name&rdquo;:&ldquo;ÈöîÂ£ÅËÄÅÁéã&rdquo;Ôºå‚Äúage‚Äù:38}'</p>
</li>
<li>
<p>ÈááÁî®Â∞Ü key ËøõË°åÂàÜÁ¶ª‰∏∫ user:ID:Â±ûÊÄßÔºåÈááÁî® MSETÂ≠òÂÇ®ÔºåÁî® MGETËé∑ÂèñÂêÑÂ±ûÊÄßÂÄºÔºå</p>
<p>ÂëΩ‰ª§‰æãÂ≠ê:</p>
<p>MSET  user:1:name &ldquo;ÈöîÂ£ÅËÄÅÁéãÂ§¥&rdquo; user:1:age 38</p>
<p>‚Äã			 user:2:name &ldquo;Ê•º‰∏ãËÄÅÂê¥Â§¥&rdquo; user:2:age 40</p>
</li>
</ul>
<h4 id="Â∏∏ËßÑËÆ°Êï∞">Â∏∏ËßÑËÆ°Êï∞
</h4><p>Âõ†‰∏∫ Redis Â§ÑÁêÜÂëΩ‰ª§ÊòØÂçïÁ∫øÁ®ãÔºåÊâÄ‰ª•ÊâßË°åÂëΩ‰ª§ÁöÑËøáÁ®ãÊòØÂéüÂ≠êÁöÑ„ÄÇÂõ†Ê≠§ String Êï∞ÊçÆÁ±ªÂûãÈÄÇÂêàËÆ°Êï∞Âú∫ÊôØÔºåÊØîÂ¶ÇËÆ°ÁÆóËÆøÈóÆÊ¨°Êï∞„ÄÅÁÇπËµû„ÄÅËΩ¨Âèë„ÄÅÂ∫ìÂ≠òÊï∞ÈáèÁ≠âÁ≠â„ÄÇ</p>
<h4 id="ÂàÜÂ∏ÉÂºèÈîÅ">ÂàÜÂ∏ÉÂºèÈîÅ
</h4><p>SET ÂëΩ‰ª§Êúâ‰∏™ NX ÂèÇÊï∞ÂèØ‰ª•ÂÆûÁé∞„Äåkey‰∏çÂ≠òÂú®ÊâçÊèíÂÖ•„ÄçÔºåÂèØ‰ª•Áî®ÂÆÉÊù•ÂÆûÁé∞ÂàÜÂ∏ÉÂºèÈîÅ</p>
<ul>
<li>Â¶ÇÊûú key ‰∏çÂ≠òÂú®ÔºåÂàôÊòæÁ§∫ÊèíÂÖ•ÊàêÂäüÔºåÂèØ‰ª•Áî®Êù•Ë°®Á§∫Âä†ÈîÅÊàêÂäü;</li>
<li>Â¶ÇÊûú key Â≠òÂú®ÔºåÂàô‰ºöÊòæÁ§∫ÊèíÂÖ•Â§±Ë¥•ÔºåÂèØ‰ª•Áî®Êù•Ë°®Á§∫Âä†ÈîÅÂ§±Ë¥•„ÄÇ</li>
</ul>
<h4 id="ÂÖ±‰∫´session‰ø°ÊÅØ">ÂÖ±‰∫´session‰ø°ÊÅØ
</h4><p>ÈÄöÂ∏∏Êàë‰ª¨Âú®ÂºÄÂèëÂêéÂè∞ÁÆ°ÁêÜÁ≥ªÁªüÊó∂Ôºå‰ºö‰ΩøÁî® Session Êù•‰øùÂ≠òÁî®Êà∑ÁöÑ‰ºöËØù(ÁôªÂΩï)Áä∂ÊÄÅÔºåËøô‰∫õ Session ‰ø°ÊÅØ‰ºöË¢´‰øùÂ≠òÂú®ÊúçÂä°Âô®Á´ØÔºå‰ΩÜËøôÂè™ÈÄÇÁî®‰∫éÂçïÁ≥ªÁªüÂ∫îÁî®ÔºåÂ¶ÇÊûúÊòØÂàÜÂ∏ÉÂºèÁ≥ªÁªüÊ≠§Ê®°ÂºèÂ∞Ü‰∏çÂÜçÈÄÇÁî®„ÄÇ</p>
<p>‰æãÂ¶ÇÁî®Êà∑‰∏ÄÁöÑ Session ‰ø°ÊÅØË¢´Â≠òÂÇ®Âú®ÊúçÂä°Âô®‰∏ÄÔºå‰ΩÜÁ¨¨‰∫åÊ¨°ËÆøÈóÆÊó∂Áî®Êà∑‰∏ÄË¢´ÂàÜÈÖçÂà∞ÊúçÂä°Âô®‰∫åÔºåËøô‰∏™Êó∂ÂÄôÊúçÂä°Âô®Âπ∂Ê≤°ÊúâÁî®Êà∑‰∏ÄÁöÑ Session ‰ø°ÊÅØÔºåÂ∞±‰ºöÂá∫Áé∞ÈúÄË¶ÅÈáçÂ§çÁôªÂΩïÁöÑÈóÆÈ¢òÔºåÈóÆÈ¢òÂú®‰∫éÂàÜÂ∏ÉÂºèÁ≥ªÁªüÊØèÊ¨°‰ºöÊääËØ∑Ê±ÇÈöèÊú∫ÂàÜÈÖçÂà∞‰∏çÂêåÁöÑÊúçÂä°Âô®„ÄÇ</p>
<p>Âõ†Ê≠§ÔºåÊàë‰ª¨ÈúÄË¶ÅÂÄüÂä© Redis ÂØπËøô‰∫õ Session ‰ø°ÊÅØËøõË°åÁªü‰∏ÄÁöÑÂ≠òÂÇ®ÂíåÁÆ°ÁêÜÔºåËøôÊ†∑Êó†ËÆ∫ËØ∑Ê±ÇÂèëÈÄÅÂà∞ÈÇ£Âè∞ÊúçÂä°Âô®ÔºåÊúçÂä°Âô®ÈÉΩ‰ºöÂéªÂêå‰∏Ä‰∏™ Redis Ëé∑ÂèñÁõ∏ÂÖ≥ÁöÑ Session ‰ø°ÊÅØÔºåËøôÊ†∑Â∞±Ëß£ÂÜ≥‰∫ÜÂàÜÂ∏ÉÂºèÁ≥ªÁªü‰∏ã Session Â≠òÂÇ®ÁöÑÈóÆÈ¢ò„ÄÇ</p>
<h2 id="list">List
</h2><h3 id="‰ªãÁªç-1">‰ªãÁªç
</h3><p>ListÂàóË°®ÊòØÊúÄÁÆÄÂçïÁöÑÂ≠óÁ¨¶‰∏≤ÂàóË°®ÔºåÊåâÁÖßÊèíÂÖ•È°∫Â∫èÊéíÂ∫èÔºåÂèØ‰ª•‰ªéÂ§¥ÈÉ®ÊàñÂ∞æÈÉ®ÂêëListÂàóË°®Ê∑ªÂä†ÂÖÉÁ¥†„ÄÇ</p>
<p>ÂàóË°®ÁöÑÊúÄÂ§ßÈïøÂ∫¶‰∏∫2^32 - 1ÔºåÂç≥ÊØè‰∏™ÂàóË°®ÊîØÊåÅË∂ÖËøá40‰∫ø‰∏™ÂÖÉÁ¥†„ÄÇ</p>
<h3 id="ÂÜÖÈÉ®ÂÆûÁé∞-1">ÂÜÖÈÉ®ÂÆûÁé∞
</h3><p>Á±ªÂûãÁöÑÂ∫ïÂ±ÇÊï∞ÊçÆÁªìÊûÑÊòØÁî±<strong>ÂèåÂêëÈìæË°®ÊàñÂéãÁº©ÂàóË°®</strong>ÂÆûÁé∞ÁöÑ:</p>
<ul>
<li>Â¶ÇÊûúÂàóË°®ÁöÑÂÖÉÁ¥†‰∏™Êï∞Â∞è‰∫é 512‰∏™ÔºåÂàóË°®ÊØè‰∏™ÂÖÉÁ¥†ÁöÑÂÄºÈÉΩÂ∞è‰∫é 64 Â≠óËäÇÔºåRedis ‰ºö‰ΩøÁî®<strong>ÂéãÁº©ÂàóË°®</strong>‰Ωú‰∏∫List Á±ªÂûãÁöÑÂ∫ïÂ±ÇÊï∞ÊçÆÁªìÊûÑ;</li>
<li>Â¶ÇÊûúÂàóË°®ÁöÑÂÖÉÁ¥†‰∏çÊª°Ë∂≥‰∏äÈù¢ÁöÑÊù°‰ª∂ÔºåRedis ‰ºö‰ΩøÁî®<strong>ÂèåÂêëÈìæË°®</strong>‰Ωú‰∏∫ List Á±ªÂûãÁöÑÂ∫ïÂ±ÇÊï∞ÊçÆÁªìÊûÑ;</li>
<li>‰ΩÜÊòØ<strong>Âú® Redis 3.2 ÁâàÊú¨‰πãÂêéÔºåList Êï∞ÊçÆÁ±ªÂûãÂ∫ïÂ±ÇÊï∞ÊçÆÁªìÊûÑÂ∞±Âè™Áî± quicklist Ôºà‰∫åËÄÖÁªìÂêàÔºâÂÆûÁé∞‰∫ÜÔºåÊõø‰ª£‰∫ÜÂèåÂêëÈìæË°®ÂíåÂéãÁº©ÂàóË°®„ÄÇ</strong></li>
</ul>
<h3 id="Â∏∏Áî®Êìç‰Ωú-1">Â∏∏Áî®Êìç‰Ωú
</h3><ul>
<li>lpushÔºöÂú®listÂ∑¶‰æßÊèíÂÖ•‰∏Ä‰∏™Êñ∞ÂÖÉÁ¥†</li>
<li>rpushÔºöÂú®listÂè≥‰æßÊèíÂÖ•‰∏Ä‰∏™Êñ∞ÂÖÉÁ¥†</li>
<li>lrangeÔºö‰ªélist‰∏≠ÊåáÂÆö‰∏Ä‰∏™ËåÉÂõ¥Êù•ÊèêÂèñÂÖÉÁ¥†</li>
<li>lpopÔºöÁßªÈô§Âπ∂ËøîÂõûÂàóË°®Â§¥ÂÖÉÁ¥†</li>
<li>rpopÔºöÁßªÈô§Âπ∂ËøîÂõûÂàóË°®Â∞æÂÖÉÁ¥†</li>
</ul>
<h3 id="Â∫îÁî®Âú∫ÊôØ-1">Â∫îÁî®Âú∫ÊôØ
</h3><h4 id="Ê∂àÊÅØÈòüÂàó">Ê∂àÊÅØÈòüÂàó
</h4><p>Ê∂àÊÅØÈòüÂàóÂú®Â≠òÂèñÊ∂àÊÅØÊó∂ÔºåÂøÖÈ°ªË¶ÅÊª°Ë∂≥‰∏â‰∏™ÈúÄÊ±ÇÔºåÂàÜÂà´ÊòØ<strong>Ê∂àÊÅØ‰øùÂ∫è„ÄÅÂ§ÑÁêÜÈáçÂ§çÁöÑÊ∂àÊÅØÂíå‰øùËØÅÊ∂àÊÅØÂèØÈù†ÊÄß</strong>„ÄÇ</p>
<p>Redis ÁöÑ List Âíå Stream ‰∏§ÁßçÊï∞ÊçÆÁ±ªÂûãÔºåÂ∞±ÂèØ‰ª•Êª°Ë∂≥Ê∂àÊÅØÈòüÂàóÁöÑËøô‰∏â‰∏™ÈúÄÊ±Ç„ÄÇ</p>
<ol>
<li>
<p>Â¶Ç‰ΩïÊª°Ë∂≥Ê∂àÊÅØ‰øùÂ∫èÈúÄÊ±ÇÔºü</p>
<p>List Êú¨Ë∫´Â∞±ÊòØÊåâÂÖàËøõÂÖàÂá∫ÁöÑÈ°∫Â∫èÂØπÊï∞ÊçÆËøõË°åÂ≠òÂèñÁöÑÔºåÊâÄ‰ª•ÔºåÂ¶ÇÊûú‰ΩøÁî® List ‰Ωú‰∏∫Ê∂àÊÅØÈòüÂàó‰øùÂ≠òÊ∂àÊÅØÁöÑËØùÔºåÂ∞±Â∑≤ÁªèËÉΩÊª°Ë∂≥Ê∂àÊÅØ‰øùÂ∫èÁöÑÈúÄÊ±Ç‰∫Ü„ÄÇ</p>
<p>List ÂèØ‰ª•‰ΩøÁî® LPUSH+RPOP(ÊàñËÄÖÂèçËøáÊù•ÔºåRPUSH+LPOP)ÂëΩ‰ª§ÂÆûÁé∞Ê∂àÊÅØÈòüÂàó„ÄÇ</p>
<ul>
<li>Áîü‰∫ßËÄÖ‰ΩøÁî® LPUSH key value[value&hellip;]Â∞ÜÊ∂àÊÅØÊèíÂÖ•Âà∞ÈòüÂàóÁöÑÂ§¥ÈÉ®ÔºåÂ¶ÇÊûú key ‰∏çÂ≠òÂú®Âàô‰ºöÂàõÂª∫‰∏Ä‰∏™Á©∫ÁöÑÈòüÂàóÂÜçÊèíÂÖ•Ê∂àÊÅØ„ÄÇ</li>
<li>Ê∂àË¥πËÄÖ‰ΩøÁî® RPOP key ‰æùÊ¨°ËØªÂèñÈòüÂàóÁöÑÊ∂àÊÅØÔºåÂÖàËøõÂÖàÂá∫„ÄÇ</li>
</ul>
<p>ÊΩúÂú®ÊÄßËÉΩÈ£éÈô©ÁÇπÔºö</p>
<p>Âú®Áîü‰∫ßËÄÖÂæÄ List ‰∏≠ÂÜôÂÖ•Êï∞ÊçÆÊó∂ÔºåList Âπ∂‰∏ç‰ºö‰∏ªÂä®Âú∞ÈÄöÁü•Ê∂àË¥πËÄÖÊúâÊñ∞Ê∂àÊÅØÂÜôÂÖ•ÔºåÂ¶ÇÊûúÊ∂àË¥πËÄÖÊÉ≥Ë¶ÅÂèäÊó∂Â§ÑÁêÜÊ∂àÊÅØÔºåÂ∞±ÈúÄË¶ÅÂú®Á®ãÂ∫è‰∏≠‰∏çÂÅúÂú∞Ë∞ÉÁî® RPOPÂëΩ‰ª§(ÊØîÂ¶Ç‰ΩøÁî®‰∏Ä‰∏™while(1)Âæ™ÁéØ)„ÄÇÂ¶ÇÊûúÊúâÊñ∞Ê∂àÊÅØÂÜôÂÖ•ÔºåRPOPÂëΩ‰ª§Â∞±‰ºöËøîÂõûÁªìÊûúÔºåÂê¶ÂàôÔºåRPOPÂëΩ‰ª§ËøîÂõûÁ©∫ÂÄºÔºåÂÜçÁªßÁª≠Âæ™ÁéØÔºå</p>
<p>ÊâÄ‰ª•ÔºåÂç≥‰ΩøÊ≤°ÊúâÊñ∞Ê∂àÊÅØÂÜôÂÖ•ListÔºåÊ∂àË¥πËÄÖ‰πüË¶Å‰∏çÂÅúÂú∞Ë∞ÉÁî® RPOP ÂëΩ‰ª§ÔºåËøôÂ∞±‰ºöÂØºËá¥Ê∂àË¥πËÄÖÁ®ãÂ∫èÁöÑ <strong>CPU ‰∏ÄÁõ¥Ê∂àËÄóÂú®ÊâßË°å RPOP ÂëΩ‰ª§‰∏äÔºåÂ∏¶Êù•‰∏çÂøÖË¶ÅÁöÑÊÄßËÉΩÊçüÂ§±„ÄÇ</strong></p>
<p>‰∏∫‰∫ÜËß£ÂÜ≥Ëøô‰∏™ÈóÆÈ¢òÔºåRedisÊèê‰æõ‰∫Ü BRPOP ÂëΩ‰ª§„ÄÇBRPOPÂëΩ‰ª§‰πüÁß∞‰∏∫ÈòªÂ°ûÂºèËØªÂèñÔºåÂÆ¢Êà∑Á´ØÂú®Ê≤°ÊúâËØªÂà∞ÈòüÂàóÊï∞ÊçÆÊó∂ÔºåËá™Âä®ÈòªÂ°ûÔºåÁõ¥Âà∞ÊúâÊñ∞ÁöÑÊï∞ÊçÆÂÜôÂÖ•ÈòüÂàóÔºåÂÜçÂºÄÂßãËØªÂèñÊñ∞Êï∞ÊçÆ„ÄÇÂíåÊ∂àË¥πËÄÖÁ®ãÂ∫èËá™Â∑±‰∏çÂÅúÂú∞Ë∞ÉÁî®RPOPÂëΩ‰ª§Áõ∏ÊØîÔºåËøôÁßçÊñπÂºèËÉΩËäÇÁúÅCPUÂºÄÈîÄ„ÄÇ</p>
</li>
<li>
<p>Â¶Ç‰ΩïÂ§ÑÁêÜÈáçÂ§çÁöÑÊ∂àÊÅØÔºü</p>
<p>Ê∂àË¥πËÄÖË¶ÅÂÆûÁé∞ÈáçÂ§çÊ∂àÊÅØÁöÑÂà§Êñ≠ÔºåÈúÄË¶Å2‰∏™ÊñπÈù¢ÁöÑË¶ÅÊ±Ç:</p>
<ul>
<li>ÊØè‰∏™Ê∂àÊÅØÈÉΩÊúâ‰∏Ä‰∏™ÂÖ®Â±ÄÁöÑID„ÄÇ</li>
<li>Ê∂àË¥πËÄÖË¶ÅËÆ∞ÂΩïÂ∑≤ÁªèÂ§ÑÁêÜËøáÁöÑÊ∂àÊÅØÁöÑID„ÄÇÂΩìÊî∂Âà∞‰∏ÄÊù°Ê∂àÊÅØÂêéÔºåÊ∂àË¥πËÄÖÁ®ãÂ∫èÂ∞±ÂèØ‰ª•ÂØπÊØîÊî∂Âà∞ÁöÑÊ∂àÊÅØ ID ÂíåËÆ∞ÂΩïÁöÑÂ∑≤Â§ÑÁêÜËøáÁöÑÊ∂àÊÅØ IDÔºåÊù•Âà§Êñ≠ÂΩìÂâçÊî∂Âà∞ÁöÑÊ∂àÊÅØÊúâÊ≤°ÊúâÁªèËøáÂ§ÑÁêÜ„ÄÇÂ¶ÇÊûúÂ∑≤ÁªèÂ§ÑÁêÜËøáÔºåÈÇ£‰πàÔºåÊ∂àË¥πËÄÖÁ®ãÂ∫èÂ∞±‰∏çÂÜçËøõË°åÂ§ÑÁêÜ‰∫Ü„ÄÇ</li>
</ul>
<p>‰ΩÜÊòØ <strong>List Âπ∂‰∏ç‰ºö‰∏∫ÊØè‰∏™Ê∂àÊÅØÁîüÊàê ID Âè∑ÔºåÊâÄ‰ª•Êàë‰ª¨ÈúÄË¶ÅËá™Ë°å‰∏∫ÊØè‰∏™Ê∂àÊÅØÁîüÊàê‰∏Ä‰∏™ÂÖ®Â±ÄÂîØ‰∏ÄID</strong>ÔºåÁîüÊàê‰πãÂêéÊàë‰ª¨Âú®Áî® LPUSH ÂëΩ‰ª§ÊääÊ∂àÊÅØÊèíÂÖ• List Êó∂ÔºåÈúÄË¶ÅÂú®Ê∂àÊÅØ‰∏≠ÂåÖÂê´Ëøô‰∏™ÂÖ®Â±ÄÂîØ‰∏Ä ID„ÄÇ</p>
</li>
<li>
<p>Â¶Ç‰Ωï‰øùËØÅÊ∂àÊÅØÁöÑÂèØÈù†ÊÄßÔºü</p>
<p>ÂΩìÊ∂àË¥πËÄÖÁ®ãÂ∫è‰ªé List ‰∏≠ËØªÂèñ‰∏ÄÊù°Ê∂àÊÅØÂêéÔºåList Â∞±‰∏ç‰ºöÂÜçÁïôÂ≠òËøôÊù°Ê∂àÊÅØ‰∫Ü„ÄÇÊâÄ‰ª•ÔºåÂ¶ÇÊûúÊ∂àË¥πËÄÖÁ®ãÂ∫èÂú®Â§ÑÁêÜÊ∂àÊÅØÁöÑËøáÁ®ãÂá∫Áé∞‰∫ÜÊïÖÈöúÊàñÂÆïÊú∫ÔºåÂ∞±‰ºöÂØºËá¥Ê∂àÊÅØÊ≤°ÊúâÂ§ÑÁêÜÂÆåÊàêÔºåÈÇ£‰πàÔºåÊ∂àË¥πËÄÖÁ®ãÂ∫èÂÜçÊ¨°ÂêØÂä®ÂêéÔºåÂ∞±Ê≤°Ê≥ïÂÜçÊ¨°‰ªéList ‰∏≠ËØªÂèñÊ∂àÊÅØ‰∫Ü„ÄÇ</p>
<p>‰∏∫‰∫ÜÁïôÂ≠òÊ∂àÊÅØÔºåListÁ±ªÂûãÊèê‰æõ‰∫Ü BRPOPLPUSH ÂëΩ‰ª§ÔºåËøô‰∏™ÂëΩ‰ª§<strong>ÁöÑ‰ΩúÁî®ÊòØËÆ©Ê∂àË¥πËÄÖÁ®ãÂ∫è‰ªé‰∏Ä‰∏™ List ‰∏≠ËØªÂèñÊ∂àÊÅØÔºåÂêåÊó∂ÔºåRedis ‰ºöÊääËøô‰∏™Ê∂àÊÅØÂÜçÊèíÂÖ•Âà∞Âè¶‰∏Ä‰∏™ List(ÂèØ‰ª•Âè´‰ΩúÂ§á‰ªΩ List)ÁïôÂ≠ò</strong>„ÄÇ</p>
<p>ËøôÊ†∑‰∏ÄÊù•ÔºåÂ¶ÇÊûúÊ∂àË¥πËÄÖÁ®ãÂ∫èËØª‰∫ÜÊ∂àÊÅØ‰ΩÜÊ≤°ËÉΩÊ≠£Â∏∏Â§ÑÁêÜÔºåÁ≠âÂÆÉÈáçÂêØÂêéÔºåÂ∞±ÂèØ‰ª•‰ªéÂ§á‰ªΩ List ‰∏≠ÈáçÊñ∞ËØªÂèñÊ∂àÊÅØÂπ∂ËøõË°åÂ§ÑÁêÜ‰∫Ü„ÄÇ</p>
<h5 id="ÊÄªÁªì">ÊÄªÁªì
</h5><p>Âü∫‰∫é List Á±ªÂûãÁöÑÊ∂àÊÅØÈòüÂàóÔºåÊª°Ë∂≥Ê∂àÊÅØÈòüÂàóÁöÑ‰∏âÂ§ßÈúÄÊ±Ç(Ê∂àÊÅØ‰øùÂ∫è„ÄÅÂ§ÑÁêÜÈáçÂ§çÁöÑÊ∂àÊÅØÂíå‰øùËØÅÊ∂àÊÅØÂèØÈù†ÊÄß)„ÄÇ</p>
<ul>
<li>Ê∂àÊÅØ‰øùÂ∫è:‰ΩøÁî® LPUSH+RPOP;</li>
<li>ÈòªÂ°ûËØªÂèñ:‰ΩøÁî® BRPOP;</li>
<li>ÈáçÂ§çÊ∂àÊÅØÂ§ÑÁêÜ:Áîü‰∫ßËÄÖËá™Ë°åÂÆûÁé∞ÂÖ®Â±ÄÂîØ- ID;</li>
<li>Ê∂àÊÅØÁöÑÂèØÈù†ÊÄß:‰ΩøÁî® BRPOPLPUSH</li>
</ul>
<h5 id="listÂÅöÊ∂àÊÅØÈòüÂàóÁöÑÁº∫Èô∑">ListÂÅöÊ∂àÊÅØÈòüÂàóÁöÑÁº∫Èô∑
</h5><p><strong>List ‰∏çÊîØÊåÅÂ§ö‰∏™Ê∂àË¥πËÄÖÊ∂àË¥πÂêå‰∏ÄÊù°Ê∂àÊÅØ</strong>ÔºåÂõ†‰∏∫‰∏ÄÊó¶Ê∂àË¥πËÄÖÊãâÂèñ‰∏ÄÊù°Ê∂àÊÅØÂêéÔºåËøôÊù°Ê∂àÊÅØÂ∞±‰ªé List ‰∏≠Âà†Èô§‰∫ÜÊó†Ê≥ïË¢´ÂÖ∂ÂÆÉÊ∂àË¥πËÄÖÂÜçÊ¨°Ê∂àË¥π„ÄÇ</p>
<p>Ë¶ÅÂÆûÁé∞‰∏ÄÊù°Ê∂àÊÅØÂèØ‰ª•Ë¢´Â§ö‰∏™Ê∂àË¥πËÄÖÊ∂àË¥πÔºåÈÇ£‰πàÂ∞±Ë¶ÅÂ∞ÜÂ§ö‰∏™Ê∂àË¥πËÄÖÁªÑÊàê‰∏Ä‰∏™Ê∂àË¥πÁªÑÔºå‰ΩøÂæóÂ§ö‰∏™Ê∂àË¥πËÄÖÂèØ‰ª•Ê∂àË¥πÂêå‰∏ÄÊù°Ê∂àÊÅØÔºå‰ΩÜÊòØ <strong>List Á±ªÂûãÂπ∂‰∏çÊîØÊåÅÊ∂àË¥πÁªÑÁöÑÂÆûÁé∞</strong>„ÄÇ</p>
<p>ËøôÂ∞±Ë¶ÅËØ¥Ëµ∑ Redis ‰ªé 5.0 ÁâàÊú¨ÂºÄÂßãÊèê‰æõÁöÑ Stream Êï∞ÊçÆÁ±ªÂûã‰∫ÜÔºåStream ÂêåÊ†∑ËÉΩÂ§üÊª°Ë∂≥Ê∂àÊÅØÈòüÂàóÁöÑ‰∏âÂ§ßÈúÄÊ±ÇÔºåËÄå‰∏îÂÆÉËøòÊîØÊåÅ„ÄåÊ∂àË¥πÁªÑ„ÄçÂΩ¢ÂºèÁöÑÊ∂àÊÅØËØªÂèñ„ÄÇ</p>
</li>
</ol>
<h2 id="hash">Hash
</h2><h3 id="‰ªãÁªç-2">‰ªãÁªç
</h3><p>Hash ÊòØ‰∏Ä‰∏™ÈîÆÂÄºÂØπ(key-value)ÈõÜÂêàÔºåÂÖ∂‰∏≠ value ÁöÑÂΩ¢ÂºèÂ¶Ç:value=[{field1,value1},&hellip;{fieldN,valueN}]„ÄÇHash ÁâπÂà´ÈÄÇÂêàÁî®‰∫éÂ≠òÂÇ®ÂØπË±°„ÄÇ</p>
<h3 id="ÂÜÖÈÉ®ÂÆûÁé∞-2">ÂÜÖÈÉ®ÂÆûÁé∞
</h3><p>Hash Á±ªÂûãÁöÑÂ∫ïÂ±ÇÊï∞ÊçÆÁªìÊûÑÊòØÁî±<strong>ÂéãÁº©ÂàóË°®ÊàñÂìàÂ∏åË°®</strong>ÂÆûÁé∞ÁöÑ:</p>
<p>Â¶ÇÊûúÂìàÂ∏åÁ±ªÂûãÂÖÉÁ¥†‰∏™Êï∞Â∞è‰∫é 512 ‰∏™ÔºåÊâÄÊúâÂÄºÂ∞è‰∫é64 Â≠óËäÇÁöÑËØùÔºåRedis ‰ºö‰ΩøÁî®<strong>ÂéãÁº©ÂàóË°®</strong>‰Ωú‰∏∫ Hash Á±ªÂûãÁöÑÂ∫ïÂ±ÇÊï∞ÊçÆÁªìÊûÑ;</p>
<p>Â¶ÇÊûúÂìàÂ∏åÁ±ªÂûãÂÖÉÁ¥†‰∏çÊª°Ë∂≥‰∏äÈù¢Êù°‰ª∂ÔºåRedis ‰ºö‰ΩøÁî®<strong>ÂìàÂ∏åË°®</strong>‰Ωú‰∏∫ Hash Á±ªÂûãÁöÑ Â∫ïÂ±ÇÊï∞ÊçÆÁªìÊûÑ,</p>
<p><strong>Âú® Redis 7.0 ‰∏≠ÔºåÂéãÁº©ÂàóË°®Êï∞ÊçÆÁªìÊûÑÂ∑≤ÁªèÂ∫üÂºÉ‰∫ÜÔºå‰∫§Áî± listpack Êï∞ÊçÆÁªìÊûÑÊù•ÂÆûÁé∞‰∫Ü„ÄÇ</strong></p>
<h3 id="Â∏∏Áî®Êìç‰Ωú-2">Â∏∏Áî®Êìç‰Ωú
</h3><ul>
<li>hset key field value:ÊåáÂÆö‰∏Ä‰∏™ keyÔºåËÆæÁΩÆÂ≠óÊÆµÂêçÊâÄÂØπÂ∫îÁöÑÂÄº</li>
<li>hget key field:Ëé∑ÂèñÊåáÂÆö key ÂíåÂ≠óÊÆµÂØπÂ∫îÁöÑÂÄº(‰πüÂèØ‰ª•ÊâπÈáèÊ∑ªÂä†)ÔºåÊàêÂäüËøîÂõûÊìç‰ΩúÊàêÂäüÁöÑÂ≠óÊÆµÊï∞Èáè</li>
<li>hmset key field value [field value&hellip;]:ÊâπÈáèËÆæÁΩÆÊüê‰∏™ key ÁöÑÂ≠óÊÆµÂíåÂØπÂ∫îÂÄºÔºåÊàêÂäüËøîÂõû OKhmget key filed [filed&hellip;]:ÊâπÈáèËøîÂõûÊüê‰∏™ key ‰∏≠ÊåáÂÆöÁöÑÂ≠óÊÆµÂíåÂÖ∂ÂØπÂ∫îÂÄº</li>
<li>hgetall key:Áî®‰∫éËøîÂõû‰∏Ä‰∏™ hash ‰∏≠ÂÖ®ÈÉ®ÁöÑÂ≠óÊÆµÂíåÂÄº</li>
<li>hexists key field:ÊòØÂê¶Â≠òÂú®Êüê‰∏™Â≠óÊÆµ</li>
<li>hdel key field:Âà†Èô§ key ‰∏≠ÁöÑÂ≠óÊÆµÔºåÂèØ‰ª•Âà†Èô§ÊâÄÊúâÂ≠óÊÆµÔºåÂ¶ÇÊûúÂà†Èô§ÊâÄÊúâÂ≠óÊÆµÔºåÁõ∏ÂΩì‰∫éÂà†Èô§‰∫ÜËøô‰∏™ key</li>
<li>hincrby key filed n:Â¢ûÂáèÊìç‰ΩúÔºåhash ‰∏≠Ê≤°ÊúâÁ±ª‰ºº decrby ÁöÑÂëΩ‰ª§ÔºåÂ¶ÇÊûúÊÉ≥Ë¶ÅÂáèÂÄºÂ∞±Áõ¥Êé•Áî®Ë¥üÊï∞</li>
<li>hkeys key:Ëé∑ÂèñÊâÄÊúâÁöÑÂ≠óÊÆµÂÄº</li>
<li>hvals key:Ëé∑ÂèñÊâÄÊúâÁöÑÂÄº</li>
</ul>
<h3 id="Â∫îÁî®Âú∫ÊôØ-2">Â∫îÁî®Âú∫ÊôØ
</h3><h4 id="ÁºìÂ≠òÂØπË±°-1">ÁºìÂ≠òÂØπË±°
</h4><p>Hash Á±ªÂûãÁöÑ(keyÔºåfieldÔºå value)ÁöÑÁªìÊûÑ‰∏éÂØπË±°ÁöÑ(ÂØπË±°idÔºåÂ±ûÊÄßÔºåÂÄº)ÁöÑÁªìÊûÑÁõ∏‰ººÔºå‰πüÂèØ‰ª•Áî®Êù•Â≠òÂÇ®ÂØπË±°„ÄÇ</p>
<p>Âú®‰ªãÁªç String Á±ªÂûãÁöÑÂ∫îÁî®Âú∫ÊôØÊó∂ÊúâÊâÄ‰ªãÁªçÔºåString +Json‰πüÊòØÂ≠òÂÇ®ÂØπË±°ÁöÑ‰∏ÄÁßçÊñπÂºèÔºåÈÇ£‰πàÂ≠òÂÇ®ÂØπË±°Êó∂ÔºåÂà∞Â∫ïÁî® String + json ËøòÊòØÁî® Hash Âë¢?</p>
<p>‰∏ÄËà¨ÂØπË±°Áî® String +Json Â≠òÂÇ®ÔºåÂØπË±°‰∏≠Êüê‰∫õÈ¢ëÁπÅÂèòÂåñÁöÑÂ±ûÊÄßÂèØ‰ª•ËÄÉËôëÊäΩÂá∫Êù•Áî® Hash Á±ªÂûãÂ≠òÂÇ®„ÄÇ</p>
<h4 id="Ë¥≠Áâ©ËΩ¶">Ë¥≠Áâ©ËΩ¶
</h4><p>‰ª•Áî®Êà∑ id ‰∏∫ keyÔºåÂïÜÂìÅ id ‰∏∫ fieldÔºåÂïÜÂìÅÊï∞Èáè‰∏∫ valueÔºåÊÅ∞Â•ΩÊûÑÊàê‰∫ÜË¥≠Áâ©ËΩ¶ÁöÑ3‰∏™Ë¶ÅÁ¥†„ÄÇ</p>
<p>Ê∂âÂèäÁöÑÂëΩ‰ª§Â¶Ç‰∏ã:</p>
<ul>
<li>Ê∑ªÂä†ÂïÜÂìÅ:HSET cart:{Áî®Êà∑id}{ÂïÜÂìÅid} 1</li>
<li>Ê∑ªÂä†Êï∞Èáè:HINCRBY cart:fÁî®Êà∑id}{ÂïÜÂìÅid} 1</li>
<li>ÂïÜÂìÅÊÄªÊï∞:HLEN cart:{Áî®Êà∑id}</li>
<li>Âà†Èô§ÂïÜÂìÅ:HDEL cart:{Áî®Êà∑id}{ÂïÜÂìÅid}</li>
<li>Ëé∑ÂèñË¥≠Áâ©ËΩ¶ÊâÄÊúâÂïÜÂìÅ: HGETALL cart:{Áî®Êà∑id}</li>
</ul>
<p>ÂΩìÂâç‰ªÖ‰ªÖÊòØÂ∞ÜÂïÜÂìÅIDÂ≠òÂÇ®Âà∞‰∫ÜRedis ‰∏≠ÔºåÂú®ÂõûÊòæÂïÜÂìÅÂÖ∑‰Ωì‰ø°ÊÅØÁöÑÊó∂ÂÄôÔºåËøòÈúÄË¶ÅÊãøÁùÄÂïÜÂìÅ id Êü•ËØ¢‰∏ÄÊ¨°Êï∞ÊçÆÂ∫ìÔºåËé∑ÂèñÂÆåÊï¥ÁöÑÂïÜÂìÅÁöÑ‰ø°ÊÅØ„ÄÇ</p>
<h2 id="set">Set
</h2><h3 id="‰ªãÁªç-3">‰ªãÁªç
</h3><p>Set Á±ªÂûãÊòØ‰∏Ä‰∏™Êó†Â∫èÂπ∂ÂîØ‰∏ÄÁöÑÈîÆÂÄºÈõÜÂêàÔºåÂÆÉÁöÑÂ≠òÂÇ®È°∫Â∫è‰∏ç‰ºöÊåâÁÖßÊèíÂÖ•ÁöÑÂÖàÂêéÈ°∫Â∫èËøõË°åÂ≠òÂÇ®„ÄÇ</p>
<p>‰∏Ä‰∏™ÈõÜÂêàÊúÄÂ§öÂèØ‰ª•Â≠òÂÇ® 2^32-1 ‰∏™ÂÖÉÁ¥†„ÄÇÊ¶ÇÂøµÂíåÊï∞Â≠¶‰∏≠‰∏™ÁöÑÈõÜÂêàÂü∫Êú¨Á±ª‰ººÔºåÂèØ‰ª•‰∫§ÈõÜÔºåÂπ∂ÈõÜÔºåÂ∑ÆÈõÜÁ≠âÁ≠âÔºåÊâÄ‰ª• Set Á±ªÂûãÈô§‰∫ÜÊîØÊåÅÈõÜÂêàÂÜÖÁöÑÂ¢ûÂà†ÊîπÊü•ÔºåÂêåÊó∂ËøòÊîØÊåÅÂ§ö‰∏™ÈõÜÂêàÂèñ‰∫§ÈõÜ„ÄÅÂπ∂ÈõÜ„ÄÅÂ∑ÆÈõÜ„ÄÇ</p>
<p>Set Á±ªÂûãÂíå List Á±ªÂûãÁöÑÂå∫Âà´Â¶Ç‰∏ã:</p>
<ul>
<li>List ÂèØ‰ª•Â≠òÂÇ®ÈáçÂ§çÂÖÉÁ¥†ÔºåSet Âè™ËÉΩÂ≠òÂÇ®ÈùûÈáçÂ§çÂÖÉÁ¥†;</li>
<li>List ÊòØÊåâÁÖßÂÖÉÁ¥†ÁöÑÂÖàÂêéÈ°∫Â∫èÂ≠òÂÇ®ÂÖÉÁ¥†ÁöÑÔºåËÄå Set ÂàôÊòØÊó†Â∫èÊñπÂºèÂ≠òÂÇ®ÂÖÉÁ¥†ÁöÑ„ÄÇ</li>
</ul>
<h3 id="ÂÜÖÈÉ®ÂÆûÁé∞-3">ÂÜÖÈÉ®ÂÆûÁé∞
</h3><p>Set Á±ªÂûãÁöÑÂ∫ïÂ±ÇÊï∞ÊçÆÁªìÊûÑÊòØÁî±<strong>ÂìàÂ∏åË°®ÊàñÊï¥Êï∞ÈõÜÂêà</strong>ÂÆûÁé∞ÁöÑÔºö</p>
<ul>
<li>Â¶ÇÊûúÈõÜÂêà‰∏≠ÁöÑÂÖÉÁ¥†ÈÉΩÊòØÊï¥Êï∞‰∏îÂÖÉÁ¥†‰∏™Êï∞Â∞è‰∫é 512‰∏™ÔºåRedis ‰ºö‰ΩøÁî®<strong>Êï¥Êï∞ÈõÜÂêà</strong>‰Ωú‰∏∫ Set Á±ªÂûãÁöÑÂ∫ïÂ±ÇÊï∞ÊçÆÁªìÊûÑ;</li>
<li>Â¶ÇÊûúÈõÜÂêà‰∏≠ÁöÑÂÖÉÁ¥†‰∏çÊª°Ë∂≥‰∏äÈù¢Êù°‰ª∂ÔºåÂàô Redis ‰ΩøÁî®<strong>ÂìàÂ∏åË°®</strong>‰Ωú‰∏∫ Set Á±ªÂûãÁöÑÂ∫ïÂ±ÇÊï∞ÊçÆÁªìÊûÑ„ÄÇ</li>
</ul>
<h3 id="Â∏∏Áî®Êìç‰Ωú-3">Â∏∏Áî®Êìç‰Ωú
</h3><ul>
<li>sadd:Ê∑ªÂä†Êñ∞ÂÖÉÁ¥†ÔºåÂÖÉÁ¥†Â≠òÂú®ÂàôÂøΩÁï•Ôºåkey‰∏çÂ≠òÂú®ÂàôÊñ∞Âª∫</li>
<li>smembers:ÂàóÂá∫ÈõÜÂêà‰∏≠ÊâÄÊúâÂÖÉÁ¥†</li>
<li>sismember:Âà§Êñ≠ÂÖÉÁ¥†ÊòØÂê¶Âú®ÈõÜÂêà‰∏≠</li>
<li>scard:ËøîÂõûÈõÜÂêà‰∏≠ÂÖÉÁ¥†‰∏™Êï∞</li>
<li>srem:ÁßªÈô§ÈõÜÂêà‰∏≠‰∏Ä‰∏™ÊàñÂ§ö‰∏™ÂÖÉÁ¥†ÔºåÂ¶ÇÊûúÁßªÈô§ÁöÑ‰∏çÂ≠òÂú®Â∞±‰∏çÂ§ÑÁêÜ</li>
<li>sinter:ÂØπ‰∏§‰∏™ÈõÜÂêàÊ±Ç‰∫§ÈõÜ</li>
<li>sunion:ÂØπ‰∏§‰∏™ÈõÜÂêàÊ±ÇÂπ∂ÈõÜ</li>
<li>sdiff:ÂØπ‰∏§‰∏™ÈõÜÂêàÊ±ÇÂ∑ÆÈõÜ</li>
<li>setnx:Âêë Redis ‰∏≠Ê∑ªÂä†‰∏Ä‰∏™ keyÔºåÂè™Áî®ÂΩì key ‰∏çÂ≠òÂú®ÁöÑÊó∂ÂÄôÊâçÊ∑ªÂä†Âπ∂ËøîÂõû 1ÔºåÂ≠òÂú®Âàô‰∏çÊ∑ªÂä†ËøîÂõû 0</li>
</ul>
<h3 id="Â∫îÁî®Âú∫ÊôØ-3">Â∫îÁî®Âú∫ÊôØ
</h3><p>ÈõÜÂêàÁöÑ‰∏ªË¶ÅÂá†‰∏™ÁâπÊÄßÔºåÊó†Â∫è„ÄÅ‰∏çÂèØÈáçÂ§ç„ÄÅÊîØÊåÅÂπ∂‰∫§Â∑ÆÁ≠âÊìç‰Ωú„ÄÇ</p>
<p>Âõ†Ê≠§ Set Á±ªÂûãÊØîËæÉÈÄÇÂêàÁî®Êù•Êï∞ÊçÆÂéªÈáçÂíå‰øùÈöúÊï∞ÊçÆÁöÑÂîØ‰∏ÄÊÄßÔºåËøòÂèØ‰ª•Áî®Êù•ÁªüËÆ°Â§ö‰∏™ÈõÜÂêàÁöÑ‰∫§ÈõÜ„ÄÅÈîôÈõÜÂíåÂπ∂ÈõÜÁ≠âÔºåÂΩìÊàë‰ª¨Â≠òÂÇ®ÁöÑÊï∞ÊçÆÊòØÊó†Â∫èÂπ∂‰∏îÈúÄË¶ÅÂéªÈáçÁöÑÊÉÖÂÜµ‰∏ãÔºåÊØîËæÉÈÄÇÂêà‰ΩøÁî®ÈõÜÂêàÁ±ªÂûãËøõË°åÂ≠òÂÇ®„ÄÇ</p>
<p>‰ΩÜÊòØËøôÈáåÊúâ‰∏Ä‰∏™ÊΩúÂú®ÁöÑÈ£éÈô©„ÄÇ<strong>Set ÁöÑÂ∑ÆÈõÜ„ÄÅÂπ∂ÈõÜÂíå‰∫§ÈõÜÁöÑËÆ°ÁÆóÂ§çÊùÇÂ∫¶ËæÉÈ´òÔºåÂú®Êï∞ÊçÆÈáèËæÉÂ§ßÁöÑÊÉÖÂÜµ‰∏ãÔºåÂ¶ÇÊûúÁõ¥Êé•ÊâßË°åËøô‰∫õËÆ°ÁÆóÔºå‰ºöÂØºËá¥ Redis ÂÆû‰æãÈòªÂ°û„ÄÇ</strong></p>
<p>Âú®‰∏ª‰ªéÈõÜÁæ§‰∏≠Ôºå‰∏∫‰∫ÜÈÅøÂÖç‰∏ªÂ∫ìÂõ†‰∏∫ Set ÂÅöËÅöÂêàËÆ°ÁÆó(‰∫§ÈõÜ„ÄÅÂ∑ÆÈõÜ„ÄÅÂπ∂ÈõÜ)Êó∂ÂØºËá¥‰∏ªÂ∫ìË¢´ÈòªÂ°ûÔºåÊàë‰ª¨ÂèØ‰ª•ÈÄâÊã©‰∏Ä‰∏™‰ªéÂ∫ìÂÆåÊàêËÅöÂêàÁªüËÆ°ÔºåÊàñËÄÖÊääÊï∞ÊçÆËøîÂõûÁªôÂÆ¢Êà∑Á´ØÔºåÁî±ÂÆ¢Êà∑Á´ØÊù•ÂÆåÊàêËÅöÂêàÁªüËÆ°„ÄÇ</p>
<h4 id="ÁÇπËµû">ÁÇπËµû
</h4><p>Set Á±ªÂûãÂèØ‰ª•‰øùËØÅ‰∏Ä‰∏™Áî®Êà∑Âè™ËÉΩÁÇπ‰∏Ä‰∏™Ëµû„ÄÇ</p>
<p>key ÊòØÊñáÁ´†idÔºåvalue ÊòØÁî®Êà∑id</p>
<h4 id="ÂÖ±ÂêåÂÖ≥Ê≥®">ÂÖ±ÂêåÂÖ≥Ê≥®
</h4><p>Set Á±ªÂûãÊîØÊåÅ‰∫§ÈõÜËøêÁÆóÔºåÊâÄ‰ª•ÂèØ‰ª•Áî®Êù•ËÆ°ÁÆóÂÖ±ÂêåÂÖ≥Ê≥®ÁöÑÂ•ΩÂèã„ÄÅÂÖ¨‰ºóÂè∑Á≠â„ÄÇ</p>
<p>key ÂèØ‰ª•ÊòØÁî®Êà∑idÔºåvalue ÂàôÊòØÂ∑≤ÂÖ≥Ê≥®ÁöÑÂÖ¨‰ºóÂè∑ÁöÑid„ÄÇ</p>
<h4 id="ÊäΩÂ•ñÊ¥ªÂä®">ÊäΩÂ•ñÊ¥ªÂä®
</h4><p>Â≠òÂÇ®ÊüêÊ¥ªÂä®‰∏≠‰∏≠Â•ñÁöÑÁî®Êà∑Âêç ÔºåSet Á±ªÂûãÂõ†‰∏∫ÊúâÂéªÈáçÂäüËÉΩÔºåÂèØ‰ª•‰øùËØÅÂêå‰∏Ä‰∏™Áî®Êà∑‰∏ç‰ºö‰∏≠Â•ñ‰∏§Ê¨°„ÄÇ</p>
<h2 id="zset">Zset
</h2><h3 id="‰ªãÁªç-4">‰ªãÁªç
</h3><p>Zset Á±ªÂûã(ÊúâÂ∫èÈõÜÂêàÁ±ªÂûã)Áõ∏ÊØî‰∫é Set Á±ªÂûãÂ§ö‰∫Ü‰∏Ä‰∏™ÊéíÂ∫èÂ±ûÊÄß score(ÂàÜÂÄº)ÔºåÂØπ‰∫éÊúâÂ∫èÈõÜÂêà ZSet Êù•ËØ¥ÊØè‰∏™Â≠òÂÇ®ÂÖÉÁ¥†Áõ∏ÂΩì‰∫éÊúâ‰∏§‰∏™ÂÄºÁªÑÊàêÁöÑÔºå‰∏Ä‰∏™ÊòØÊúâÈõÜÂêàÁöÑÂÖÉÁ¥†ÂÄºÔºå‰∏Ä‰∏™ÊòØÊéíÂ∫èÂÄº„ÄÇ</p>
<p>ÊúâÂ∫èÈõÜÂêà‰øùÁïô‰∫ÜÈõÜÂêà‰∏çËÉΩÊúâÈáçÂ§çÊàêÂëòÁöÑÁâπÊÄß(ÂàÜÂÄºÂèØ‰ª•ÈáçÂ§ç)Ôºå‰ΩÜ‰∏çÂêåÁöÑÊòØÔºåÊúâÂ∫èÈõÜÂêà‰∏≠ÁöÑÂÖÉÁ¥†ÂèØ‰ª•ÊéíÂ∫è„ÄÇ</p>
<h3 id="ÂÜÖÈÉ®ÂÆûÁé∞-4">ÂÜÖÈÉ®ÂÆûÁé∞
</h3><p>Zset Á±ªÂûãÁöÑÂ∫ïÂ±ÇÊï∞ÊçÆÁªìÊûÑÊòØÁî±<strong>ÂéãÁº©ÂàóË°®ÊàñË∑≥Ë°®</strong>ÂÆûÁé∞ÁöÑ:</p>
<p>Â¶ÇÊûúÊúâÂ∫èÈõÜÂêàÁöÑÂÖÉÁ¥†‰∏™Êï∞Â∞è‰∫é 128‰∏™ÔºåÂπ∂‰∏îÊØè‰∏™ÂÖÉÁ¥†ÁöÑÂÄºÂ∞è‰∫é 64Â≠óËäÇÊó∂ÔºåRedis ‰ºö‰ΩøÁî®<strong>ÂéãÁº©ÂàóË°®</strong></p>
<p>‰Ωú‰∏∫ Zset Á±ªÂûãÁöÑÂ∫ïÂ±ÇÊï∞ÊçÆÁªìÊûÑ:</p>
<p>Â¶ÇÊûúÊúâÂ∫èÈõÜÂêàÁöÑÂÖÉÁ¥†‰∏çÊª°Ë∂≥‰∏äÈù¢ÁöÑÊù°‰ª∂ÔºåRedis ‰ºö‰ΩøÁî®<strong>Ë∑≥Ë°®</strong>‰Ωú‰∏∫ Zset Á±ªÂûãÁöÑÂ∫ïÂ±ÇÊï∞ÊçÆÁªìÊûÑ;</p>
<p><strong>Âú® Redis 7.0 ‰∏≠ÔºåÂéãÁº©ÂàóË°®Êï∞ÊçÆÁªìÊûÑÂ∑≤ÁªèÂ∫üÂºÉ‰∫ÜÔºå‰∫§Áî± listpack Êï∞ÊçÆÁªìÊûÑÊù•ÂÆûÁé∞‰∫Ü„ÄÇ</strong></p>
<h3 id="Â∏∏Áî®Êìç‰Ωú-4">Â∏∏Áî®Êìç‰Ωú
</h3><ul>
<li>
<p>zadd:Êñ∞Â¢û‰∏Ä‰∏™ÊúâÂ∫èÈõÜÂêàÔºåÂπ∂Âä†ÂÖ•‰∏Ä‰∏™ÂÖÉÁ¥†</p>
</li>
<li>
<p>zrange:ÂàóÂá∫ÊúâÂ∫èÈõÜÂêà‰∏≠ÁöÑÂÖÉÁ¥†</p>
</li>
<li>
<p>zrem:‰ªéÊúâÂ∫èÈõÜÂêà‰∏≠Âà†Èô§ÂÖÉÁ¥†</p>
</li>
<li>
<p>zcard:ËøîÂõûÊúâÂ∫èÈõÜÂêà‰∏≠ÁöÑÊï∞Èáè</p>
<p>Ê≥®ÊÑèÔºöÁõ∏ÊØî‰∫éSetÁ±ªÂûãÔºåZsetÁ±ªÂûãÊ≤°ÊúâÊîØÊåÅÂ∑ÆÈõÜËøêÁÆó</p>
</li>
</ul>
<h3 id="Â∫îÁî®Âú∫ÊôØ-4">Â∫îÁî®Âú∫ÊôØ
</h3><p>Zset Á±ªÂûã(Sorted SetÔºåÊúâÂ∫èÈõÜÂêà)ÂèØ‰ª•Ê†πÊçÆÂÖÉÁ¥†ÁöÑÊùÉÈáçÊù•ÊéíÂ∫èÔºåÊàë‰ª¨ÂèØ‰ª•Ëá™Â∑±Êù•ÂÜ≥ÂÆöÊØè‰∏™ÂÖÉÁ¥†ÁöÑÊùÉÈáçÂÄº„ÄÇÊØîÂ¶ÇËØ¥ÔºåÊàë‰ª¨ÂèØ‰ª•Ê†πÊçÆÂÖÉÁ¥†ÊèíÂÖ• Sorted set ÁöÑÊó∂Èó¥Á°ÆÂÆöÊùÉÈáçÂÄºÔºåÂÖàÊèíÂÖ•ÁöÑÂÖÉÁ¥†ÊùÉÈáçÂ∞èÔºåÂêéÊèíÂÖ•ÁöÑÂÖÉÁ¥†ÊùÉÈáçÂ§ß„ÄÇ</p>
<p>Âú®Èù¢ÂØπÈúÄË¶ÅÂ±ïÁ§∫ÊúÄÊñ∞ÂàóË°®„ÄÅÊéíË°åÊ¶úÁ≠âÂú∫ÊôØÊó∂ÔºåÂ¶ÇÊûúÊï∞ÊçÆÊõ¥Êñ∞È¢ëÁπÅÊàñËÄÖÈúÄË¶ÅÂàÜÈ°µÊòæÁ§∫ÔºåÂèØ‰ª•‰ºòÂÖàËÄÉËôë‰ΩøÁî®Sorted Set.</p>
<h4 id="ÊéíË°åÊ¶ú">ÊéíË°åÊ¶ú
</h4><p>ÊúâÂ∫èÈõÜÂêàÊØîËæÉÂÖ∏ÂûãÁöÑ‰ΩøÁî®Âú∫ÊôØÂ∞±ÊòØÊéíË°åÊ¶ú„ÄÇ‰æãÂ¶ÇÂ≠¶ÁîüÊàêÁª©ÁöÑÊéíÂêçÊ¶ú„ÄÅÊ∏∏ÊàèÁßØÂàÜÊéíË°åÊ¶ú„ÄÅËßÜÈ¢ëÊí≠ÊîæÊéíÂêç„ÄÅÁîµÂïÜÁ≥ªÁªü‰∏≠ÂïÜÂìÅÁöÑÈîÄÈáèÊéíÂêçÁ≠â„ÄÇ</p>
<h4 id="ÁîµËØùÂßìÂêçÊéíÂ∫è">ÁîµËØù„ÄÅÂßìÂêçÊéíÂ∫è
</h4><p>‰ΩøÁî®ÊúâÂ∫èÈõÜÂêàÁöÑZRANGEBYLEXÊàñZREVRANGEBYLEXÂèØ‰ª•Â∏ÆÂä©Êàë‰ª¨ÂÆûÁé∞ÁîµËØùÂè∑Á†ÅÊàñÂßìÂêçÁöÑÊéíÂ∫èÔºåÊàë‰ª¨‰ª•(ËøîÂõûÊåáÂÆöÊàêÂëòÂå∫Èó¥ÂÜÖÁöÑÊàêÂëòÔºåÊåâ key Ê≠£Â∫èÊéíÂàóÔºåÂàÜÊï∞ÂøÖÈ°ªÁõ∏Âêå)‰∏∫‰æã„ÄÇZRANGEBYLEX</p>
<p><strong>Ê≥®ÊÑè:‰∏çË¶ÅÂú®ÂàÜÊï∞‰∏ç‰∏ÄËá¥ÁöÑ SortSet ÈõÜÂêà‰∏≠Âéª‰ΩøÁî® ZRANGEBYLEXÂíå ZREVRANGEBYLEX Êåá‰ª§ÔºåÂõ†‰∏∫Ëé∑ÂèñÁöÑÁªìÊûú‰ºö‰∏çÂáÜÁ°Æ„ÄÇ</strong></p>
<h1 id="redisÊï∞ÊçÆÁªìÊûÑ">RedisÊï∞ÊçÆÁªìÊûÑ
</h1><p>ËøôÈáå‰∏ªË¶ÅËÆ≤Ëß£RedisÈîÆÂÄºÂØπ‰∏≠ÂÄºÁöÑÊï∞ÊçÆÁ±ªÂûãÔºå‰πüÂ∞±ÊòØÊï∞ÊçÆÁöÑ‰øùÂ≠òÂΩ¢ÂºèÔºåÂÖ∂Â∫ïÂ±ÇÂÆûÁé∞ÁöÑÊñπÂºèÁöÑÊï∞ÊçÆÁªìÊûÑ„ÄÇ</p>
<p><img src="/image/%e6%95%b0%e6%8d%ae%e7%bb%93%e6%9e%84%e5%af%b9%e5%ba%94%e5%9b%be.png"
	
	
	
	loading="lazy"
	
		alt="Êï∞ÊçÆÁªìÊûÑÂØπÂ∫îÂõæ"
	
	
></p>
<h2 id="ÈîÆÂÄºÂØπÊï∞ÊçÆÂ∫ìÊòØÊÄé‰πàÂÆûÁé∞ÁöÑ">ÈîÆÂÄºÂØπÊï∞ÊçÆÂ∫ìÊòØÊÄé‰πàÂÆûÁé∞ÁöÑÔºü
</h2><p>Redis ÊòØÊÄéÊ†∑ÂÆûÁé∞ÈîÆÂÄºÂØπ(key-value)Êï∞ÊçÆÂ∫ìÁöÑ„ÄÇ</p>
<p>Redis ÁöÑÈîÆÂÄºÂØπ‰∏≠ÁöÑ key Â∞±ÊòØÂ≠óÁ¨¶‰∏≤ÂØπË±°ÔºåËÄå <strong>value ÂèØ‰ª•ÊòØÂ≠óÁ¨¶‰∏≤ÂØπË±°Ôºå‰πüÂèØ‰ª•ÊòØÈõÜÂêàÊï∞ÊçÆÁ±ªÂûãÁöÑÂØπË±°</strong></p>
<p>ÊØîÂ¶Ç List ÂØπË±°„ÄÅHash ÂØπË±°„ÄÅSet ÂØπË±°Âíå Zset ÂØπË±°„ÄÇ</p>
<p>‰∏æ‰∏™‰æãÂ≠êÔºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&gt; SET name &#34; ÈöîÂ£ÅËÄÅÁéã&#34;
</span></span><span class="line"><span class="cl">OK
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&gt; HSET person name &#34;Ê•º‰∏ãËÄÅÂê¥&#34; age 18
</span></span><span class="line"><span class="cl">0
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&gt; RPUSH stu &#34;Â∞èÂ∏Ö&#34; &#34;Â∞èÁæé&#34;
</span></span><span class="line"><span class="cl">(integer) 4
</span></span></code></pre></td></tr></table>
</div>
</div><p>Ëøô‰∫õÂëΩ‰ª§‰ª£Ë°®ÁùÄ:</p>
<ul>
<li>Á¨¨‰∏ÄÊù°ÂëΩ‰ª§:name ÊòØ‰∏Ä‰∏™<strong>Â≠óÁ¨¶‰∏≤ÈîÆ</strong>ÔºåÂõ†‰∏∫ÈîÆÁöÑ<strong>ÂÄºÊòØ‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ÂØπË±°</strong>;</li>
<li>Á¨¨‰∫åÊù°ÂëΩ‰ª§:person ÊòØ‰∏Ä‰∏™<strong>ÂìàÂ∏åË°®ÈîÆ</strong>ÔºåÂõ†‰∏∫ÈîÆÁöÑ<strong>ÂÄºÊòØ‰∏Ä‰∏™ÂåÖÂê´‰∏§‰∏™ÈîÆÂÄºÂØπÁöÑÂìàÂ∏åË°®ÂØπË±°</strong>,</li>
<li>Á¨¨‰∏âÊù°ÂëΩ‰ª§:stu ÊòØ‰∏Ä‰∏™<strong>ÂàóË°®ÈîÆ</strong>ÔºåÂõ†‰∏∫ÈîÆÁöÑ<strong>ÂÄºÊòØ‰∏Ä‰∏™ÂåÖÂê´‰∏§‰∏™ÂÖÉÁ¥†ÁöÑÂàóË°®ÂØπË±°</strong>;</li>
</ul>
<p>Ëøô‰∫õÈîÆÂÄºÂØπÊòØÂ¶Ç‰Ωï‰øùÂ≠òÂú® Redis ‰∏≠ÁöÑÂë¢?</p>
<p>Redis ÊòØ‰ΩøÁî®‰∫Ü‰∏Ä‰∏™„ÄåÂìàÂ∏åË°®„Äç‰øùÂ≠òÊâÄÊúâÈîÆÂÄºÂØπÔºåÂìàÂ∏åË°®ÁöÑÊúÄÂ§ßÂ•ΩÂ§ÑÂ∞±ÊòØËÆ©Êàë‰ª¨ÂèØ‰ª•Áî® O(1) ÁöÑÊó∂Èó¥Â§çÊùÇÂ∫¶Êù•Âø´ÈÄüÊü•ÊâæÂà∞ÈîÆÂÄºÂØπ„ÄÇÂìàÂ∏åË°®ÂÖ∂ÂÆûÂ∞±ÊòØ‰∏Ä‰∏™Êï∞ÁªÑÔºåÊï∞ÁªÑ‰∏≠ÁöÑÂÖÉÁ¥†Âè´ÂÅöÂìàÂ∏åÊ°∂„ÄÇ</p>
<p>Redis ÁöÑÂìàÂ∏åÊ°∂ÊòØÊÄé‰πà‰øùÂ≠òÈîÆÂÄºÂØπÊï∞ÊçÆÁöÑÂë¢?</p>
<p>ÂìàÂ∏åÊ°∂Â≠òÊîæÁöÑÊòØÊåáÂêëÈîÆÂÄºÂØπÊï∞ÊçÆÁöÑÊåáÈíà(dictEntry&quot;<em>)ÔºåËøôÊ†∑ÈÄöËøáÊåáÈíàÂ∞±ËÉΩÊâæÂà∞ÈîÆÂÄºÂØπÊï∞ÊçÆÔºåÁÑ∂ÂêéÂõ†‰∏∫ÈîÆÂÄºÂØπÁöÑÂÄºÂèØ‰ª•‰øùÂ≠òÂ≠óÁ¨¶‰∏≤ÂØπË±°ÂíåÈõÜÂêàÊï∞ÊçÆÁ±ªÂûãÁöÑÂØπË±°ÔºåÊâÄ‰ª•ÈîÆÂÄºÂØπÁöÑÊï∞ÊçÆÁªìÊûÑ‰∏≠Âπ∂‰∏çÊòØÁõ¥Êé•‰øùÂ≠òÂÄºÊú¨Ë∫´ËÄåÊòØ‰øùÂ≠ò‰∫Ü void * key Âíå void</em>value ÊåáÈíàÔºåÂàÜÂà´ÊåáÂêë‰∫ÜÂÆûÈôÖÁöÑÈîÆÂØπË±°ÂíåÂÄºÂØπË±°ÔºåËøôÊ†∑‰∏ÄÊù•ÔºåÂç≥‰ΩøÂÄºÊòØÈõÜÂêàÊï∞ÊçÆÔºå‰πüÂèØ‰ª•ÈÄöËøá void * value ÊåáÈíàÊâæÂà∞„ÄÇ</p>
<p>Redis ‰øùÂ≠òÈîÆÂÄºÂØπÊâÄÊ∂âÂèäÂà∞ÁöÑÊï∞ÊçÆÁªìÊûÑ</p>
<p><img src="/image/%e4%bf%9d%e5%ad%98%e9%94%ae%e5%80%bc%e5%af%b9%e6%b6%89%e5%8f%8a%e5%88%b0%e7%9a%84%e6%95%b0%e6%8d%ae%e7%bb%93%e6%9e%84.png"
	
	
	
	loading="lazy"
	
	
></p>
<ul>
<li>redisDb ÁªìÊûÑÔºåË°®Á§∫ Redis Êï∞ÊçÆÂ∫ìÁöÑÁªìÊûÑÔºåÁªìÊûÑ‰ΩìÈáåÂ≠òÊîæ‰∫ÜÊåáÂêë‰∫Ü dict ÁªìÊûÑÁöÑÊåáÈíà;</li>
<li>dict ÁªìÊûÑÔºåÁªìÊûÑ‰ΩìÈáåÂ≠òÊîæ‰∫Ü2‰∏™ÂìàÂ∏åË°®ÔºåÊ≠£Â∏∏ÊÉÖÂÜµ‰∏ãÈÉΩÊòØÁî®„ÄåÂìàÂ∏åË°®1„ÄçÔºå„ÄåÂìàÂ∏åË°®2„ÄçÂè™ÊúâÂú® rehashÁöÑÊó∂ÂÄôÊâçÁî®;</li>
<li>ditctht ÁªìÊûÑÔºåË°®Á§∫ÂìàÂ∏åË°®ÁöÑÁªìÊûÑÔºåÁªìÊûÑÈáåÂ≠òÊîæ‰∫ÜÂìàÂ∏åË°®Êï∞ÁªÑÔºåÊï∞ÁªÑ‰∏≠ÁöÑÊØè‰∏™ÂÖÉÁ¥†ÈÉΩÊòØÊåáÂêë‰∏Ä‰∏™ÂìàÂ∏åË°®ËäÇÁÇπÁªìÊûÑ(dictEntry)ÁöÑÊåáÈíà;</li>
<li>dictEntry ÁªìÊûÑÔºåË°®Á§∫ÂìàÂ∏åË°®ËäÇÁÇπÁöÑÁªìÊûÑÔºåÁªìÊûÑÈáåÂ≠òÊîæ‰∫Ü **void<em>key Âíå void</em>value ÊåáÈíàÔºå <strong>key ÊåáÂêëÁöÑÊòØ String ÂØπË±°ÔºåËÄå value ÂàôÂèØ‰ª•ÊåáÂêë String ÂØπË±°Ôºå‰πüÂèØ‰ª•ÊåáÂêëÈõÜÂêàÁ±ªÂûãÁöÑÂØπË±°ÔºåÊØîÂ¶Ç List ÂØπË±°„ÄÅHashÂØπË±°„ÄÅSet ÂØπË±°Âíå Zset ÂØπË±°</strong>„ÄÇ</li>
</ul>
<p>ÁâπÂà´ËØ¥Êòé‰∏ãÔºåvoid<em>key Âíå void</em>value ÊåáÈíàÊåáÂêëÁöÑÊòØ <strong>Redis ÂØπË±°</strong>ÔºåRedis ‰∏≠ÁöÑÊØè‰∏™ÂØπË±°ÈÉΩÁî± redisObjectÁªìÊûÑË°®Á§∫„ÄÇ</p>
<p>ÂØπË±°ÁªìÊûÑÈáåÂåÖÂê´ÁöÑÊàêÂëòÂèòÈáè:</p>
<ul>
<li>typeÔºåÊ†áËØÜËØ•ÂØπË±°ÊòØ‰ªÄ‰πàÁ±ªÂûãÁöÑÂØπË±°(String ÂØπË±°„ÄÅ List ÂØπË±°„ÄÅHash ÂØπË±°„ÄÅSetÂØπË±°Âíå Zset ÂØπË±°);</li>
<li>encodingÔºåÊ†áËØÜËØ•ÂØπË±°‰ΩøÁî®‰∫ÜÂì™ÁßçÂ∫ïÂ±ÇÁöÑÊï∞ÊçÆÁªìÊûÑ;</li>
<li><strong>ptrÔºåÊåáÈóÆÂ∫ïÂ±ÇÊï∞ÊçÆÁªìÊûÑÁöÑÊåáÈíàÔºå</strong></li>
</ul>
<p>Redis ÈîÆÂÄºÂØπÊï∞ÊçÆÂ∫ìÁöÑÂÖ®ÊôØÂõæ</p>
<p><img src="/image/%e5%85%a8%e6%99%af%e5%9b%be.png"
	
	
	
	loading="lazy"
	
	
></p>
<h2 id="sds">SDS
</h2><p>Redis ÁöÑString Êï∞ÊçÆÁ±ªÂûãÁöÑÂ∫ïÂ±ÇÊï∞ÊçÆÁªìÊûÑÊòØ SDS„ÄÇ</p>
<p>‰πãÊâÄ‰ª•ËÆæËÆ°SDSÁªìÊûÑÊù•Ë°®Á§∫Â≠óÁ¨¶‰∏≤ÊòØÂõ†‰∏∫CËØ≠Ë®ÄÁöÑchar*Â≠óÁ¨¶Êï∞ÁªÑÊúâ‰ª•‰∏ãÁº∫Èô∑Ôºö</p>
<ol>
<li>char*ÊåáÈíàÂè™ÊòØÊåáÂêëÂ≠óÁ¨¶Êï∞ÁªÑÁöÑËµ∑Âßã‰ΩçÁΩÆÔºåËÄå<strong>Â≠óÁ¨¶Êï∞ÁªÑÁöÑÁªìÂ∞æ‰ΩçÁΩÆÂ∞±ÊòØÁî®&quot;\0&quot;Ë°®Á§∫ÔºåÊÑèÊÄùÊòØÊåáÂ≠óÁ¨¶‰∏≤ÁöÑÁªìÊùü</strong>„ÄÇÂõ†Ê≠§<strong>CËØ≠Ë®ÄËé∑ÂèñÂ≠óÁ¨¶‰∏≤ÈïøÂ∫¶ÁöÑÊó∂Èó¥Â§çÊùÇÂ∫¶ÊòØO(N)ÔºàËøôÊòØ‰∏Ä‰∏™ÂèØ‰ª•ÊîπËøõÁöÑÂú∞ÊñπÔºâ</strong>„ÄÇ</li>
<li><strong>Â≠óÁ¨¶‰∏≤ÈáåÈù¢‰∏çËÉΩÂê´Êúâ‚Äú\0‚ÄùÂ≠óÁ¨¶</strong>ÔºåÂê¶ÂàôÊúÄÂÖàË¢´Á®ãÂ∫èËØªÂÖ•ÁöÑ‚Äú\0‚ÄùÂ≠óÁ¨¶Â∞ÜË¢´ËØØËÆ§‰∏∫ÊòØÂ≠óÁ¨¶‰∏≤ÁªìÂ∞æÔºåËøô‰∏™ÈôêÂà∂‰ΩøÂæóCËØ≠Ë®ÄÁöÑÂ≠óÁ¨¶‰∏≤Âè™ËÉΩ‰øùÂ≠òÊñáÊú¨Êï∞ÊçÆÔºå<strong>‰∏çËÉΩ‰øùÂ≠òÂÉèÂõæÁâá„ÄÅÈü≥È¢ë„ÄÅËßÜÈ¢ëÊñáÂåñËøôÊ†∑ÁöÑ‰∫åËøõÂà∂Êï∞ÊçÆ(Ëøô‰πüÊòØ‰∏Ä‰∏™ÂèØ‰ª•ÊîπËøõÁöÑÂú∞Êñπ)</strong>„ÄÇ</li>
<li><strong>CËØ≠Ë®ÄÁöÑÂ≠óÁ¨¶‰∏≤ÊòØ‰∏ç‰ºöËÆ∞ÂΩïËá™Ë∫´ÁöÑÁºìÂÜ≤Âå∫Â§ßÂ∞èÁöÑ</strong>ÔºåÊâÄ‰ª• strcat ÂáΩÊï∞ÂÅáÂÆöÁ®ãÂ∫èÂëòÂú®ÊâßË°åËøô‰∏™ÂáΩÊï∞Êó∂ÔºåÂ∑≤Áªè‰∏∫dest ÂàÜÈÖç‰∫ÜË∂≥Â§üÂ§öÁöÑÂÜÖÂ≠òÔºåÂèØ‰ª•ÂÆπÁ∫≥ src Â≠óÁ¨¶‰∏≤‰∏≠ÁöÑÊâÄÊúâÂÜÖÂÆπÔºåËÄå<strong>‰∏ÄÊó¶Ëøô‰∏™ÂÅáÂÆö‰∏çÊàêÁ´ãÔºåÂ∞±‰ºöÂèëÁîüÁºìÂÜ≤Âå∫Ê∫¢Âá∫Â∞ÜÂèØËÉΩ‰ºöÈÄ†ÊàêÁ®ãÂ∫èËøêË°åÁªàÊ≠¢Ôºå(ËøôÊòØ‰∏Ä‰∏™ÂèØ‰ª•ÊîπËøõÁöÑÂú∞Êñπ)</strong>„ÄÇ</li>
</ol>
<p>RedisÂÆûÁé∞ÁöÑSDSÁªìÊûÑÂèØ‰ª•Â∞Ü‰∏äËø∞ÈóÆÈ¢òËß£ÂÜ≥„ÄÇ</p>
<h3 id="sdsÁªìÊûÑËÆæËÆ°">SDSÁªìÊûÑËÆæËÆ°
</h3><p>ÁªìÊûÑ‰∏≠ÁöÑÊØè‰∏™ÊàêÂëòÂèòÈáèÂàÜÂà´‰ªãÁªç‰∏ã:</p>
<ul>
<li><strong>lenÔºåËÆ∞ÂΩï‰∫ÜÂ≠óÁ¨¶‰∏≤ÈïøÂ∫¶</strong>„ÄÇËøôÊ†∑Ëé∑ÂèñÂ≠óÁ¨¶‰∏≤ÈïøÂ∫¶ÁöÑÊó∂ÂÄôÔºåÂè™ÈúÄË¶ÅËøîÂõûËøô‰∏™ÊàêÂëòÂèòÈáèÂÄºÂ∞±Ë°åÔºåÊó∂Èó¥Â§çÊùÇÂ∫¶Âè™ÈúÄË¶Å O(1)„ÄÇ</li>
<li><strong>allocÔºåÂàÜÈÖçÁªôÂ≠óÁ¨¶Êï∞ÁªÑÁöÑÁ©∫Èó¥ÈïøÂ∫¶</strong>„ÄÇËøôÊ†∑Âú®‰øÆÊîπÂ≠óÁ¨¶‰∏≤ÁöÑÊó∂ÂÄôÔºåÂèØ‰ª•ÈÄöËøáa11oc-len ËÆ°ÁÆóÂá∫Ââ©‰ΩôÁöÑÁ©∫Èó¥Â§ßÂ∞èÔºåÂèØ‰ª•Áî®Êù•Âà§Êñ≠Á©∫Èó¥ÊòØÂê¶Êª°Ë∂≥‰øÆÊîπÈúÄÊ±ÇÔºåÂ¶ÇÊûú‰∏çÊª°Ë∂≥ÁöÑËØùÔºåÂ∞±‰ºöËá™Âä®Â∞Ü SDS ÁöÑÁ©∫Èó¥Êâ©Â±ïËá≥ÊâßË°å‰øÆÊîπÊâÄÈúÄÁöÑÂ§ßÂ∞èÔºåÁÑ∂ÂêéÊâçÊâßË°åÂÆûÈôÖÁöÑ‰øÆÊîπÊìç‰ΩúÔºåÊâÄ‰ª•‰ΩøÁî® SDS Êó¢‰∏çÈúÄË¶ÅÊâãÂä®‰øÆÊîπ SDS ÁöÑÁ©∫Èó¥Â§ßÂ∞è,‰πü‰∏ç‰ºöÂá∫Áé∞ÂâçÈù¢ÊâÄËØ¥ÁöÑÁºìÂÜ≤Âå∫Ê∫¢Âá∫ÁöÑÈóÆÈ¢ò„ÄÇ</li>
<li><strong>flagsÔºåÁî®Êù•Ë°®Á§∫‰∏çÂêåÁ±ªÂûãÁöÑ SDS</strong>„ÄÇ‰∏ÄÂÖ±ËÆæËÆ°‰∫Ü5ÁßçÁ±ªÂûãÔºåÂàÜÂà´ÊòØsdshdr5„ÄÅsdshdr8„ÄÅsdshdr16„ÄÅsdshdr32Âíå sdshdr64„ÄÇ</li>
<li><strong>buf[]ÔºåÂ≠óÁ¨¶Êï∞ÁªÑÔºåÁî®Êù•‰øùÂ≠òÂÆûÈôÖÊï∞ÊçÆ</strong>„ÄÇ‰∏ç‰ªÖÂèØ‰ª•‰øùÂ≠òÂ≠óÁ¨¶‰∏≤Ôºå‰πüÂèØ‰ª•‰øùÂ≠ò‰∫åËøõÂà∂Êï∞ÊçÆ„ÄÇ</li>
</ul>
<p>ÊÄªÁöÑÊù•ËØ¥ÔºåRedis ÁöÑ SDS ÁªìÊûÑÂú®ÂéüÊú¨Â≠óÁ¨¶Êï∞ÁªÑ‰πã‰∏äÔºåÂ¢ûÂä†‰∫Ü‰∏â‰∏™ÂÖÉÊï∞ÊçÆ:len„ÄÅaloc„ÄÅflagsÔºåÁî®Êù•Ëß£ÂÜ≥ CËØ≠Ë®ÄÂ≠óÁ¨¶‰∏≤ÁöÑÁº∫Èô∑„ÄÇ</p>
<p>Âõ†Ê≠§Êúâ‰ª•‰∏ãÂá†‰∏™‰ºòÁÇπÔºö</p>
<ol>
<li>O(1)Â§çÊùÇÂ∫¶Ëé∑ÂèñÂ≠óÁ¨¶‰∏≤ÈïøÂ∫¶
SDS ÁªìÊûÑÂõ†‰∏∫Âä†ÂÖ•‰∫Ü len ÊàêÂëòÂèòÈáèÔºåÈÇ£‰πà<strong>Ëé∑ÂèñÂ≠óÁ¨¶‰∏≤ÈïøÂ∫¶ÁöÑÊó∂ÂÄôÔºåÁõ¥Êé•ËøîÂõûËøô‰∏™ÊàêÂëòÂèòÈáèÁöÑÂÄºÂ∞±Ë°åÔºåÊâÄ‰ª•Â§çÊùÇÂ∫¶Âè™Êúâ O(1)„ÄÇ</strong></li>
<li>‰∫åËøõÂà∂ÂÆâÂÖ®
SDS ‰∏çÈúÄË¶ÅÁî® ‚Äú\0‚ÄùÂ≠óÁ¨¶Êù•Ê†áËØÜÂ≠óÁ¨¶‰∏≤ÁªìÂ∞æ‰∫ÜÔºåËÄåÊòØ<strong>Êúâ‰∏™‰∏ìÈó®ÁöÑ len ÊàêÂëòÂèòÈáèÊù•ËÆ∞ÂΩïÈïøÂ∫¶ÔºåÊâÄ‰ª•ÂèØÂ≠òÂÇ®ÂåÖÂê´‚Äú\0‚ÄùÁöÑÊï∞ÊçÆ</strong>„ÄÇ</li>
<li>‰∏ç‰ºöÂèëÁîüÁºìÂ≠òÂå∫Ê∫¢Âá∫
<strong>ÂΩìÂà§Êñ≠Âá∫ÁºìÂÜ≤Âå∫Â§ßÂ∞è‰∏çÂ§üÁî®Êó∂ÔºåRedis ‰ºöËá™Âä®Â∞ÜÊâ©Â§ß SDS ÁöÑÁ©∫Èó¥Â§ßÂ∞è</strong>Ôºå‰∏îÂàÜÈÖçÈ¢ùÂ§ñÁöÑ„ÄåÊú™‰ΩøÁî®Á©∫Èó¥„Äç<strong>ÊúâÊïàÁöÑÂáèÂ∞ëÂÜÖÂ≠òÂàÜÈÖçÊ¨°Êï∞</strong>„ÄÇ</li>
<li>ËäÇÁúÅÂÜÖÂ≠òÁ©∫Èó¥
<strong>‰∏çÂêåÁ±ªÂûãÁöÑÁªìÊûÑ‰ΩìÔºåÊòØ‰∏∫‰∫ÜËÉΩÁÅµÊ¥ª‰øùÂ≠ò‰∏çÂêåÂ§ßÂ∞èÁöÑÂ≠óÁ¨¶‰∏≤Ôºå‰ªéËÄåÊúâÊïàËäÇÁúÅÂÜÖÂ≠òÁ©∫Èó¥</strong>ÔºåÂπ∂ÂèñÊ∂à‰∫ÜÁªìÊûÑ‰ΩìÂú®ÁºñËØëËøáÁ®ã‰∏≠ÁöÑÂÜÖÂ≠òÂØπÈΩê„ÄÇ</li>
</ol>
<h2 id="ÈìæË°®">ÈìæË°®
</h2><h3 id="ÈìæË°®ËäÇÁÇπÁªìÊûÑËÆæËÆ°">ÈìæË°®ËäÇÁÇπÁªìÊûÑËÆæËÆ°
</h3><p>ÊúâÂâçÁΩÆËäÇÁÇπÂíåÂêéÁΩÆËäÇÁÇπÔºå‰∏∫ÂèåÂêëÈìæË°®„ÄÇ</p>
<h3 id="ÈìæË°®ÁªìÊûÑËÆæËÆ°">ÈìæË°®ÁªìÊûÑËÆæËÆ°
</h3><p>RedisÂú®listNodeÁªìÊûÑ‰ΩìÁöÑÂü∫Á°Ä‰∏äÂèàÂ∞ÅË£Ö‰∫ÜlistËøô‰∏™Êï∞ÊçÆÁªìÊûÑÔºåËøôÊ†∑Êìç‰ΩúËµ∑Êù•‰ºöÊõ¥Êñπ‰æø„ÄÇÈìæË°®ÁªìÊûÑ‰∏∫Ôºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">typedef struct list {
</span></span><span class="line"><span class="cl">    //ÈìæË°®Â§¥ËäÇÁÇπ
</span></span><span class="line"><span class="cl">    listNode thead;
</span></span><span class="line"><span class="cl">    //ÈìæË°®Â∞æËäÇÁÇπ
</span></span><span class="line"><span class="cl">    listNode
</span></span><span class="line"><span class="cl">    *tail;
</span></span><span class="line"><span class="cl">    //ËäÇÁÇπÂÄºÂ§çÂà∂ÂáΩÊï∞
</span></span><span class="line"><span class="cl">    void
</span></span><span class="line"><span class="cl">    (*dup)(void
</span></span><span class="line"><span class="cl">    *ptr);
</span></span><span class="line"><span class="cl">    //ËäÇÁÇπÂÄºÈáäÊîæÂáΩÊï∞
</span></span><span class="line"><span class="cl">    void (*free)(void
</span></span><span class="line"><span class="cl">    *ptr);
</span></span><span class="line"><span class="cl">    //ËäÇÁÇπÂÄºÊØîËæÉÂáΩÊï∞
</span></span><span class="line"><span class="cl">    int (*match)(void *ptr, void *key);
</span></span><span class="line"><span class="cl">    //ÈìæË°®ËäÇÁÇπÊï∞Èáè
</span></span><span class="line"><span class="cl">    unsigned long len;
</span></span><span class="line"><span class="cl">} list;
</span></span></code></pre></td></tr></table>
</div>
</div><p>listÁªìÊûÑ‰∏∫ÈìæË°®Êèê‰æõ‰∫ÜÈìæË°®Â§¥ÊåáÈíàhead„ÄÅÈìæË°®Â∞æËäÇÁÇπtail„ÄÅÈìæË°®ËäÇÁÇπÊï∞Èáèlen„ÄÅ‰ª•ÂèäÂèØ‰ª•Ëá™ÂÆö‰πâÂÆûÁé∞ÁöÑdup„ÄÅfree„ÄÅmatchÂáΩÊï∞„ÄÇ</p>
<h3 id="ÈìæË°®ÁöÑ‰ºòÂäø‰∏éÁº∫Èô∑">ÈìæË°®ÁöÑ‰ºòÂäø‰∏éÁº∫Èô∑
</h3><p>RedisÁöÑÈìæË°®ÂÆûÁé∞‰ºòÁÇπÂ¶Ç‰∏ãÔºö</p>
<ul>
<li>listNode ÈìæË°®ËäÇÁÇπÁöÑÁªìÊûÑÈáåÂ∏¶Êúâ prev Âíå next ÊåáÈíàÔºå<strong>Ëé∑ÂèñÊüê‰∏™ËäÇÁÇπÁöÑÂâçÁΩÆËäÇÁÇπÊàñÂêéÁΩÆËäÇÁÇπÁöÑÊó∂Èó¥Â§çÊùÇÂ∫¶Âè™ÈúÄO(1)ÔºåËÄå‰∏îËøô‰∏§‰∏™ÊåáÈíàÈÉΩÂèØ‰ª•ÊåáÂêë NULLÔºåÊâÄ‰ª•ÈìæË°®ÊòØÊó†ÁéØÈìæË°®</strong>;</li>
<li>list ÁªìÊûÑÂõ†‰∏∫Êèê‰æõ‰∫ÜË°®Â§¥ÊåáÈíà head ÂíåË°®Â∞æËäÇÁÇπ tailÔºåÊâÄ‰ª•<strong>Ëé∑ÂèñÈìæË°®ÁöÑË°®Â§¥ËäÇÁÇπÂíåË°®Â∞æËäÇÁÇπÁöÑÊó∂Èó¥Â§çÊùÇÂ∫¶Âè™ÈúÄO(1)</strong>;</li>
<li>list ÁªìÊûÑÂõ†‰∏∫Êèê‰æõ‰∫ÜÈìæË°®ËäÇÁÇπÊï∞Èáè lenÔºåÊâÄ‰ª•<strong>Ëé∑ÂèñÈìæË°®‰∏≠ÁöÑËäÇÁÇπÊï∞ÈáèÁöÑÊó∂Èó¥Â§çÊùÇÂ∫¶Âè™ÈúÄO(1)</strong>;</li>
<li>listNode ÈìæË°®ËäÇ‰ΩøÁî® void* ÊåáÈíà‰øùÂ≠òËäÇÁÇπÂÄºÔºåÂπ∂‰∏îÂèØ‰ª•ÈÄöËøá list ÁªìÊûÑÁöÑ dup„ÄÅfree„ÄÅmatch ÂáΩÊï∞ÊåáÈíà‰∏∫ËäÇÁÇπËÆæÁΩÆËØ•ËäÇÁÇπÁ±ªÂûãÁâπÂÆöÁöÑÂáΩÊï∞Ôºå<strong>Âõ†Ê≠§ÈìæË°®ËäÇÁÇπÂèØ‰ª•‰øùÂ≠òÂêÑÁßç‰∏çÂêåÁ±ªÂûãÁöÑÂÄº</strong>Ôºõ</li>
</ul>
<p>ÈìæË°®ÁöÑÁº∫Èô∑Ôºö</p>
<ul>
<li>ÈìæË°®ÊØè‰∏™ËäÇÁÇπ‰πãÈó¥ÁöÑÂÜÖÂ≠òÈÉΩÊòØ‰∏çËøûÁª≠ÁöÑÔºåÊÑèÂë≥ÁùÄ<strong>Êó†Ê≥ïÂæàÂ•ΩÂà©Áî® CPU ÁºìÂ≠ò</strong>„ÄÇËÉΩÂæàÂ•ΩÂà©Áî® CPU ÁºìÂ≠òÁöÑÊï∞ÊçÆÁªìÊûÑÂ∞±ÊòØÊï∞ÁªÑÔºåÂõ†‰∏∫Êï∞ÁªÑÁöÑÂÜÖÂ≠òÊòØËøûÁª≠ÁöÑÔºåËøôÊ†∑Â∞±ÂèØ‰ª•ÂÖÖÂàÜÂà©Áî®CPU ÁºìÂ≠òÊù•Âä†ÈÄüËÆøÈóÆ„ÄÇ</li>
<li>ËøòÊúâ‰∏ÄÁÇπÔºå‰øùÂ≠ò‰∏Ä‰∏™ÈìæË°®ËäÇÁÇπÁöÑÂÄºÈÉΩÈúÄË¶Å‰∏Ä‰∏™ÈìæË°®ËäÇÁÇπÁªìÊûÑÂ§¥ÁöÑÂàÜÈÖçÔºå<strong>ÂÜÖÂ≠òÂºÄÈîÄËæÉÂ§ß</strong>„ÄÇ</li>
</ul>
<p>Âõ†Ê≠§ÔºåRedis 3.0 ÁöÑ List ÂØπË±°Âú®Êï∞ÊçÆÈáèÊØîËæÉÂ∞ëÁöÑÊÉÖÂÜµ‰∏ãÔºå‰ºöÈááÁî®„ÄåÂéãÁº©ÂàóË°®„Äç‰Ωú‰∏∫Â∫ïÂ±ÇÊï∞ÊçÆÁªìÊûÑÁöÑÂÆûÁé∞ÔºåÂÆÉÁöÑ‰ºòÂäøÊòØËäÇÁúÅÂÜÖÂ≠òÁ©∫Èó¥ÔºåÂπ∂‰∏îÊòØÂÜÖÂ≠òÁ¥ßÂáëÂûãÁöÑÊï∞ÊçÆÁªìÊûÑ„ÄÇ</p>
<p>‰∏çËøáÔºåÂéãÁº©ÂàóË°®Â≠òÂú®ÊÄßËÉΩÈóÆÈ¢òÔºåÊâÄ‰ª• Redis Âú® 3.2 ÁâàÊú¨ËÆæËÆ°‰∫ÜÊñ∞ÁöÑÊï∞ÊçÆÁªìÊûÑquicklistÔºåÂπ∂Â∞Ü List ÂØπË±°ÁöÑÂ∫ïÂ±ÇÊï∞ÊçÆÁªìÊûÑÊîπÁî± quicklist ÂÆûÁé∞„ÄÇ</p>
<p>ÁÑ∂ÂêéÂú® Redis 5.0 ËÆæËÆ°‰∫ÜÊñ∞ÁöÑÊï∞ÊçÆÁªìÊûÑlistpackÔºåÊ≤øÁî®‰∫ÜÂéãÁº©ÂàóË°®Á¥ßÂáëÂûãÁöÑÂÜÖÂ≠òÂ∏ÉÂ±ÄÔºåÊúÄÁªàÂú®ÊúÄÊñ∞ÁöÑ RedisÁâàÊú¨ÔºåÂ∞Ü Hash ÂØπË±°Âíå Zset ÂØπË±°ÁöÑÂ∫ïÂ±ÇÊï∞ÊçÆÁªìÊûÑÂÆûÁé∞‰πã‰∏ÄÁöÑÂéãÁº©ÂàóË°®ÔºåÊõøÊç¢ÊàêÁî± listpack ÂÆûÁé∞„ÄÇ</p>
<h2 id="ÂéãÁº©ÂàóË°®">ÂéãÁº©ÂàóË°®
</h2><p>ÂéãÁº©ÂàóË°®ÁöÑÊúÄÂ§ßÁâπÁÇπÔºåÂ∞±ÊòØÂÆÉË¢´ËÆæËÆ°Êàê‰∏ÄÁßçÂÜÖÂ≠òÁ¥ßÂáëÂûãÁöÑÊï∞ÊçÆÁªìÊûÑÔºåÂç†Áî®‰∏ÄÂùóËøûÁª≠ÁöÑÂÜÖÂ≠òÁ©∫Èó¥Ôºå‰∏ç‰ªÖÂèØ‰ª•Âà©Áî® CPU ÁºìÂ≠òÔºåËÄå‰∏î‰ºöÈíàÂØπ‰∏çÂêåÈïøÂ∫¶ÁöÑÊï∞ÊçÆÔºåËøõË°åÁõ∏Â∫îÁºñÁ†ÅÔºåËøôÁßçÊñπÊ≥ïÂèØ‰ª•ÊúâÊïàÂú∞ËäÇÁúÅÂÜÖÂ≠òÂºÄÈîÄ„ÄÇ</p>
<p>‰ΩÜÊòØÔºåÂéãÁº©ÂàóË°®ÁöÑÁº∫Èô∑‰πüÊòØÊúâÁöÑ:</p>
<ul>
<li>‰∏çËÉΩ‰øùÂ≠òËøáÂ§öÁöÑÂÖÉÁ¥†ÔºåÂê¶ÂàôÊü•ËØ¢ÊïàÁéáÂ∞±‰ºöÈôç‰Ωé;</li>
<li>Êñ∞Â¢ûÊàñ‰øÆÊîπÊüê‰∏™ÂÖÉÁ¥†Êó∂ÔºåÂéãÁº©ÂàóË°®Âç†Áî®ÁöÑÂÜÖÂ≠òÁ©∫Èó¥ÈúÄË¶ÅÈáçÊñ∞ÂàÜÈÖçÔºåÁîöËá≥ÂèØËÉΩÂºïÂèëËøûÈîÅÊõ¥Êñ∞ÁöÑÈóÆÈ¢ò„ÄÇ</li>
</ul>
<p>Âõ†Ê≠§ÔºåRedis ÂØπË±°(List ÂØπË±°„ÄÅHash ÂØπË±°„ÄÅZset ÂØπË±°)ÂåÖÂê´ÁöÑÂÖÉÁ¥†Êï∞ÈáèËæÉÂ∞ëÔºåÊàñËÄÖÂÖÉÁ¥†ÂÄº‰∏çÂ§ßÁöÑÊÉÖÂÜµÊâç‰ºö‰ΩøÁî®ÂéãÁº©ÂàóË°®‰Ωú‰∏∫Â∫ïÂ±ÇÊï∞ÊçÆÁªìÊûÑ„ÄÇ</p>
<h3 id="ÂéãÁº©ÂàóË°®ÁªìÊûÑËÆæËÆ°">ÂéãÁº©ÂàóË°®ÁªìÊûÑËÆæËÆ°
</h3><p>ÂéãÁº©ÂàóË°®ÊòØRedis‰∏∫‰∫ÜËäÇÁ∫¶ÂÜÖÂ≠òËÄåÂºÄÂèëÁöÑÔºåÂÆÉÊòØ<strong>Áî±ËøûÁª≠ÂÜÖÂ≠òÂùóÁªÑÊàêÁöÑÈ°∫Â∫èÂûãÊï∞ÊçÆÁªìÊûÑ</strong>ÔºåÊúâÁÇπÁ±ª‰ºº‰∫éÊï∞ÁªÑ„ÄÇ</p>
<p>ÂéãÁº©ÂàóË°®Âú®Ë°®Â§¥Êúâ‰∏â‰∏™Â≠óÊÆµÔºö</p>
<ul>
<li><strong>zlbytes</strong>ÔºåËÆ∞ÂΩïÊï¥‰∏™ÂéãÁº©ÂàóË°®Âç†Áî®ÂØπÂÜÖÂ≠òÂ≠óËäÇÊï∞;</li>
<li><strong>zltail</strong>ÔºåËÆ∞ÂΩïÂéãÁº©ÂàóË°®„ÄåÂ∞æÈÉ®„ÄçËäÇÁÇπË∑ùÁ¶ªËµ∑ÂßãÂú∞ÂùÄÁî±Â§öÂ∞ëÂ≠óËäÇÔºå‰πüÂ∞±ÊòØÂàóË°®Â∞æÁöÑÂÅèÁßªÈáè</li>
<li><strong>zllen</strong>ÔºåËÆ∞ÂΩïÂéãÁº©ÂàóË°®ÂåÖÂê´ÁöÑËäÇÁÇπÊï∞Èáè;</li>
<li><strong>zlend</strong>ÔºåÊ†áËÆ∞ÂéãÁº©ÂàóË°®ÁöÑÁªìÊùüÁÇπÔºåÂõ∫ÂÆöÂÄº 0xFF(ÂçÅËøõÂà∂255)</li>
</ul>
<p>Âú®ÂéãÁº©ÂàóË°®‰∏≠ÔºåÂ¶ÇÊûúÊàë‰ª¨Ë¶ÅÊü•ÊâæÂÆö‰ΩçÁ¨¨‰∏Ä‰∏™ÂÖÉÁ¥†ÂíåÊúÄÂêé‰∏Ä‰∏™ÂÖÉÁ¥†ÔºåÂèØ‰ª•ÈÄöËøáË°®Â§¥‰∏â‰∏™Â≠óÊÆµ(zllen)ÁöÑÈïøÂ∫¶Áõ¥Êé•ÂÆö‰ΩçÔºåÂ§çÊùÇÂ∫¶ÊòØ 0(1)„ÄÇËÄå<strong>Êü•ÊâæÂÖ∂‰ªñÂÖÉÁ¥†Êó∂ÔºåÂ∞±Ê≤°ÊúâËøô‰πàÈ´òÊïà‰∫ÜÔºåÂè™ËÉΩÈÄê‰∏™Êü•ÊâæÔºåÊ≠§Êó∂ÁöÑÂ§çÊùÇÂ∫¶Â∞±ÊòØO(N)‰∫ÜÔºåÂõ†Ê≠§ÂéãÁº©ÂàóË°®‰∏çÈÄÇÂêà‰øùÂ≠òËøáÂ§öÁöÑÂÖÉÁ¥†</strong>„ÄÇ</p>
<p>ÂéãÁº©ÂàóË°®ËäÇÁÇπÔºàentryÔºâÂåÖÂê´‰∏âÈÉ®ÂàÜÂÜÖÂÆπÔºö</p>
<ul>
<li><strong>prevlen</strong>ÔºåËÆ∞ÂΩï‰∫Ü„ÄåÂâç‰∏Ä‰∏™ËäÇÁÇπ„ÄçÁöÑÈïøÂ∫¶ÔºåÁõÆÁöÑÊòØ‰∏∫‰∫ÜÂÆûÁé∞‰ªéÂêéÂêëÂâçÈÅçÂéÜ;</li>
<li><strong>encoding</strong>ÔºåËÆ∞ÂΩï‰∫ÜÂΩìÂâçËäÇÁÇπÂÆûÈôÖÊï∞ÊçÆÁöÑ„ÄåÁ±ªÂûãÂíåÈïøÂ∫¶„ÄçÔºåÁ±ªÂûã‰∏ªË¶ÅÊúâ‰∏§Áßç:Â≠óÁ¨¶‰∏≤ÂíåÊï¥Êï∞„ÄÇ</li>
<li><strong>data</strong>ÔºåËÆ∞ÂΩï‰∫ÜÂΩìÂâçËäÇÁÇπÁöÑÂÆûÈôÖÊï∞ÊçÆÔºåÁ±ªÂûãÂíåÈïøÂ∫¶ÈÉΩÁî±encoding ÂÜ≥ÂÆö;</li>
</ul>
<p>ÂΩìÊàë‰ª¨ÂæÄÂéãÁº©ÂàóË°®‰∏≠ÊèíÂÖ•Êï∞ÊçÆÊó∂ÔºåÂéãÁº©ÂàóË°®Â∞±‰ºöÊ†πÊçÆÊï∞ÊçÆÁ±ªÂûãÊòØÂ≠óÁ¨¶‰∏≤ËøòÊòØÊï¥Êï∞Ôºå‰ª•ÂèäÊï∞ÊçÆÁöÑÂ§ßÂ∞èÔºå‰ºö‰ΩøÁî®‰∏çÂêåÁ©∫Èó¥Â§ßÂ∞èÁöÑ preven Âíå encoding Ëøô‰∏§‰∏™ÂÖÉÁ¥†Èáå‰øùÂ≠òÁöÑ‰ø°ÊÅØÔºå<strong>ËøôÁßçÊ†πÊçÆÊï∞ÊçÆÂ§ßÂ∞èÂíåÁ±ªÂûãËøõË°å‰∏çÂêåÁöÑÁ©∫Èó¥Â§ßÂ∞èÂàÜÈÖçÁöÑËÆæËÆ°ÊÄùÊÉ≥ÔºåÊ≠£ÊòØ Redis ‰∏∫‰∫ÜËäÇÁúÅÂÜÖÂ≠òËÄåÈááÁî®ÁöÑ„ÄÇ</strong></p>
<p>ÂàÜÂà´ËØ¥‰∏ãÔºåprevlen Âíå encoding ÊòØÂ¶Ç‰ΩïÊ†πÊçÆÊï∞ÊçÆÁöÑÂ§ßÂ∞èÂíåÁ±ªÂûãÊù•ËøõË°å‰∏çÂêåÁöÑÁ©∫Èó¥Â§ßÂ∞èÂàÜÈÖç„ÄÇ</p>
<p>ÂéãÁº©ÂàóË°®ÈáåÁöÑÊØè‰∏™ËäÇÁÇπ‰∏≠ÁöÑ prevlen Â±ûÊÄßÈÉΩËÆ∞ÂΩï‰∫Ü„ÄåÂâç‰∏Ä‰∏™ËäÇÁÇπÁöÑÈïøÂ∫¶|ÔºåËÄå‰∏î prevlen Â±ûÊÄßÁöÑÁ©∫Èó¥Â§ßÂ∞è</p>
<p>Ë∑üÂâç‰∏Ä‰∏™ËäÇÁÇπÈïøÂ∫¶ÂÄºÊúâÂÖ≥ÔºåÊØîÂ¶Ç:</p>
<ul>
<li>Â¶ÇÊûúÂâç‰∏Ä‰∏™ËäÇÁÇπÁöÑÈïøÂ∫¶Â∞è‰∫é 254 Â≠óËäÇÔºåÈÇ£‰πà preven Â±ûÊÄßÈúÄË¶ÅÁî®1Â≠óËäÇÁöÑÁ©∫Èó¥Êù•‰øùÂ≠òËøô‰∏™ÈïøÂ∫¶ÂÄº;</li>
<li>Â¶ÇÊûúÂâç‰∏Ä‰∏™ËäÇÁÇπÁöÑÈïøÂ∫¶Â§ß‰∫éÁ≠â‰∫é 254 Â≠óËäÇÔºåÈÇ£‰πà previen Â±ûÊÄßÈúÄË¶ÅÁî®5 Â≠óËäÇÁöÑÁ©∫Èó¥Êù•‰øùÂ≠òËøô‰∏™ÈïøÂ∫¶ÂÄº;</li>
</ul>
<p>encoding Â±ûÊÄßÁöÑÁ©∫Èó¥Â§ßÂ∞èË∑üÊï∞ÊçÆÊòØÂ≠óÁ¨¶‰∏≤ËøòÊòØÊï¥Êï∞Ôºå‰ª•ÂèäÂ≠óÁ¨¶‰∏≤ÁöÑÈïøÂ∫¶ÊúâÂÖ≥„ÄÇ</p>
<ul>
<li>Â¶ÇÊûú<strong>ÂΩìÂâçËäÇÁÇπÁöÑÊï∞ÊçÆÊòØÊï¥Êï∞</strong>ÔºåÂàô encoding ‰ºö‰ΩøÁî®<strong>1Â≠óËäÇÁöÑÁ©∫Èó¥</strong>ËøõË°åÁºñÁ†ÅÔºå‰πüÂ∞±ÊòØ encoding ÈïøÂ∫¶‰∏∫ 1Â≠óËäÇ„ÄÇÈÄöËøá encoding Á°ÆËÆ§‰∫ÜÊï¥Êï∞Á±ªÂûãÔºåÂ∞±ÂèØ‰ª•Á°ÆËÆ§Êï¥Êï∞Êï∞ÊçÆÁöÑÂÆûÈôÖÂ§ßÂ∞è‰∫ÜÔºåÊØîÂ¶ÇÂ¶ÇÊûú encoding ÁºñÁ†ÅÁ°ÆËÆ§‰∫ÜÊï∞ÊçÆÊòØ int16 Êï¥Êï∞ÔºåÈÇ£‰πà data ÁöÑÈïøÂ∫¶Â∞±ÊòØ int16 ÁöÑÂ§ßÂ∞è„ÄÇ</li>
<li>Â¶ÇÊûú<strong>ÂΩìÂâçËäÇÁÇπÁöÑÊï∞ÊçÆÊòØÂ≠óÁ¨¶‰∏≤ÔºåÊ†πÊçÆÂ≠óÁ¨¶‰∏≤ÁöÑÈïøÂ∫¶Â§ßÂ∞è</strong>Ôºåencoding ‰ºö‰ΩøÁî®<strong>1Â≠óËäÇ/2Â≠óËäÇ/5Â≠óËäÇÁöÑÁ©∫Èó¥</strong>ËøõË°åÁºñÁ†ÅÔºåencoding ÁºñÁ†ÅÁöÑÂâç‰∏§‰∏™ bit Ë°®Á§∫Êï∞ÊçÆÁöÑÁ±ªÂûãÔºåÂêéÁª≠ÁöÑÂÖ∂‰ªñ bit Ê†áËØÜÂ≠óÁ¨¶‰∏≤Êï∞ÊçÆÁöÑÂÆûÈôÖÈïøÂ∫¶Âç≥ data ÁöÑÈïøÂ∫¶„ÄÇ</li>
</ul>
<h3 id="ÂéãÁº©ÂàóË°®ÁöÑÁº∫Èô∑">ÂéãÁº©ÂàóË°®ÁöÑÁº∫Èô∑
</h3><p>Á©∫Èó¥Êâ©Â±ïÊìç‰Ωú‰πüÂ∞±ÊòØÈáçÊñ∞ÂàÜÈÖçÂÜÖÂ≠òÔºåÂõ†Ê≠§<strong>ËøûÈîÅÊõ¥Êñ∞‰∏ÄÊó¶ÂèëÁîüÔºåÂ∞±‰ºöÂØºËá¥ÂéãÁº©ÂàóË°®Âç†Áî®ÁöÑÂÜÖÂ≠òÁ©∫Èó¥Ë¶ÅÂ§öÊ¨°ÈáçÊñ∞ÂàÜÈÖçÔºåËøôÂ∞±‰ºöÁõ¥Êé•ÂΩ±ÂìçÂà∞ÂéãÁº©ÂàóË°®ÁöÑËÆøÈóÆÊÄßËÉΩ„ÄÇ</strong></p>
<p>ÊâÄ‰ª•ËØ¥Ôºå<strong>ËôΩÁÑ∂ÂéãÁº©ÂàóË°®Á¥ßÂáëÂûãÁöÑÂÜÖÂ≠òÂ∏ÉÂ±ÄËÉΩËäÇÁúÅÂÜÖÂ≠òÂºÄÈîÄÔºå‰ΩÜÊòØÂ¶ÇÊûú‰øùÂ≠òÁöÑÂÖÉÁ¥†Êï∞ÈáèÂ¢ûÂä†‰∫ÜÔºåÊàñÊòØÂÖÉÁ¥†ÂèòÂ§ß‰∫ÜÔºå‰ºöÂØºËá¥ÂÜÖÂ≠òÈáçÊñ∞ÂàÜÈÖçÔºåÊúÄÁ≥üÁ≥ïÁöÑÊòØ‰ºöÊúâ„ÄåËøûÈîÅÊõ¥Êñ∞„ÄçÁöÑÈóÆÈ¢ò„ÄÇ</strong></p>
<p>Âõ†Ê≠§Ôºå<strong>ÂéãÁº©ÂàóË°®Âè™‰ºöÁî®‰∫é‰øùÂ≠òÁöÑËäÇÁÇπÊï∞Èáè‰∏çÂ§öÁöÑÂú∫ÊôØ</strong>ÔºåÂè™Ë¶ÅËäÇÁÇπÊï∞ÈáèË∂≥Â§üÂ∞èÔºåÂç≥‰ΩøÂèëÁîüËøûÈîÅÊõ¥Êñ∞Ôºå‰πüÊòØËÉΩÊé•ÂèóÁöÑ„ÄÇ</p>
<p>ËôΩËØ¥Â¶ÇÊ≠§ÔºåRedis ÈíàÂØπÂéãÁº©ÂàóË°®Âú®ËÆæËÆ°‰∏äÁöÑ‰∏çË∂≥ÔºåÂú®ÂêéÊù•ÁöÑÁâàÊú¨‰∏≠ÔºåÊñ∞Â¢ûËÆæËÆ°‰∫Ü‰∏§ÁßçÊï∞ÊçÆÁªìÊûÑ:quicklist(Redis 3.2 ÂºïÂÖ•)Âíå listpack(Redis 5.0 ÂºïÂÖ•)„ÄÇËøô‰∏§ÁßçÊï∞ÊçÆÁªìÊûÑÁöÑËÆæËÆ°ÁõÆÊ†áÔºåÂ∞±ÊòØÂ∞ΩÂèØËÉΩÂú∞‰øùÊåÅÂéãÁº©ÂàóË°®ËäÇÁúÅÂÜÖÂ≠òÁöÑ‰ºòÂäøÔºåÂêåÊó∂Ëß£ÂÜ≥ÂéãÁº©ÂàóË°®ÁöÑ„ÄåËøûÈîÅÊõ¥Êñ∞„ÄçÁöÑÈóÆÈ¢ò„ÄÇ</p>
<h4 id="ËøûÈîÅÊõ¥Êñ∞ÈóÆÈ¢ò">ËøûÈîÅÊõ¥Êñ∞ÈóÆÈ¢ò
</h4><p><strong>ÂéãÁº©ÂàóË°®Êñ∞Â¢ûÊüê‰∏™ÂÖÉÁ¥†Êàñ‰øÆÊîπÊüê‰∏™ÂÖÉÁ¥†Êó∂ÔºåÂ¶ÇÊûúÁ©∫Èó¥‰∏çÂ§üÔºåÂéãÁº©ÂàóË°®Âç†Áî®ÁöÑÂÜÖÂ≠òÁ©∫Èó¥Â∞±ÈúÄË¶ÅÈáçÊñ∞ÂàÜÈÖç,ËÄåÂΩìÊñ∞ÊèíÂÖ•ÁöÑÂÖÉÁ¥†ËæÉÂ§ßÊó∂ÔºåÂèØËÉΩ‰ºöÂØºËá¥ÂêéÁª≠ÂÖÉÁ¥†ÁöÑ prevlen Âç†Áî®Á©∫Èó¥ÈÉΩÂèëÁîüÂèòÂåñÔºå‰ªéËÄåÂºïËµ∑„ÄåËøûÈîÅÊõ¥Êñ∞„ÄçÈóÆÈ¢òÔºåÂØºËá¥ÊØè‰∏™ÂÖÉÁ¥†ÁöÑÁ©∫Èó¥ÈÉΩË¶ÅÈáçÊñ∞ÂàÜÈÖçÔºåÈÄ†ÊàêËÆøÈóÆÂéãÁº©ÂàóË°®ÊÄßËÉΩÁöÑ‰∏ãÈôç„ÄÇ</strong></p>
<p><strong>ËøôÁßçÂú®ÁâπÊÆäÊÉÖÂÜµ‰∏ã‰∫ßÁîüÁöÑËøûÁª≠Â§öÊ¨°Á©∫Èó¥Êâ©Â±ïÊìç‰ΩúÂ∞±Âè´ÂÅö„ÄåËøûÈîÅÊõ¥Êñ∞„Äç</strong>ÔºåÂ∞±ÂÉèÂ§öÁ±≥ËØ∫ÁâåÁöÑÊïàÂ∫î‰∏ÄÊ†∑„ÄÇ</p>
<h2 id="ÂìàÂ∏åË°®">ÂìàÂ∏åË°®
</h2><p>ÂìàÂ∏åË°®ÊòØ‰∏ÄÁßç‰øùÂ≠òÈîÆÂÄºÂØπ(key-value)ÁöÑÊï∞ÊçÆÁªìÊûÑ„ÄÇ</p>
<p>ÂìàÂ∏åË°®‰∏≠ÁöÑÊØè‰∏Ä‰∏™ key ÈÉΩÊòØÁã¨‰∏ÄÊó†‰∫åÁöÑÔºåÁ®ãÂ∫èÂèØ‰ª•Ê†πÊçÆ key Êü•ÊâæÂà∞‰∏é‰πãÂÖ≥ËÅîÁöÑ valueÔºåÊàñËÄÖÈÄöËøá key Êù•Êõ¥Êñ∞ valueÔºåÂèàÊàñËÄÖÊ†πÊçÆ key Êù•Âà†Èô§Êï¥‰∏™ key-valueÁ≠âÁ≠â„ÄÇ</p>
<p>‰ºòÁÇπÔºö<strong>‰ª• O(1)ÁöÑÂ§çÊùÇÂ∫¶Âø´ÈÄüÊü•ËØ¢Êï∞ÊçÆ</strong>„ÄÇ</p>
<p>Áº∫ÁÇπÔºöÂú®ÂìàÂ∏åË°®Â§ßÂ∞èÂõ∫ÂÆöÁöÑÊÉÖÂÜµ‰∏ãÔºåÈöèÁùÄÊï∞ÊçÆ‰∏çÊñ≠Â¢ûÂ§öÔºåÈÇ£‰πà<strong>ÂìàÂ∏åÂÜ≤Á™Å</strong>ÁöÑÂèØËÉΩÊÄß‰πü‰ºöË∂äÈ´ò„ÄÇ</p>
<p><strong>Redis ÈááÁî®‰∫Ü„ÄåÈìæÂºèÂìàÂ∏å„ÄçÊù•Ëß£ÂÜ≥ÂìàÂ∏åÂÜ≤Á™Å</strong>ÔºåÂú®‰∏çÊâ©ÂÆπÂìàÂ∏åË°®ÁöÑÂâçÊèê‰∏ãÔºåÂ∞ÜÂÖ∑ÊúâÁõ∏ÂêåÂìàÂ∏åÂÄºÁöÑÊï∞ÊçÆ‰∏≤Ëµ∑Êù•ÔºåÂΩ¢ÊàêÈìæÊé•Ëµ∑Ôºå‰ª•‰æøËøô‰∫õÊï∞ÊçÆÂú®Ë°®‰∏≠‰ªçÁÑ∂ÂèØ‰ª•Ë¢´Êü•ËØ¢Âà∞„ÄÇ</p>
<h3 id="ÂìàÂ∏åË°®ÁªìÊûÑËÆæËÆ°">ÂìàÂ∏åË°®ÁªìÊûÑËÆæËÆ°
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">typedef struct dictht {
</span></span><span class="line"><span class="cl">    //ÂìàÂ∏åË°®Êï∞ÁªÑ
</span></span><span class="line"><span class="cl">    dictEntry
</span></span><span class="line"><span class="cl">    table;
</span></span><span class="line"><span class="cl">    //ÂìàÂ∏åË°®Â§ßÂ∞è
</span></span><span class="line"><span class="cl">    unsigned long size;
</span></span><span class="line"><span class="cl">    //ÂìàÂ∏åË°®Â§ßÂ∞èÊé©Á†Å,Áî®‰∫éËÆ°ÁÆóÁ¥¢ÂºïÂÄº
</span></span><span class="line"><span class="cl">    unsigned long sizemask;
</span></span><span class="line"><span class="cl">    //ËØ•ÂìàÂ∏åË°®Â∑≤ÊúâÁöÑËäÇÁÇπÊï∞Èáè
</span></span><span class="line"><span class="cl">    unsigned long used;
</span></span><span class="line"><span class="cl">}dictht;
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÂèØ‰ª•ÁúãÂà∞ÔºåÂìàÂ∏åË°®ÊòØ‰∏Ä‰∏™Êï∞ÁªÑ(dictEntry **table)ÔºåÊï∞ÁªÑÁöÑÊØè‰∏™ÂÖÉÁ¥†ÊòØ‰∏Ä‰∏™ÊåáÂêë„ÄåÂìàÂ∏åË°®ËäÇÁÇπ(dictEntry)„ÄçÁöÑÊåáÈíà„ÄÇ</p>
<p><img src="/image/%e5%93%88%e5%b8%8c%e8%a1%a8.png"
	
	
	
	loading="lazy"
	
	
></p>
<p>ÂìàÂ∏åË°®ËäÇÁÇπÁöÑÁªìÊûÑÂ¶Ç‰∏ãÔºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">typedef struct dictEntry {
</span></span><span class="line"><span class="cl">    //ÈîÆÂÄºÂØπ‰∏≠ÁöÑÈîÆ
</span></span><span class="line"><span class="cl">    void *key;
</span></span><span class="line"><span class="cl">    //ÈîÆÂÄºÂØπ‰∏≠ÁöÑÂÄº
</span></span><span class="line"><span class="cl">    union (
</span></span><span class="line"><span class="cl">    void *val;
</span></span><span class="line"><span class="cl">    uint64_t u64;
</span></span><span class="line"><span class="cl">    int64_t s64;
</span></span><span class="line"><span class="cl">    double d;
</span></span><span class="line"><span class="cl">    } v;
</span></span><span class="line"><span class="cl">    //ÊåáÂêë‰∏ã‰∏Ä‰∏™ÂìàÂ∏åË°®ËäÇÁÇπ,ÂΩ¢ÊàêÈìæË°®
</span></span><span class="line"><span class="cl">    struct dictEntry next;
</span></span><span class="line"><span class="cl">} dictentry;
</span></span></code></pre></td></tr></table>
</div>
</div><p>dictEntry ÁªìÊûÑÈáå‰∏ç‰ªÖÂåÖÂê´ÊåáÂêëÈîÆÂíåÂÄºÁöÑÊåáÈíàÔºåËøòÂåÖÂê´‰∫ÜÊåáÂêë‰∏ã‰∏Ä‰∏™ÂìàÂ∏åË°®ËäÇÁÇπÁöÑÊåáÈíàÔºåËøô‰∏™ÊåáÈíàÂèØ‰ª•Â∞ÜÂ§ö‰∏™ÂìàÂ∏åÂÄºÁõ∏ÂêåÁöÑÈîÆÂÄºÂØπÈìæÊé•Ëµ∑Êù•Ôºå‰ª•Ê≠§Êù•Ëß£ÂÜ≥ÂìàÂ∏åÂÜ≤Á™ÅÁöÑÈóÆÈ¢òÔºåËøôÂ∞±ÊòØÈìæÂºèÂìàÂ∏å„ÄÇ</p>
<h3 id="ÂìàÂ∏åÂÜ≤Á™Å">ÂìàÂ∏åÂÜ≤Á™Å
</h3><p>ÂìàÂ∏åË°®ÂÆûÈôÖ‰∏äÊòØ‰∏Ä‰∏™Êï∞ÁªÑÔºåÊï∞ÁªÑÈáåÁöÑÊØè‰∏Ä‰∏™ÂÖÉÁ¥†Â∞±ÊòØ‰∏Ä‰∏™ÂìàÂ∏åÊ°∂„ÄÇ</p>
<p>ÂΩì‰∏Ä‰∏™ÈîÆÂÄºÂØπÁöÑÈîÆÁªèËøá Hash ÂáΩÊï∞ËÆ°ÁÆóÂêéÂæóÂà∞ÂìàÂ∏åÂÄºÔºåÂÜçÂ∞Ü(ÂìàÂ∏åÂÄº % ÂìàÂ∏åË°®Â§ßÂ∞è)ÂèñÊ®°ËÆ°ÁÆóÔºåÂæóÂà∞ÁöÑÁªìÊûúÂÄºÂ∞±ÊòØËØ• key-value ÂØπÂ∫îÁöÑÊï∞ÁªÑÂÖÉÁ¥†‰ΩçÁΩÆÔºå‰πüÂ∞±ÊòØÁ¨¨Âá†‰∏™ÂìàÂ∏åÊ°∂„ÄÇ„ÄÅ</p>
<h4 id="‰ªÄ‰πàÊòØÂìàÂ∏åÂÜ≤Á™ÅÂë¢">‰ªÄ‰πàÊòØÂìàÂ∏åÂÜ≤Á™ÅÂë¢
</h4><p>‰∏æ‰∏™‰æãÂ≠êÔºåÊúâ‰∏Ä‰∏™ÂèØ‰ª•Â≠òÊîæ8‰∏™ÂìàÂ∏åÊ°∂ÁöÑÂìàÂ∏åË°®„ÄÇkey1 ÁªèËøáÂìàÂ∏åÂáΩÊï∞ËÆ°ÁÆóÂêéÔºåÂÜçÂ∞Ü„ÄåÂìàÂ∏åÂÄº%8„ÄçËøõË°åÂèñÊ®°ËÆ°ÁÆóÔºåÁªìÊûúÂÄº‰∏∫ 1ÔºåÈÇ£‰πàÂ∞±ÂØπÂ∫îÂìàÂ∏åÊ°∂ 1ÔºåÁ±ª‰ººÁöÑÔºåkey9 Âíå key10 ÂàÜÂà´ÂØπÂ∫îÂìàÂ∏åÊ°∂1ÂíåÊ°∂ 6„ÄÇ</p>
<p>Ê≠§Êó∂Ôºåkey1 Âíå key9 ÂØπÂ∫îÂà∞‰∫ÜÁõ∏ÂêåÁöÑÂìàÂ∏åÊ°∂‰∏≠ÔºåËøôÂ∞±ÂèëÁîü‰∫ÜÂìàÂ∏åÂÜ≤Á™Å„ÄÇ</p>
<p>Âõ†Ê≠§Ôºå<strong>ÂΩìÊúâ‰∏§‰∏™‰ª•‰∏äÊï∞ÈáèÁöÑ kay Ë¢´ÂàÜÈÖçÂà∞‰∫ÜÂìàÂ∏åË°®‰∏≠Âêå‰∏Ä‰∏™ÂìàÂ∏åÊ°∂‰∏äÊó∂ÔºåÊ≠§Êó∂Áß∞Ëøô‰∫õ key ÂèëÁîü‰∫ÜÂÜ≤Á™Å„ÄÇ</strong></p>
<h3 id="ÈìæÂºèÂìàÂ∏å">ÈìæÂºèÂìàÂ∏å
</h3><p>RedisÈááÁî®‰∫ÜÈìæÂºèÂìàÂ∏åÁöÑÊñπÊ≥ïËß£ÂÜ≥ÂìàÂ∏åÂÜ≤Á™Å„ÄÇ</p>
<h4 id="ÈìæÂºèÂìàÂ∏åÊÄé‰πàÂÆûÁé∞ÁöÑ">ÈìæÂºèÂìàÂ∏åÊÄé‰πàÂÆûÁé∞ÁöÑÔºü
</h4><p>ÂÆûÁé∞ÁöÑÊñπÂºèÂ∞±ÊòØÊØè‰∏™ÂìàÂ∏åË°®ËäÇÁÇπÈÉΩÊúâ‰∏Ä‰∏™ next ÊåáÈíàÔºåÁî®‰∫éÊåáÂêë‰∏ã‰∏Ä‰∏™ÂìàÂ∏åË°®ËäÇÁÇπÔºåÂõ†Ê≠§Â§ö‰∏™ÂìàÂ∏åË°®ËäÇÁÇπÂèØ‰ª•Áî® next ÊåáÈíàÊûÑÊàê‰∏Ä‰∏™ÂçïÈ°πÈìæË°®Ôºå<strong>Ë¢´ÂàÜÈÖçÂà∞Âêå‰∏Ä‰∏™ÂìàÂ∏åÊ°∂‰∏äÁöÑÂ§ö‰∏™ËäÇÁÇπÂèØ‰ª•Áî®Ëøô‰∏™ÂçïÈ°πÈìæË°®ËøûÊé•Ëµ∑Êù•ÔºåËøôÊ†∑Â∞±Ëß£ÂÜ≥‰∫ÜÂìàÂ∏åÂÜ≤Á™Å„ÄÇ</strong></p>
<p>ËøòÊòØÁî®ÂâçÈù¢ÁöÑÂìàÂ∏åÂÜ≤Á™Å‰æãÂ≠êÔºåkey1 Âíå key9 ÁªèËøáÂìàÂ∏åËÆ°ÁÆóÂêéÔºåÈÉΩËêΩÂú®Âêå‰∏Ä‰∏™ÂìàÂ∏åÊ°∂ÔºåÈìæÂºèÂìàÂ∏åÁöÑËØùÔºåkey1Â∞±‰ºöÈÄöËøá next ÊåáÈíàÊåáÂêë key9ÔºåÂΩ¢Êàê‰∏Ä‰∏™ÂçïÂêëÈìæË°®„ÄÇ</p>
<p>‰∏çËøáÔºåÈìæÂºèÂìàÂ∏åÂ±ÄÈôêÊÄß‰πüÂæàÊòéÊòæÔºåÈöèÁùÄÈìæË°®ÈïøÂ∫¶ÁöÑÂ¢ûÂä†ÔºåÂú®Êü•ËØ¢Ëøô‰∏Ä‰ΩçÁΩÆ‰∏äÁöÑÊï∞ÊçÆÁöÑËÄóÊó∂Â∞±‰ºöÂ¢ûÂä†ÔºåÊØïÁ´üÈìæË°®ÁöÑÊü•ËØ¢ÁöÑÊó∂Èó¥Â§çÊùÇÂ∫¶ÊòØ O(n)„ÄÇ</p>
<p>Ë¶ÅÊÉ≥Ëß£ÂÜ≥Ëøô‰∏ÄÈóÆÈ¢òÔºåÂ∞±ÈúÄË¶ÅËøõË°årehashÔºå‰πüÂ∞±ÊòØÂØπÂìàÂ∏åË°®ÁöÑÂ§ßÂ∞èËøõË°åÊâ©Â±ï„ÄÇ</p>
<h3 id="rehash">rehash
</h3><p>Âú®ÂÆûÈôÖ‰ΩøÁî®ÂìàÂ∏åË°®Êó∂ÔºåRedis ÂÆö‰πâ‰∏Ä‰∏™ dict ÁªìÊûÑ‰ΩìÔºåËøô‰∏™ÁªìÊûÑ‰ΩìÈáåÂÆö‰πâ‰∫Ü‰∏§‰∏™ÂìàÂ∏åË°®(ht[2])„ÄÇ</p>
<p>‰πãÊâÄ‰ª•ÂÆö‰πâ‰∫Ü‰∏§‰∏™ÂìàÂ∏åË°®ÔºåÊòØÂõ†‰∏∫ËøõË°årehashÁöÑÊó∂ÂÄôÔºåÈúÄË¶ÅÁî®‰∏ä‰∏§‰∏™ÂìàÂ∏åË°®„ÄÇ</p>
<p>Âú®Ê≠£Â∏∏ÊúçÂä°ËØ∑Ê±ÇÈò∂ÊÆµÔºåÊèíÂÖ•ÁöÑÊï∞ÊçÆÔºåÈÉΩ‰ºöÂÜôÂÖ•Âà∞„ÄåÂìàÂ∏åË°®1„ÄçÔºåÊ≠§Êó∂ÁöÑ„ÄåÂìàÂ∏åË°®2„Äç Âπ∂Ê≤°ÊúâË¢´ÂàÜÈÖçÁ©∫Èó¥„ÄÇ</p>
<p>ÈöèÁùÄÊï∞ÊçÆÈÄêÊ≠•Â¢ûÂ§öÔºåËß¶Âèë‰∫Ü rehash Êìç‰ΩúÔºåËøô‰∏™ËøáÁ®ãÂàÜ‰∏∫‰∏âÊ≠•:</p>
<ul>
<li>¬∑Áªô„ÄåÂìàÂ∏åË°® 2„ÄçÂàÜÈÖçÁ©∫Èó¥Ôºå‰∏ÄËà¨‰ºöÊØî„ÄåÂìàÂ∏åË°®1„ÄçÂ§ß‰∏ÄÂÄç(‰∏§ÂÄçÁöÑÊÑèÊÄù);</li>
<li>Â∞Ü„ÄåÂìàÂ∏åË°®1„ÄçÁöÑÊï∞ÊçÆËøÅÁßªÂà∞„ÄåÂìàÂ∏åË°® 2„Äç ‰∏≠;</li>
<li>ËøÅÁßªÂÆåÊàêÂêéÔºå„ÄåÂìàÂ∏åË°®1„ÄçÁöÑÁ©∫Èó¥‰ºöË¢´ÈáäÊîæÔºåÂπ∂Êää„ÄåÂìàÂ∏åË°® 2„ÄçËÆæÁΩÆ‰∏∫„ÄåÂìàÂ∏åË°®1„ÄçÔºåÁÑ∂ÂêéÂú®„ÄåÂìàÂ∏åË°®2„Äç Êñ∞ÂàõÂª∫‰∏Ä‰∏™Á©∫ÁôΩÁöÑÂìàÂ∏åË°®Ôºå‰∏∫‰∏ãÊ¨° rehash ÂÅöÂáÜÂ§á„ÄÇ</li>
</ul>
<p>Ëøô‰∏™ËøáÁ®ãÁúãËµ∑Êù•ÁÆÄÂçïÔºå‰ΩÜÊòØÂÖ∂ÂÆûÁ¨¨‰∫åÊ≠•ÂæàÊúâÈóÆÈ¢òÔºå<strong>Â¶ÇÊûúÂìàÂ∏åË°®1ÁöÑÊï∞ÊçÆÈùûÂ∏∏Â∫ûÂ§ßÔºåÈÇ£‰πàÂú®ËøÅÁßªËá≥ÂìàÂ∏åË°®2ÁöÑÊó∂ÂÄôÔºåÂõ†‰∏∫‰ºöÊ∂âÂèäÂ§ßÈáèÁöÑÊï∞ÊçÆÊã∑Ë¥ùÔºåÊ≠§Êó∂ÂèØËÉΩ‰ºöÂØπRedisÈÄ†ÊàêÈòªÂ°ûÔºåÊó†Ê≥ïÊúçÂä°ÂÖ∂‰ªñËØ∑Ê±Ç„ÄÇ</strong></p>
<h3 id="Ê∏êËøõÂºèrehash">Ê∏êËøõÂºèrehash
</h3><p>‰∏∫‰∫ÜÈÅøÂÖç rehash Âú®Êï∞ÊçÆËøÅÁßªËøáÁ®ã‰∏≠ÔºåÂõ†Êã∑Ë¥ùÊï∞ÊçÆÁöÑËÄóÊó∂ÔºåÂΩ±Âìç Redis ÊÄßËÉΩÁöÑÊÉÖÂÜµÔºåÊâÄ‰ª• Redis ÈááÁî®‰∫ÜÊ∏êËøõÂºè rehashÔºå‰πüÂ∞±ÊòØÂ∞ÜÊï∞ÊçÆÁöÑËøÅÁßªÁöÑÂ∑•‰Ωú‰∏çÂÜçÊòØ‰∏ÄÊ¨°ÊÄßËøÅÁßªÂÆåÊàêÔºåËÄåÊòØÂàÜÂ§öÊ¨°ËøÅÁßª„ÄÇ</p>
<p>Ê∏êËøõÂºè rehash Ê≠•È™§Â¶Ç‰∏ã:</p>
<ul>
<li>Áªô„ÄåÂìàÂ∏åË°® 2„ÄçÂàÜÈÖçÁ©∫Èó¥;</li>
<li><strong>Âú® rehash ËøõË°åÊúüÈó¥ÔºåÊØèÊ¨°ÂìàÂ∏åË°®ÂÖÉÁ¥†ËøõË°åÊñ∞Â¢û„ÄÅÂà†Èô§„ÄÅÊü•ÊâæÊàñËÄÖÊõ¥Êñ∞Êìç‰ΩúÊó∂ÔºåRedis Èô§‰∫Ü‰ºöÊâßË°åÂØπÂ∫îÁöÑÊìç‰Ωú‰πãÂ§ñÔºåËøò‰ºöÈ°∫Â∫èÂ∞Ü„ÄåÂìàÂ∏åË°®1„Äç‰∏≠Á¥¢Âºï‰ΩçÁΩÆ‰∏äÁöÑÊâÄÊúâ key-value ËøÅÁßªÂà∞„ÄåÂìàÂ∏åË°® 2„Äç ‰∏ä;</strong></li>
<li>ÈöèÁùÄÂ§ÑÁêÜÂÆ¢Êà∑Á´ØÂèëËµ∑ÁöÑÂìàÂ∏åË°®Êìç‰ΩúËØ∑Ê±ÇÊï∞ÈáèË∂äÂ§öÔºåÊúÄÁªàÂú®Êüê‰∏™Êó∂Èó¥ÁÇπ‰ºöÊää„ÄåÂìàÂ∏åË°®1„ÄçÁöÑÊâÄÊúâ keyvalue ËøÅÁßªÂà∞„ÄåÂìàÂ∏åË°® 2„ÄçÔºå‰ªéËÄåÂÆåÊàê rehash Êìç‰Ωú„ÄÇ</li>
</ul>
<p>ËøôÊ†∑Â∞±Â∑ßÂ¶ôÂú∞Êää‰∏ÄÊ¨°ÊÄßÂ§ßÈáèÊï∞ÊçÆËøÅÁßªÂ∑•‰ΩúÁöÑÂºÄÈîÄÔºåÂàÜÊëäÂà∞‰∫ÜÂ§öÊ¨°Â§ÑÁêÜËØ∑Ê±ÇÁöÑËøáÁ®ã‰∏≠ÔºåÈÅøÂÖç‰∫Ü‰∏ÄÊ¨°ÊÄß rehashÁöÑËÄóÊó∂Êìç‰Ωú„ÄÇ</p>
<p>Âú®ËøõË°åÊ∏êËøõÂºè rehash ÁöÑËøáÁ®ã‰∏≠Ôºå‰ºöÊúâ‰∏§‰∏™ÂìàÂ∏åË°®ÔºåÊâÄ‰ª•Âú®Ê∏êËøõÂºè rehash ËøõË°åÊúüÈó¥ÔºåÂìàÂ∏åË°®ÂÖÉÁ¥†ÁöÑÂà†Èô§„ÄÅÊü•Êâæ„ÄÅÊõ¥Êñ∞Á≠âÊìç‰ΩúÈÉΩ‰ºöÂú®Ëøô‰∏§‰∏™ÂìàÂ∏åË°®ËøõË°å„ÄÇ</p>
<p>ÊØîÂ¶ÇÔºåÊü•Êâæ‰∏Ä‰∏™ key ÁöÑÂÄºÁöÑËØùÔºåÂÖà‰ºöÂú®„ÄåÂìàÂ∏åË°®1„ÄçÈáåÈù¢ËøõË°åÊü•ÊâæÔºåÂ¶ÇÊûúÊ≤°ÊâæÂà∞ÔºåÂ∞±‰ºöÁªßÁª≠Âà∞ÂìàÂ∏åË°®2ÈáåÈù¢ËøõË°åÊâæÂà∞„ÄÇ</p>
<p>Âè¶Â§ñÔºåÂú®Ê∏êËøõÂºè rehash ËøõË°åÊúüÈó¥ÔºåÊñ∞Â¢û‰∏Ä‰∏™ key-value Êó∂Ôºå‰ºöË¢´‰øùÂ≠òÂà∞„ÄåÂìàÂ∏åË°®2„ÄçÈáåÈù¢ÔºåËÄå„ÄåÂìàÂ∏åË°®1„ÄçÂàô‰∏çÂÜçËøõË°å‰ªª‰ΩïÊ∑ªÂä†Êìç‰ΩúÔºåËøôÊ†∑‰øùËØÅ‰∫Ü„ÄåÂìàÂ∏åË°®1„ÄçÁöÑ key-value Êï∞ÈáèÂè™‰ºöÂáèÂ∞ëÔºåÈöèÁùÄ rehash Êìç‰ΩúÁöÑÂÆåÊàêÔºåÊúÄÁªà„ÄåÂìàÂ∏åË°®1„ÄçÂ∞±‰ºöÂèòÊàêÁ©∫Ë°®Ôºå</p>
<p>ËÄårehash ÁöÑËß¶ÂèëÊù°‰ª∂Ë∑ü**Ë¥üËΩΩÂõ†Â≠ê(load factor)**ÊúâÂÖ≥Á≥ª„ÄÇ</p>
<p>Ë¥üËΩΩÂõ†Â≠êÂèØ‰ª•ÈÄöËøá‰∏ãÈù¢Ëøô‰∏™ÂÖ¨ÂºèËÆ°ÁÆó:
</p>
$$
                            Ë¥üËΩΩÂõ†Â≠ê = ÂìàÂ∏åË°®Â∑≤‰øùÂ≠òËäÇÁÇπÊï∞Èáè / ÂìàÂ∏åË°®Â§ßÂ∞è
$$<p>
Ëß¶Âèë rehash Êìç‰ΩúÁöÑÊù°‰ª∂Ôºå‰∏ªË¶ÅÊúâ‰∏§‰∏™:</p>
<ul>
<li><strong>ÂΩìË¥üËΩΩÂõ†Â≠êÂ§ß‰∫éÁ≠â‰∫é1ÔºåÂπ∂‰∏î Redis Ê≤°ÊúâÂú®ÊâßË°å bgsave ÂëΩ‰ª§ÊàñËÄÖ bgrewiteaof ÂëΩ‰ª§Ôºå‰πüÂ∞±ÊòØÊ≤°ÊúâÊâßË°åRDB Âø´ÁÖßÊàñÊ≤°ÊúâËøõË°å AOF ÈáçÂÜôÁöÑÊó∂ÂÄôÔºåÂ∞±‰ºöËøõË°å rehash Êìç‰Ωú„ÄÇ</strong></li>
<li><strong>ÂΩìË¥üËΩΩÂõ†Â≠êÂ§ß‰∫éÁ≠â‰∫é5Êó∂ÔºåÊ≠§Êó∂ËØ¥ÊòéÂìàÂ∏åÂÜ≤Á™ÅÈùûÂ∏∏‰∏•Èáç‰∫ÜÔºå‰∏çÁÆ°ÊúâÊ≤°ÊúâÊúâÂú®ÊâßË°å RDB Âø´ÁÖßÊàñ AOF ÈáçÂÜôÔºåÈÉΩ‰ºöÂº∫Âà∂ËøõË°å rehash Êìç‰Ωú„ÄÇ</strong></li>
</ul>
<h2 id="Êï¥Êï∞ÈõÜÂêà">Êï¥Êï∞ÈõÜÂêà
</h2><p>Êï¥Êï∞ÈõÜÂêàÊòØ Set ÂØπË±°ÁöÑÂ∫ïÂ±ÇÂÆûÁé∞‰πã‰∏Ä„ÄÇÂΩì‰∏Ä‰∏™ Set ÂØπË±°Âè™ÂåÖÂê´Êï¥Êï∞ÂÄºÂÖÉÁ¥†ÔºåÂπ∂‰∏îÂÖÉÁ¥†Êï∞Èáè‰∏çÂ§ßÊó∂ÔºåÂ∞±‰ºö‰ΩøÁî®Êï¥Êï∞ÈõÜËøô‰∏™Êï∞ÊçÆÁªìÊûÑ‰Ωú‰∏∫Â∫ïÂ±ÇÂÆûÁé∞„ÄÇ</p>
<h3 id="Êï¥Êï∞ÈõÜÂêàÁªìÊûÑËÆæËÆ°">Êï¥Êï∞ÈõÜÂêàÁªìÊûÑËÆæËÆ°
</h3><p>Êï¥Êï∞ÈõÜÂêàÁöÑÊú¨Ë¥®ÊòØ‰∏ÄÂùóËøûÁª≠ÂÜÖÂ≠òÁ©∫Èó¥ÔºåÂÆÉÁöÑÁªìÊûÑÂÆö‰πâÂ¶Ç‰∏ãÔºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">typedef struct intset {
</span></span><span class="line"><span class="cl">    //ÁºñÁ†ÅÊñπÂºè
</span></span><span class="line"><span class="cl">    uint32_t encoding
</span></span><span class="line"><span class="cl">    //ÈõÜÂêàÂåÖÂê´ÁöÑÂÖÉÁ¥†Êï∞Èáè
</span></span><span class="line"><span class="cl">    uint32 t length;
</span></span><span class="line"><span class="cl">    //‰øùÂ≠òÂÖÉÁ¥†ÁöÑÊï∞ÁªÑ
</span></span><span class="line"><span class="cl">    int8_t contents[];
</span></span><span class="line"><span class="cl">}intset;
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÂèØ‰ª•ÁúãÂà∞Ôºå‰øùÂ≠òÂÖÉÁ¥†ÁöÑÂÆπÂô®ÊòØ‰∏Ä‰∏™ contents Êï∞ÁªÑÔºåËôΩÁÑ∂ contents Ë¢´Â£∞Êòé‰∏∫ int8_tÁ±ªÂûãÁöÑÊï∞ÁªÑÔºå‰ΩÜÊòØÂÆûÈôÖ‰∏ä contents Êï∞ÁªÑÂπ∂‰∏ç‰øùÂ≠ò‰ªª‰Ωï int8_t Á±ªÂûãÁöÑÂÖÉÁ¥†Ôºåcontents Êï∞ÁªÑÁöÑÁúüÊ≠£Á±ªÂûãÂèñÂÜ≥‰∫é intset ÁªìÊûÑ‰ΩìÈáåÁöÑencoding Â±ûÊÄßÁöÑÂÄº„ÄÇÊØîÂ¶Ç:</p>
<ul>
<li>Â¶ÇÊûú encoding Â±ûÊÄßÂÄº‰∏∫ INTSET_ENC INT16ÔºåÈÇ£‰πà contents Â∞±ÊòØ‰∏Ä‰∏™ int16_tÁ±ªÂûãÁöÑÊï∞ÁªÑÔºåÊï∞ÁªÑ‰∏≠ÊØè‰∏Ä‰∏™ÂÖÉÁ¥†ÁöÑÁ±ªÂûãÈÉΩÊòØ int16_t;</li>
<li>Â¶ÇÊûú encoding Â±ûÊÄßÂÄº‰∏∫ INTSET_ENC_INT32ÔºåÈÇ£‰πà contents Â∞±ÊòØ‰∏Ä‰∏™ int32_tÁ±ªÂûãÁöÑÊï∞ÁªÑÔºåÊï∞ÁªÑ‰∏≠ÊØè‰∏Ä‰∏™ÂÖÉÁ¥†ÁöÑÁ±ªÂûãÈÉΩÊòØ int32_t;</li>
<li>Â¶ÇÊûú encoding Â±ûÊÄßÂÄº‰∏∫ INTSET_ENC_INT64ÔºåÈÇ£‰πà contents Â∞±ÊòØ‰∏Ä‰∏™ int64_tÁ±ªÂûãÁöÑÊï∞ÁªÑÔºåÊï∞ÁªÑ‰∏≠ÊØè-‰∏™ÂÖÉÁ¥†ÁöÑÁ±ªÂûãÈÉΩÊòØ int64_t;</li>
</ul>
<p>‰∏çÂêåÁ±ªÂûãÁöÑ contents Êï∞ÁªÑÔºåÊÑèÂë≥ÁùÄÊï∞ÁªÑÁöÑÂ§ßÂ∞è‰πü‰ºö‰∏çÂêå„ÄÇ</p>
<h3 id="Êï¥Êï∞ÈõÜÂêàÁöÑÂçáÁ∫ßÊìç‰Ωú">Êï¥Êï∞ÈõÜÂêàÁöÑÂçáÁ∫ßÊìç‰Ωú
</h3><p>Êï¥Êï∞ÈõÜÂêà‰ºöÊúâ‰∏Ä‰∏™ÂçáÁ∫ßËßÑÂàôÔºåÂ∞±ÊòØÂΩìÊàë‰ª¨Â∞Ü‰∏Ä‰∏™Êñ∞ÂÖÉÁ¥†Âä†ÂÖ•Âà∞Êï¥Êï∞ÈõÜÂêàÈáåÈù¢ÔºåÂ¶ÇÊûúÊñ∞ÂÖÉÁ¥†ÁöÑÁ±ªÂûã(int32_t)ÊØîÊï¥Êï∞ÈõÜÂêàÁé∞ÊúâÊâÄÊúâÂÖÉÁ¥†ÁöÑÁ±ªÂûã(int16_t)ÈÉΩË¶ÅÈïøÊó∂ÔºåÊï¥Êï∞ÈõÜÂêàÈúÄË¶ÅÂÖàËøõË°åÂçáÁ∫ßÔºå‰πüÂ∞±ÊòØÊåâÊñ∞ÂÖÉÁ¥†ÁöÑÁ±ªÂûã(int32_t)Êâ©Â±ï contents Êï∞ÁªÑÁöÑÁ©∫Èó¥Â§ßÂ∞èÔºåÁÑ∂ÂêéÊâçËÉΩÂ∞ÜÊñ∞ÂÖÉÁ¥†Âä†ÂÖ•Âà∞Êï¥Êï∞ÈõÜÂêàÈáåÔºåÂΩìÁÑ∂ÂçáÁ∫ßÁöÑËøáÁ®ã‰∏≠Ôºå‰πüË¶ÅÁª¥ÊåÅÊï¥Êï∞ÈõÜÂêàÁöÑÊúâÂ∫èÊÄß„ÄÇ</p>
<p><strong>Êï¥Êï∞ÈõÜÂêàÂçáÁ∫ßÁöÑËøáÁ®ã‰∏ç‰ºöÈáçÊñ∞ÂàÜÈÖç‰∏Ä‰∏™Êñ∞Á±ªÂûãÁöÑÊï∞ÁªÑÔºåËÄåÊòØÂú®ÂéüÊú¨ÁöÑÊï∞ÁªÑ‰∏äÊâ©Â±ïÁ©∫Èó¥ÔºåÁÑ∂ÂêéÂú®Â∞ÜÊØè‰∏™ÂÖÉÁ¥†ÊåâÈó¥ÈöîÁ±ªÂûãÂ§ßÂ∞èÂàÜÂâ≤ÔºåÂ¶ÇÊûú encoding Â±ûÊÄßÂÄº‰∏∫ INTSET_ENC_INT16ÔºåÂàôÊØè‰∏™ÂÖÉÁ¥†ÁöÑÈó¥ÈöîÂ∞±ÊòØ 16 ‰Ωç„ÄÇ</strong></p>
<h4 id="Êï¥Êï∞ÈõÜÂêàÂçáÁ∫ßÊúâ‰ªÄ‰πàÂ•ΩÂ§ÑÂë¢">Êï¥Êï∞ÈõÜÂêàÂçáÁ∫ßÊúâ‰ªÄ‰πàÂ•ΩÂ§ÑÂë¢Ôºü
</h4><p>Â¶ÇÊûúË¶ÅËÆ©‰∏Ä‰∏™Êï∞ÁªÑÂêåÊó∂‰øùÂ≠ò int16_t„ÄÅint32_t„ÄÅint64_t Á±ªÂûãÁöÑÂÖÉÁ¥†ÔºåÊúÄÁÆÄÂçïÂÅöÊ≥ïÂ∞±ÊòØÁõ¥Êé•‰ΩøÁî® int64_t Á±ªÂûãÁöÑÊï∞ÁªÑ„ÄÇ‰∏çËøáËøôÊ†∑ÁöÑËØùÔºåÂΩìÂ¶ÇÊûúÂÖÉÁ¥†ÈÉΩÊòØ int16_t Á±ªÂûãÁöÑÔºåÂ∞±‰ºöÈÄ†ÊàêÂÜÖÂ≠òÊµ™Ë¥πÁöÑÊÉÖÂÜµ„ÄÇ</p>
<p>Êï¥Êï∞ÈõÜÂêàÂçáÁ∫ßÂ∞±ËÉΩÈÅøÂÖçËøôÁßçÊÉÖÂÜµÔºåÂ¶ÇÊûú‰∏ÄÁõ¥ÂêëÊï¥Êï∞ÈõÜÂêàÊ∑ªÂä† int16_t Á±ªÂûãÁöÑÂÖÉÁ¥†ÔºåÈÇ£‰πàÊï¥Êï∞ÈõÜÂêàÁöÑÂ∫ïÂ±ÇÂÆûÁé∞Â∞±‰∏ÄÁõ¥ÊòØÁî® int16_t Á±ªÂûãÁöÑÊï∞ÁªÑÔºåÂè™ÊúâÂú®Êàë‰ª¨Ë¶ÅÂ∞Ü int32_t Á±ªÂûãÊàñ int64_t Á±ªÂûãÁöÑÂÖÉÁ¥†Ê∑ªÂä†Âà∞ÈõÜÂêàÊó∂ÔºåÊâç‰ºöÂØπÊï∞ÁªÑËøõË°åÂçáÁ∫ßÊìç‰Ωú„ÄÇ</p>
<p>Âõ†Ê≠§ÔºåÊï¥Êï∞ÈõÜÂêàÂçáÁ∫ßÁöÑÂ•ΩÂ§ÑÊòØËäÇÁúÅÂÜÖÂ≠òËµÑÊ∫ê„ÄÇ</p>
<h4 id="Êï¥Êï∞ÈõÜÂêàÊîØÊåÅÈôçÁ∫ßÊìç‰ΩúÂêó">Êï¥Êï∞ÈõÜÂêàÊîØÊåÅÈôçÁ∫ßÊìç‰ΩúÂêóÔºü
</h4><p><strong>‰∏çÊîØÊåÅÈôçÁ∫ßÊìç‰Ωú</strong>Ôºå‰∏ÄÊó¶ÂØπÊï∞ÁªÑËøõË°å‰∫ÜÂçáÁ∫ßÔºåÂ∞±‰ºö‰∏ÄÁõ¥‰øùÊåÅÂçáÁ∫ßÂêéÁöÑÁä∂ÊÄÅ„ÄÇ</p>
<h2 id="Ë∑≥Ë°®">Ë∑≥Ë°®
</h2><p>Redis Âè™Êúâ Zset ÂØπË±°ÁöÑÂ∫ïÂ±ÇÂÆûÁé∞Áî®Âà∞‰∫ÜË∑≥Ë°®ÔºåË∑≥Ë°®ÁöÑ‰ºòÂäøÊòØËÉΩÊîØÊåÅÂπ≥Âùá O(logN) Â§çÊùÇÂ∫¶ÁöÑËäÇÁÇπÊü•Êâæ„ÄÇ</p>
<p>zset ÁªìÊûÑ‰ΩìÈáåÊúâ‰∏§‰∏™Êï∞ÊçÆÁªìÊûÑÔºö‰∏Ä‰∏™ÊòØË∑≥Ë°®Ôºå‰∏Ä‰∏™ÊòØÂìàÂ∏åË°®„ÄÇËøôÊ†∑ÁöÑÂ•ΩÂ§ÑÊòØÊó¢ËÉΩËøõË°åÈ´òÊïàÁöÑËåÉÂõ¥Êü•ËØ¢Ôºå‰πüËÉΩËøõË°åÈ´òÊïàÂçïÁÇπÊü•ËØ¢„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">typedef struct zset {
</span></span><span class="line"><span class="cl">    dict *dict;
</span></span><span class="line"><span class="cl">    zskiplist *zsl;
</span></span><span class="line"><span class="cl">} zset;
</span></span></code></pre></td></tr></table>
</div>
</div><p>set ÂØπË±°Âú®ÊâßË°åÊï∞ÊçÆÊèíÂÖ•ÊàñÊòØÊï∞ÊçÆÊõ¥Êñ∞ÁöÑËøáÁ®ã‰∏≠Ôºå‰ºö‰æùÊ¨°Âú®Ë∑≥Ë°®ÂíåÂìàÂ∏åË°®‰∏≠ÊèíÂÖ•ÊàñÊõ¥Êñ∞Áõ∏Â∫îÁöÑÊï∞ÊçÆÔºå‰ªéËÄå‰øùËØÅ‰∫ÜË∑≥Ë°®ÂíåÂìàÂ∏åË°®‰∏≠ËÆ∞ÂΩïÁöÑ‰ø°ÊÅØ‰∏ÄËá¥„ÄÇ</p>
<p>Zset ÂØπË±°ËÉΩÊîØÊåÅËåÉÂõ¥Êü•ËØ¢ÔºàÂ¶Ç ZRANGEBYSCORE Êìç‰ΩúÔºâÔºåËøôÊòØÂõ†‰∏∫ÂÆÉÁöÑÊï∞ÊçÆÁªìÊûÑËÆæËÆ°ÈááÁî®‰∫Ü<strong>Ë∑≥Ë°®</strong>ÔºåËÄåÂèàËÉΩ‰ª•Â∏∏Êï∞Â§çÊùÇÂ∫¶Ëé∑ÂèñÂÖÉÁ¥†ÊùÉÈáçÔºàÂ¶Ç ZSCORE Êìç‰ΩúÔºâÔºåËøôÊòØÂõ†‰∏∫ÂÆÉÂêåÊó∂ÈááÁî®‰∫Ü<strong>ÂìàÂ∏åË°®</strong>ËøõË°åÁ¥¢Âºï„ÄÇ</p>
<p>ËôΩÁÑ∂Zset ÂØπË±°Âú®‰ΩøÁî®Ë∑≥Ë°®‰Ωú‰∏∫Êï∞ÊçÆÁªìÊûÑÁöÑÊó∂ÂÄôÔºåÊòØ‰ΩøÁî®Áî±„ÄåÂìàÂ∏åË°®+Ë∑≥Ë°®„ÄçÁªÑÊàêÁöÑ struct zsetÔºå‰ΩÜÊòØstruct zset ‰∏≠ÁöÑÂìàÂ∏åË°®Âè™ÊòØÁî®‰∫é‰ª•Â∏∏Êï∞Â§çÊùÇÂ∫¶Ëé∑ÂèñÂÖÉÁ¥†ÊùÉÈáçÔºåÂÖ∂‰ΩôÂ§ßÈÉ®ÂàÜÊìç‰ΩúÈÉΩÊòØË∑≥Ë°®ÂÆûÁé∞ÁöÑ„ÄÇ</p>
<h3 id="Ë∑≥Ë°®ÁªìÊûÑËÆæËÆ°">Ë∑≥Ë°®ÁªìÊûÑËÆæËÆ°
</h3><p>ÈìæË°®Âú®Êü•ÊâæÂÖÉÁ¥†ÁöÑÊó∂ÂÄôÔºåÂõ†‰∏∫ÈúÄË¶ÅÈÄê‰∏ÄÊü•ÊâæÔºåÊâÄ‰ª•Êü•ËØ¢ÊïàÁéáÈùûÂ∏∏‰ΩéÔºåÊó∂Èó¥Â§çÊùÇÂ∫¶ÊòØO(N)Ôºå‰∫éÊòØÂ∞±Âá∫Áé∞‰∫ÜË∑≥Ë°®„ÄÇ<strong>Ë∑≥Ë°®ÊòØÂú®ÈìæË°®Âü∫Á°Ä‰∏äÊîπËøõËøáÊù•ÁöÑÔºåÂÆûÁé∞‰∫Ü‰∏ÄÁßç„ÄåÂ§öÂ±Ç„ÄçÁöÑÊúâÂ∫èÈìæË°®</strong>ÔºåËøôÊ†∑ÁöÑÂ•ΩÂ§ÑÊòØËÉΩÂø´ËØªÂÆö‰ΩçÊï∞ÊçÆ„ÄÇ</p>
<p>Âõæ‰∏≠Â§¥ËäÇÁÇπÊúâ L0~L2 ‰∏â‰∏™Â§¥ÊåáÈíàÔºåÂàÜÂà´ÊåáÂêë‰∫Ü‰∏çÂêåÂ±ÇÁ∫ßÁöÑËäÇÁÇπÔºåÁÑ∂ÂêéÊØè‰∏™Â±ÇÁ∫ßÁöÑËäÇÁÇπÈÉΩÈÄöËøáÊåáÈíàËøûÊé•Ëµ∑Êù•Ôºö</p>
<ul>
<li>L0 Â±ÇÁ∫ßÂÖ±Êúâ 5 ‰∏™ËäÇÁÇπÔºåÂàÜÂà´ÊòØËäÇÁÇπ1„ÄÅ2„ÄÅ3„ÄÅ4„ÄÅ5Ôºõ</li>
<li>L1 Â±ÇÁ∫ßÂÖ±Êúâ 3 ‰∏™ËäÇÁÇπÔºåÂàÜÂà´ÊòØËäÇÁÇπ 2„ÄÅ3„ÄÅ5Ôºõ</li>
<li>L2 Â±ÇÁ∫ßÂè™Êúâ 1 ‰∏™ËäÇÁÇπÔºå‰πüÂ∞±ÊòØËäÇÁÇπ 3 „ÄÇ</li>
</ul>
<p>Â¶ÇÊûúÊàë‰ª¨Ë¶ÅÂú®ÈìæË°®‰∏≠Êü•ÊâæËäÇÁÇπ 4 Ëøô‰∏™ÂÖÉÁ¥†ÔºåÂè™ËÉΩ‰ªéÂ§¥ÂºÄÂßãÈÅçÂéÜÈìæË°®ÔºåÈúÄË¶ÅÊü•Êâæ 4 Ê¨°ÔºåËÄå‰ΩøÁî®‰∫ÜË∑≥Ë°®ÂêéÔºåÂè™ÈúÄË¶ÅÊü•Êâæ 2 Ê¨°Â∞±ËÉΩÂÆö‰ΩçÂà∞ËäÇÁÇπ 4ÔºåÂõ†‰∏∫ÂèØ‰ª•Âú®Â§¥ËäÇÁÇπÁõ¥Êé•‰ªé L2 Â±ÇÁ∫ßË∑≥Âà∞ËäÇÁÇπ 3ÔºåÁÑ∂ÂêéÂÜçÂæÄÂâçÈÅçÂéÜÊâæÂà∞ËäÇÁÇπ 4„ÄÇ</p>
<p>ÂèØ‰ª•ÁúãÂà∞ÔºåËøô‰∏™Êü•ÊâæËøáÁ®ãÂ∞±ÊòØÂú®Â§ö‰∏™Â±ÇÁ∫ß‰∏äË∑≥Êù•Ë∑≥ÂéªÔºåÊúÄÂêéÂÆö‰ΩçÂà∞ÂÖÉÁ¥†„ÄÇÂΩìÊï∞ÊçÆÈáèÂæàÂ§ßÊó∂ÔºåË∑≥Ë°®ÁöÑÊü•ÊâæÂ§çÊùÇÂ∫¶Â∞±ÊòØ O(logN)„ÄÇ</p>
<p>Ë∑≥Ë°®ËäÇÁÇπÊï∞ÊçÆÁªìÊûÑÔºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">typedef struct zskiplistNode {
</span></span><span class="line"><span class="cl">    //Zset ÂØπË±°ÁöÑÂÖÉÁ¥†ÂÄº
</span></span><span class="line"><span class="cl">    sds ele
</span></span><span class="line"><span class="cl">;
</span></span><span class="line"><span class="cl">    //ÂÖÉÁ¥†ÊùÉÈáçÂÄº
</span></span><span class="line"><span class="cl">    double score;
</span></span><span class="line"><span class="cl">    //ÂêéÂêëÊåáÈíà
</span></span><span class="line"><span class="cl">    struct zskiplistNode *backward;
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    //ËäÇÁÇπÁöÑlevelÊï∞ÁªÑÔºå‰øùÂ≠òÊØèÂ±Ç‰∏äÁöÑÂâçÂêëÊåáÈíàÂíåË∑®Â∫¶
</span></span><span class="line"><span class="cl">    struct zskiplistLevel {
</span></span><span class="line"><span class="cl">        struct zskiplistNode *forward;
</span></span><span class="line"><span class="cl">        unsigned long span;
</span></span><span class="line"><span class="cl">    } level[];
</span></span><span class="line"><span class="cl">} zskiplistNode;
</span></span></code></pre></td></tr></table>
</div>
</div><p>Zset ÂØπË±°Ë¶ÅÂêåÊó∂‰øùÂ≠ò„ÄåÂÖÉÁ¥†„ÄçÂíå„ÄåÂÖÉÁ¥†ÁöÑÊùÉÈáç„ÄçÔºåÂØπÂ∫îÂà∞Ë∑≥Ë°®ËäÇÁÇπÁªìÊûÑÈáåÂ∞±ÊòØ sds Á±ªÂûãÁöÑ ele ÂèòÈáèÂíå double Á±ªÂûãÁöÑ score ÂèòÈáè„ÄÇÊØè‰∏™Ë∑≥Ë°®ËäÇÁÇπÈÉΩÊúâ‰∏Ä‰∏™ÂêéÂêëÊåáÈíàÔºàstruct zskiplistNode *backwardÔºâÔºåÊåáÂêëÂâç‰∏Ä‰∏™ËäÇÁÇπÔºåÁõÆÁöÑÊòØ‰∏∫‰∫ÜÊñπ‰æø‰ªéË∑≥Ë°®ÁöÑÂ∞æËäÇÁÇπÂºÄÂßãËÆøÈóÆËäÇÁÇπÔºåËøôÊ†∑ÂÄíÂ∫èÊü•ÊâæÊó∂ÂæàÊñπ‰æø„ÄÇ</p>
<p>Ë∑≥Ë°®ÊòØ‰∏Ä‰∏™Â∏¶ÊúâÂ±ÇÁ∫ßÂÖ≥Á≥ªÁöÑÈìæË°®ÔºåËÄå‰∏îÊØè‰∏ÄÂ±ÇÁ∫ßÂèØ‰ª•ÂåÖÂê´Â§ö‰∏™ËäÇÁÇπÔºåÊØè‰∏Ä‰∏™ËäÇÁÇπÈÄöËøáÊåáÈíàËøûÊé•Ëµ∑Êù•ÔºåÂÆûÁé∞Ëøô‰∏ÄÁâπÊÄßÂ∞±ÊòØÈù†Ë∑≥Ë°®ËäÇÁÇπÁªìÊûÑ‰Ωì‰∏≠ÁöÑzskiplistLevel ÁªìÊûÑ‰ΩìÁ±ªÂûãÁöÑ level Êï∞ÁªÑ„ÄÇ</p>
<p>level Êï∞ÁªÑ‰∏≠ÁöÑÊØè‰∏Ä‰∏™ÂÖÉÁ¥†‰ª£Ë°®Ë∑≥Ë°®ÁöÑ‰∏ÄÂ±ÇÔºå‰πüÂ∞±ÊòØÁî± zskiplistLevel ÁªìÊûÑ‰ΩìË°®Á§∫ÔºåÊØîÂ¶Ç leve[0] Â∞±Ë°®Á§∫Á¨¨‰∏ÄÂ±ÇÔºåleve[1] Â∞±Ë°®Á§∫Á¨¨‰∫åÂ±Ç„ÄÇzskiplistLevel ÁªìÊûÑ‰ΩìÈáåÂÆö‰πâ‰∫Ü„ÄåÊåáÂêë‰∏ã‰∏Ä‰∏™Ë∑≥Ë°®ËäÇÁÇπÁöÑÊåáÈíà„ÄçÂíå„ÄåË∑®Â∫¶„ÄçÔºåË∑®Â∫¶Êó∂Áî®Êù•ËÆ∞ÂΩï‰∏§‰∏™ËäÇÁÇπ‰πãÈó¥ÁöÑË∑ùÁ¶ª„ÄÇ</p>
<p>**Ë∑®Â∫¶ÂÆûÈôÖ‰∏äÊòØ‰∏∫‰∫ÜËÆ°ÁÆóËøô‰∏™ËäÇÁÇπÂú®Ë∑≥Ë°®‰∏≠ÁöÑÊéí‰Ωç„ÄÇ**ÂÖ∑‰ΩìÊÄé‰πàÂÅöÁöÑÂë¢ÔºüÂõ†‰∏∫Ë∑≥Ë°®‰∏≠ÁöÑËäÇÁÇπÈÉΩÊòØÊåâÂ∫èÊéíÂàóÁöÑÔºåÈÇ£‰πàËÆ°ÁÆóÊüê‰∏™ËäÇÁÇπÊéí‰ΩçÁöÑÊó∂ÂÄôÔºå‰ªéÂ§¥ËäÇÁÇπÁÇπÂà∞ËØ•ÁªìÁÇπÁöÑÊü•ËØ¢Ë∑ØÂæÑ‰∏äÔºåÂ∞ÜÊ≤øÈÄîËÆøÈóÆËøáÁöÑÊâÄÊúâÂ±ÇÁöÑË∑®Â∫¶Á¥ØÂä†Ëµ∑Êù•ÔºåÂæóÂà∞ÁöÑÁªìÊûúÂ∞±ÊòØÁõÆÊ†áËäÇÁÇπÂú®Ë∑≥Ë°®‰∏≠ÁöÑÊéí‰Ωç„ÄÇ</p>
<p>Ë∑≥Ë°®ÁªìÊûÑ‰ΩìÔºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">typedef struct zskiplist {
</span></span><span class="line"><span class="cl">    struct zskiplistNode *header, *tail;
</span></span><span class="line"><span class="cl">    unsigned long length;
</span></span><span class="line"><span class="cl">    int level;
</span></span><span class="line"><span class="cl">} zskiplist;
</span></span></code></pre></td></tr></table>
</div>
</div><p>Ë∑≥Ë°®ÁªìÊûÑÈáåÂåÖÂê´‰∫ÜÔºö</p>
<ul>
<li>Ë∑≥Ë°®ÁöÑÂ§¥Â∞æËäÇÁÇπÔºå‰æø‰∫éÂú®O(1)Êó∂Èó¥Â§çÊùÇÂ∫¶ÂÜÖËÆøÈóÆË∑≥Ë°®ÁöÑÂ§¥ËäÇÁÇπÂíåÂ∞æËäÇÁÇπÔºõ</li>
<li>Ë∑≥Ë°®ÁöÑÈïøÂ∫¶Ôºå‰æø‰∫éÂú®O(1)Êó∂Èó¥Â§çÊùÇÂ∫¶Ëé∑ÂèñË∑≥Ë°®ËäÇÁÇπÁöÑÊï∞ÈáèÔºõ</li>
<li>Ë∑≥Ë°®ÁöÑÊúÄÂ§ßÂ±ÇÊï∞Ôºå‰æø‰∫éÂú®O(1)Êó∂Èó¥Â§çÊùÇÂ∫¶Ëé∑ÂèñË∑≥Ë°®‰∏≠Â±ÇÈ´òÊúÄÂ§ßÁöÑÈÇ£‰∏™ËäÇÁÇπÁöÑÂ±ÇÊï∞ÈáèÔºõ</li>
</ul>
<h3 id="Ë∑≥Ë°®ËäÇÁÇπÊü•ËØ¢ËøáÁ®ã">Ë∑≥Ë°®ËäÇÁÇπÊü•ËØ¢ËøáÁ®ã
</h3><p>Êü•Êâæ‰∏Ä‰∏™Ë∑≥Ë°®ËäÇÁÇπÁöÑËøáÁ®ãÊó∂ÔºåË∑≥Ë°®‰ºö‰ªéÂ§¥ËäÇÁÇπÁöÑÊúÄÈ´òÂ±ÇÂºÄÂßãÔºåÈÄê‰∏ÄÈÅçÂéÜÊØè‰∏ÄÂ±Ç„ÄÇÂú®ÈÅçÂéÜÊüê‰∏ÄÂ±ÇÁöÑË∑≥Ë°®ËäÇÁÇπÊó∂Ôºå‰ºöÁî®Ë∑≥Ë°®ËäÇÁÇπ‰∏≠ÁöÑ SDS Á±ªÂûãÁöÑÂÖÉÁ¥†ÂíåÂÖÉÁ¥†ÁöÑÊùÉÈáçÊù•ËøõË°åÂà§Êñ≠ÔºåÂÖ±Êúâ‰∏§‰∏™Âà§Êñ≠Êù°‰ª∂Ôºö</p>
<ul>
<li>Â¶ÇÊûúÂΩìÂâçËäÇÁÇπÁöÑÊùÉÈáç„ÄåÂ∞è‰∫é„ÄçË¶ÅÊü•ÊâæÁöÑÊùÉÈáçÊó∂ÔºåË∑≥Ë°®Â∞±‰ºöËÆøÈóÆËØ•Â±Ç‰∏äÁöÑ‰∏ã‰∏Ä‰∏™ËäÇÁÇπ„ÄÇ</li>
<li>Â¶ÇÊûúÂΩìÂâçËäÇÁÇπÁöÑÊùÉÈáç„ÄåÁ≠â‰∫é„ÄçË¶ÅÊü•ÊâæÁöÑÊùÉÈáçÊó∂ÔºåÂπ∂‰∏îÂΩìÂâçËäÇÁÇπÁöÑ SDS Á±ªÂûãÊï∞ÊçÆ„ÄåÂ∞è‰∫é„ÄçË¶ÅÊü•ÊâæÁöÑÊï∞ÊçÆÊó∂ÔºåË∑≥Ë°®Â∞±‰ºöËÆøÈóÆËØ•Â±Ç‰∏äÁöÑ‰∏ã‰∏Ä‰∏™ËäÇÁÇπ„ÄÇ</li>
</ul>
<p>Â¶ÇÊûú‰∏äÈù¢‰∏§‰∏™Êù°‰ª∂ÈÉΩ‰∏çÊª°Ë∂≥ÔºåÊàñËÄÖ‰∏ã‰∏Ä‰∏™ËäÇÁÇπ‰∏∫Á©∫Êó∂ÔºåË∑≥Ë°®Â∞±‰ºö‰ΩøÁî®ÁõÆÂâçÈÅçÂéÜÂà∞ÁöÑËäÇÁÇπÁöÑ level Êï∞ÁªÑÈáåÁöÑ‰∏ã‰∏ÄÂ±ÇÊåáÈíàÔºåÁÑ∂ÂêéÊ≤øÁùÄ‰∏ã‰∏ÄÂ±ÇÊåáÈíàÁªßÁª≠Êü•ÊâæÔºåËøôÂ∞±Áõ∏ÂΩì‰∫éË∑≥Âà∞‰∫Ü‰∏ã‰∏ÄÂ±ÇÊé•ÁùÄÊü•Êâæ„ÄÇ</p>
<h3 id="Ë∑≥Ë°®ËäÇÁÇπÂ±ÇÊï∞ËÆæÁΩÆ">Ë∑≥Ë°®ËäÇÁÇπÂ±ÇÊï∞ËÆæÁΩÆ
</h3><p>Ë∑≥Ë°®ÁöÑÁõ∏ÈÇª‰∏§Â±ÇÁöÑËäÇÁÇπÊï∞ÈáèÁöÑÊØî‰æã‰ºöÂΩ±ÂìçË∑≥Ë°®ÁöÑÊü•ËØ¢ÊÄßËÉΩ„ÄÇ</p>
<p><strong>Ë∑≥Ë°®ÁöÑÁõ∏ÈÇª‰∏§Â±ÇÁöÑËäÇÁÇπÊï∞ÈáèÊúÄÁêÜÊÉ≥ÁöÑÊØî‰æãÊòØ 2:1ÔºåÊü•ÊâæÂ§çÊùÇÂ∫¶ÂèØ‰ª•Èôç‰ΩéÂà∞ O(logN)„ÄÇ</strong></p>
<h4 id="ÈÇ£ÊÄéÊ†∑ÊâçËÉΩÁª¥ÊåÅÁõ∏ÈÇª‰∏§Â±ÇÁöÑËäÇÁÇπÊï∞ÈáèÁöÑÊØî‰æã‰∏∫-2--1-Âë¢">ÈÇ£ÊÄéÊ†∑ÊâçËÉΩÁª¥ÊåÅÁõ∏ÈÇª‰∏§Â±ÇÁöÑËäÇÁÇπÊï∞ÈáèÁöÑÊØî‰æã‰∏∫ 2 : 1 Âë¢Ôºü
</h4><p>Â¶ÇÊûúÈááÁî®Êñ∞Â¢ûËäÇÁÇπÊàñËÄÖÂà†Èô§ËäÇÁÇπÊó∂ÔºåÊù•Ë∞ÉÊï¥Ë∑≥Ë°®ËäÇÁÇπ‰ª•Áª¥ÊåÅÊØî‰æãÁöÑÊñπÊ≥ïÁöÑËØùÔºå‰ºöÂ∏¶Êù•È¢ùÂ§ñÁöÑÂºÄÈîÄ„ÄÇ</p>
<p>Redis ÂàôÈááÁî®‰∏ÄÁßçÂ∑ßÂ¶ôÁöÑÊñπÊ≥ïÊòØÔºå<strong>Ë∑≥Ë°®Âú®ÂàõÂª∫ËäÇÁÇπÁöÑÊó∂ÂÄôÔºåÈöèÊú∫ÁîüÊàêÊØè‰∏™ËäÇÁÇπÁöÑÂ±ÇÊï∞</strong>ÔºåÂπ∂Ê≤°Êúâ‰∏•Ê†ºÁª¥ÊåÅÁõ∏ÈÇª‰∏§Â±ÇÁöÑËäÇÁÇπÊï∞ÈáèÊØî‰æã‰∏∫ 2 : 1 ÁöÑÊÉÖÂÜµ„ÄÇ</p>
<p>ÂÖ∑‰ΩìÁöÑÂÅöÊ≥ïÊòØÔºå<strong>Ë∑≥Ë°®Âú®ÂàõÂª∫ËäÇÁÇπÊó∂ÂÄôÔºå‰ºöÁîüÊàêËåÉÂõ¥‰∏∫[0-1]ÁöÑ‰∏Ä‰∏™ÈöèÊú∫Êï∞ÔºåÂ¶ÇÊûúËøô‰∏™ÈöèÊú∫Êï∞Â∞è‰∫é 0.25ÔºàÁõ∏ÂΩì‰∫éÊ¶ÇÁéá 25%ÔºâÔºåÈÇ£‰πàÂ±ÇÊï∞Â∞±Â¢ûÂä† 1 Â±ÇÔºåÁÑ∂ÂêéÁªßÁª≠ÁîüÊàê‰∏ã‰∏Ä‰∏™ÈöèÊú∫Êï∞ÔºåÁõ¥Âà∞ÈöèÊú∫Êï∞ÁöÑÁªìÊûúÂ§ß‰∫é 0.25 ÁªìÊùüÔºåÊúÄÁªàÁ°ÆÂÆöËØ•ËäÇÁÇπÁöÑÂ±ÇÊï∞„ÄÇ</strong></p>
<p>ËøôÊ†∑ÁöÑÂÅöÊ≥ïÔºåÁõ∏ÂΩì‰∫éÊØèÂ¢ûÂä†‰∏ÄÂ±ÇÁöÑÊ¶ÇÁéá‰∏çË∂ÖËøá 25%ÔºåÂ±ÇÊï∞Ë∂äÈ´òÔºåÊ¶ÇÁéáË∂ä‰ΩéÔºåÂ±ÇÈ´òÊúÄÂ§ßÈôêÂà∂ÊòØ 64„ÄÇ</p>
<p>ËôΩÁÑ∂ÊàëÂâçÈù¢ËÆ≤Ëß£Ë∑≥Ë°®ÁöÑÊó∂ÂÄôÔºåÂõæ‰∏≠ÁöÑË∑≥Ë°®ÁöÑ„ÄåÂ§¥ËäÇÁÇπ„ÄçÈÉΩÊòØ 3 Â±ÇÈ´òÔºå<strong>‰ΩÜÊòØÂÖ∂ÂÆûÂ¶ÇÊûúÂ±ÇÈ´òÊúÄÂ§ßÈôêÂà∂ÊòØ 64ÔºåÈÇ£‰πàÂú®ÂàõÂª∫Ë∑≥Ë°®„ÄåÂ§¥ËäÇÁÇπ„ÄçÁöÑÊó∂ÂÄôÔºåÂ∞±‰ºöÁõ¥Êé•ÂàõÂª∫ 64 Â±ÇÈ´òÁöÑÂ§¥ËäÇÁÇπ</strong>„ÄÇ</p>
<h3 id="‰∏∫‰ªÄ‰πàÁî®Ë∑≥Ë°®ËÄå‰∏çÁî®Âπ≥Ë°°Ê†ë">‰∏∫‰ªÄ‰πàÁî®Ë∑≥Ë°®ËÄå‰∏çÁî®Âπ≥Ë°°Ê†ëÔºü
</h3><p>‰∏ªË¶ÅÊòØ‰ªéÂÜÖÂ≠òÂç†Áî®„ÄÅÂØπËåÉÂõ¥Êü•ÊâæÁöÑÊîØÊåÅ„ÄÅÂÆûÁé∞ÈöæÊòìÁ®ãÂ∫¶Ëøô‰∏âÊñπÈù¢ÊÄªÁªìÁöÑÂéüÂõ†Ôºö</p>
<ul>
<li>**‰ªéÂÜÖÂ≠òÂç†Áî®‰∏äÊù•ÊØîËæÉÔºåË∑≥Ë°®ÊØîÂπ≥Ë°°Ê†ëÊõ¥ÁÅµÊ¥ª‰∏Ä‰∫õ„ÄÇ**Âπ≥Ë°°Ê†ëÊØè‰∏™ËäÇÁÇπÂåÖÂê´ 2 ‰∏™ÊåáÈíàÔºàÂàÜÂà´ÊåáÂêëÂ∑¶Âè≥Â≠êÊ†ëÔºâÔºåËÄåË∑≥Ë°®ÊØè‰∏™ËäÇÁÇπÂåÖÂê´ÁöÑÊåáÈíàÊï∞ÁõÆÂπ≥Âùá‰∏∫ 1/(1-p)ÔºåÂÖ∑‰ΩìÂèñÂÜ≥‰∫éÂèÇÊï∞ p ÁöÑÂ§ßÂ∞è„ÄÇÂ¶ÇÊûúÂÉè RedisÈáåÁöÑÂÆûÁé∞‰∏ÄÊ†∑ÔºåÂèñ p=1/4ÔºåÈÇ£‰πàÂπ≥ÂùáÊØè‰∏™ËäÇÁÇπÂåÖÂê´ 1.33 ‰∏™ÊåáÈíàÔºåÊØîÂπ≥Ë°°Ê†ëÊõ¥Êúâ‰ºòÂäø„ÄÇ</li>
<li>**Âú®ÂÅöËåÉÂõ¥Êü•ÊâæÁöÑÊó∂ÂÄôÔºåË∑≥Ë°®ÊØîÂπ≥Ë°°Ê†ëÊìç‰ΩúË¶ÅÁÆÄÂçï„ÄÇ**Âú®Âπ≥Ë°°Ê†ë‰∏äÔºåÊàë‰ª¨ÊâæÂà∞ÊåáÂÆöËåÉÂõ¥ÁöÑÂ∞èÂÄº‰πãÂêéÔºåËøòÈúÄË¶Å‰ª•‰∏≠Â∫èÈÅçÂéÜÁöÑÈ°∫Â∫èÁªßÁª≠ÂØªÊâæÂÖ∂ÂÆÉ‰∏çË∂ÖËøáÂ§ßÂÄºÁöÑËäÇÁÇπ„ÄÇÂ¶ÇÊûú‰∏çÂØπÂπ≥Ë°°Ê†ëËøõË°å‰∏ÄÂÆöÁöÑÊîπÈÄ†ÔºåËøôÈáåÁöÑ‰∏≠Â∫èÈÅçÂéÜÂπ∂‰∏çÂÆπÊòìÂÆûÁé∞„ÄÇËÄåÂú®Ë∑≥Ë°®‰∏äËøõË°åËåÉÂõ¥Êü•ÊâæÂ∞±ÈùûÂ∏∏ÁÆÄÂçïÔºåÂè™ÈúÄË¶ÅÂú®ÊâæÂà∞Â∞èÂÄº‰πãÂêéÔºåÂØπÁ¨¨ 1 Â±ÇÈìæË°®ËøõË°åËã•Âπ≤Ê≠•ÁöÑÈÅçÂéÜÂ∞±ÂèØ‰ª•ÂÆûÁé∞„ÄÇ</li>
<li><strong>‰ªéÁÆóÊ≥ïÂÆûÁé∞ÈöæÂ∫¶‰∏äÊù•ÊØîËæÉÔºåË∑≥Ë°®ÊØîÂπ≥Ë°°Ê†ëË¶ÅÁÆÄÂçïÂæóÂ§ö</strong>„ÄÇÂπ≥Ë°°Ê†ëÁöÑÊèíÂÖ•ÂíåÂà†Èô§Êìç‰ΩúÂèØËÉΩÂºïÂèëÂ≠êÊ†ëÁöÑË∞ÉÊï¥ÔºåÈÄªËæëÂ§çÊùÇÔºåËÄåË∑≥Ë°®ÁöÑÊèíÂÖ•ÂíåÂà†Èô§Âè™ÈúÄË¶Å‰øÆÊîπÁõ∏ÈÇªËäÇÁÇπÁöÑÊåáÈíàÔºåÊìç‰ΩúÁÆÄÂçïÂèàÂø´ÈÄü„ÄÇ</li>
</ul>
<h2 id="quicklist">quicklist
</h2><p>Âú® Redis 3.0 ‰πãÂâçÔºåList ÂØπË±°ÁöÑÂ∫ïÂ±ÇÊï∞ÊçÆÁªìÊûÑÊòØÂèåÂêëÈìæË°®ÊàñËÄÖÂéãÁº©ÂàóË°®„ÄÇÁÑ∂ÂêéÂú® Redis 3.2 ÁöÑÊó∂ÂÄôÔºåList ÂØπË±°ÁöÑÂ∫ïÂ±ÇÊîπÁî± quicklist Êï∞ÊçÆÁªìÊûÑÂÆûÁé∞„ÄÇ</p>
<p>ÂÖ∂ÂÆû quicklist Â∞±ÊòØ„ÄåÂèåÂêëÈìæË°® + ÂéãÁº©ÂàóË°®„ÄçÁªÑÂêàÔºåÂõ†‰∏∫‰∏Ä‰∏™ quicklist Â∞±ÊòØ‰∏Ä‰∏™ÈìæË°®ÔºåËÄåÈìæË°®‰∏≠ÁöÑÊØè‰∏™ÂÖÉÁ¥†ÂèàÊòØ‰∏Ä‰∏™ÂéãÁº©ÂàóË°®„ÄÇ</p>
<p>Âú®ÂâçÈù¢ËÆ≤ÂéãÁº©ÂàóË°®ÁöÑÊó∂ÂÄôÔºåÊàë‰πüÊèêÂà∞‰∫ÜÂéãÁº©ÂàóË°®ÁöÑ‰∏çË∂≥ÔºåËôΩÁÑ∂ÂéãÁº©ÂàóË°®ÊòØÈÄöËøáÁ¥ßÂáëÂûãÁöÑÂÜÖÂ≠òÂ∏ÉÂ±ÄËäÇÁúÅ‰∫ÜÂÜÖÂ≠òÂºÄÈîÄÔºå‰ΩÜÊòØÂõ†‰∏∫ÂÆÉÁöÑÁªìÊûÑËÆæËÆ°ÔºåÂ¶ÇÊûú‰øùÂ≠òÁöÑÂÖÉÁ¥†Êï∞ÈáèÂ¢ûÂä†ÔºåÊàñËÄÖÂÖÉÁ¥†ÂèòÂ§ß‰∫ÜÔºåÂéãÁº©ÂàóË°®‰ºöÊúâ„ÄåËøûÈîÅÊõ¥Êñ∞„ÄçÁöÑÈ£éÈô©Ôºå‰∏ÄÊó¶ÂèëÁîüÔºå‰ºöÈÄ†ÊàêÊÄßËÉΩ‰∏ãÈôç„ÄÇ</p>
<p>quicklist Ëß£ÂÜ≥ÂäûÊ≥ïÔºå<strong>ÈÄöËøáÊéßÂà∂ÊØè‰∏™ÈìæË°®ËäÇÁÇπ‰∏≠ÁöÑÂéãÁº©ÂàóË°®ÁöÑÂ§ßÂ∞èÊàñËÄÖÂÖÉÁ¥†‰∏™Êï∞ÔºåÊù•ËßÑÈÅøËøûÈîÅÊõ¥Êñ∞ÁöÑÈóÆÈ¢ò„ÄÇÂõ†‰∏∫ÂéãÁº©ÂàóË°®ÂÖÉÁ¥†Ë∂äÂ∞ëÊàñË∂äÂ∞èÔºåËøûÈîÅÊõ¥Êñ∞Â∏¶Êù•ÁöÑÂΩ±ÂìçÂ∞±Ë∂äÂ∞èÔºå‰ªéËÄåÊèê‰æõ‰∫ÜÊõ¥Â•ΩÁöÑËÆøÈóÆÊÄßËÉΩ„ÄÇ</strong></p>
<h2 id="listpack">listpack
</h2><p>quicklist ËôΩÁÑ∂ÈÄöËøáÊéßÂà∂ quicklistNode ÁªìÊûÑÈáåÁöÑÂéãÁº©ÂàóË°®ÁöÑÂ§ßÂ∞èÊàñËÄÖÂÖÉÁ¥†‰∏™Êï∞ÔºåÊù•ÂáèÂ∞ëËøûÈîÅÊõ¥Êñ∞Â∏¶Êù•ÁöÑÊÄßËÉΩÂΩ±ÂìçÔºå‰ΩÜÊòØÂπ∂Ê≤°ÊúâÂÆåÂÖ®Ëß£ÂÜ≥ËøûÈîÅÊõ¥Êñ∞ÁöÑÈóÆÈ¢ò„ÄÇ</p>
<p>Âõ†‰∏∫ quicklistNode ËøòÊòØÁî®‰∫ÜÂéãÁº©ÂàóË°®Êù•‰øùÂ≠òÂÖÉÁ¥†ÔºåÂéãÁº©ÂàóË°®ËøûÈîÅÊõ¥Êñ∞ÁöÑÈóÆÈ¢òÔºåÊù•Ê∫ê‰∫éÂÆÉÁöÑÁªìÊûÑËÆæËÆ°ÔºåÊâÄ‰ª•Ë¶ÅÊÉ≥ÂΩªÂ∫ïËß£ÂÜ≥Ëøô‰∏™ÈóÆÈ¢òÔºåÈúÄË¶ÅËÆæËÆ°‰∏Ä‰∏™Êñ∞ÁöÑÊï∞ÊçÆÁªìÊûÑ„ÄÇ</p>
<p>‰∫éÊòØÔºåRedis Âú® 5.0 Êñ∞ËÆæËÆ°‰∏Ä‰∏™Êï∞ÊçÆÁªìÊûÑÂè´ listpackÔºåÁõÆÁöÑÊòØÊõø‰ª£ÂéãÁº©ÂàóË°®ÔºåÂÆÉÊúÄÂ§ßÁâπÁÇπÊòØ listpack ‰∏≠ÊØè‰∏™ËäÇÁÇπ‰∏çÂÜçÂåÖÂê´Ââç‰∏Ä‰∏™ËäÇÁÇπÁöÑÈïøÂ∫¶‰∫ÜÔºåÂéãÁº©ÂàóË°®ÊØè‰∏™ËäÇÁÇπÊ≠£Âõ†‰∏∫ÈúÄË¶Å‰øùÂ≠òÂâç‰∏Ä‰∏™ËäÇÁÇπÁöÑÈïøÂ∫¶Â≠óÊÆµÔºåÂ∞±‰ºöÊúâËøûÈîÅÊõ¥Êñ∞ÁöÑÈöêÊÇ£„ÄÇ</p>
<p><strong>listpack Ê≤°ÊúâÂéãÁº©ÂàóË°®‰∏≠ËÆ∞ÂΩïÂâç‰∏Ä‰∏™ËäÇÁÇπÈïøÂ∫¶ÁöÑÂ≠óÊÆµ‰∫ÜÔºålistpack Âè™ËÆ∞ÂΩïÂΩìÂâçËäÇÁÇπÁöÑÈïøÂ∫¶ÔºåÂΩìÊàë‰ª¨Âêë listpack Âä†ÂÖ•‰∏Ä‰∏™Êñ∞ÂÖÉÁ¥†ÁöÑÊó∂ÂÄôÔºå‰∏ç‰ºöÂΩ±ÂìçÂÖ∂‰ªñËäÇÁÇπÁöÑÈïøÂ∫¶Â≠óÊÆµÁöÑÂèòÂåñÔºå‰ªéËÄåÈÅøÂÖç‰∫ÜÂéãÁº©ÂàóË°®ÁöÑËøûÈîÅÊõ¥Êñ∞ÈóÆÈ¢ò„ÄÇ</strong></p>
<hr>
<blockquote>
<p>ÂõæÁâáÂá∫Â§Ñ‰∏∫Â∞èÊûócoding</p>
</blockquote>
<h1 id="aofÊåÅ‰πÖÂåñ">AOFÊåÅ‰πÖÂåñ
</h1><p>AOFÊñá‰ª∂ÁöÑÂÜÖÂÆπÊòØÊìç‰ΩúÂëΩ‰ª§</p>
<h2 id="aofÊó•Âøó">AOFÊó•Âøó
</h2><p>ÂÖ∂ÊÄùÊÉ≥ÊòØRedisÊØèÊâßË°å‰∏ÄÊù°ÂÜôÊìç‰ΩúÂëΩ‰ª§ÔºåÂ∞±ÊääËØ•ÂëΩ‰ª§‰ª•ËøΩÂä†ÁöÑÊñπÂºèÂÜôÂÖ•Âà∞‰∏Ä‰∏™Êñá‰ª∂ÈáåÔºåÈáçÂêØ Redis ÁöÑÊó∂ÂÄôÔºåÂÖàÂéªËØªÂèñËøô‰∏™Êñá‰ª∂ÈáåÁöÑÂëΩ‰ª§ÔºåÂπ∂‰∏îÊâßË°åÂÆÉÔºåÂ∞±Áõ∏ÂΩì‰∫éÊÅ¢Â§ç‰∫ÜÁºìÂ≠òÊï∞ÊçÆ‰∫Ü„ÄÇ</p>
<p>ÂÆ¢Êà∑Á´ØÂèëÈÄÅÂÜôÂëΩ‰ª§Âà∞Redis„ÄÇÁ¨¨‰∏ÄÊ≠•ÊâßË°åÂÜôÂëΩ‰ª§Âà∞ÂÜÖÂ≠òÔºõÁ¨¨‰∫åÊ≠•ËÆ∞ÂΩïÂëΩ‰ª§Âà∞Êó•ÂøóÔºåÊó•ÂøóÂ≠òÊîæÂà∞Á°¨Áõò„ÄÇ</p>
<p>ËøôÁßç‰øùÂ≠òÂÜôÊìç‰ΩúÂëΩ‰ª§Âà∞Êó•ÂøóÁöÑÊåÅ‰πÖÂåñÊñπÂºèÔºåÂ∞±ÊòØRedisÈáåÁöÑ<strong>AOF</strong>ÔºàAppend Only FileÔºâÊåÅ‰πÖÂåñÂäüËÉΩÔºå<strong>Ê≥®ÊÑèÂè™‰ºöËÆ∞ÂΩïÂÜôÊìç‰ΩúÂëΩ‰ª§ÔºåËØªÊìç‰ΩúÂëΩ‰ª§ÊòØ‰∏ç‰ºöË¢´ËÆ∞ÂΩïÁöÑ</strong>ÔºåÂõ†‰∏∫Ê≤°ÊÑè‰πâ„ÄÇ</p>
<p>Âú®Redis‰∏≠AOFÊåÅ‰πÖÂåñÂäüËÉΩÈªòËÆ§ÊòØ‰∏çÂºÄÂêØÁöÑ„ÄÇ</p>
<p>AOFÊó•ÂøóÊñá‰ª∂ÂÖ∂ÂÆûÂ∞±ÊòØÊôÆÈÄöÁöÑÊñáÊú¨ÔºåÊàë‰ª¨ÂèØ‰ª•ÈÄöËøácatÂëΩ‰ª§Êü•ÁúãÈáåÈù¢ÁöÑÂÜÖÂÆπÔºå‰ΩÜÂÖ∂‰∏≠ËÆ∞ÂΩïÁöÑÂÜÖÂÆπÊúâ‰∏ÄÂÆöÁöÑÈòÖËØªËßÑÂàô„ÄÇ</p>
<p>‰æãÂ¶ÇÔºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">*3
</span></span><span class="line"><span class="cl">$3
</span></span><span class="line"><span class="cl">set
</span></span><span class="line"><span class="cl">$4
</span></span><span class="line"><span class="cl">name
</span></span><span class="line"><span class="cl">$7xiaoxin
</span></span></code></pre></td></tr></table>
</div>
</div><p>„Äå*3„ÄçË°®Á§∫ÂΩìÂâçÂëΩ‰ª§Êúâ‰∏â‰∏™ÈÉ®ÂàÜÔºåÊØèÈÉ®ÂàÜÈÉΩÊòØ‰ª•„Äå$+Êï∞Â≠ó„ÄçÂºÄÂ§¥ÔºåÂêéÈù¢Á¥ßË∑üÁùÄÂÖ∑‰ΩìÁöÑÂëΩ‰ª§„ÄÅÈîÆÊàñÂÄº„ÄÇÁÑ∂ÂêéÔºåËøôÈáåÁöÑ„ÄåÊï∞Â≠ó„ÄçË°®Á§∫ËøôÈÉ®ÂàÜ‰∏≠ÁöÑÂëΩ‰ª§„ÄÅÈîÆÊàñÂÄº‰∏ÄÂÖ±ÊúâÂ§öÂ∞ëÂ≠óËäÇ„ÄÇ‰æãÂ¶ÇÔºå„Äå$3 set„ÄçË°®Á§∫ËøôÈÉ®ÂàÜÊúâ 3 ‰∏™Â≠óËäÇÔºå‰πüÂ∞±ÊòØ„Äåset„ÄçÂëΩ‰ª§Ëøô‰∏™Â≠óÁ¨¶‰∏≤ÁöÑÈïøÂ∫¶„ÄÇ</p>
<p>RedisÂÖàÊâßË°åÂÜôÊìç‰ΩúÂëΩ‰ª§ÂêéÔºåÂÜçÂ∞ÜÂëΩ‰ª§ËÆ∞ÂΩïÂà∞AOFÊó•ÂøóÈáåÔºåÊúâ‰ª•‰∏ã‰∏§‰∏™Â•ΩÂ§ÑÔºö</p>
<ol>
<li>
<p><strong>ÈÅøÂÖçÈ¢ùÂ§ñÁöÑÊ£ÄÊü•ÂºÄÈîÄ</strong></p>
<p>Âõ†‰∏∫Â¶ÇÊûúÂÖàÂ∞ÜÂÜôÊìç‰ΩúÂëΩ‰ª§ËÆ∞ÂΩïÂà∞ AOF Êó•ÂøóÈáåÔºåÂÜçÊâßË°åËØ•ÂëΩ‰ª§ÁöÑËØùÔºåÂ¶ÇÊûúÂΩìÂâçÁöÑÂëΩ‰ª§ËØ≠Ê≥ïÊúâÈóÆÈ¢òÔºåÈÇ£‰πàÂ¶ÇÊûú‰∏çËøõË°åÂëΩ‰ª§ËØ≠Ê≥ïÊ£ÄÊü•ÔºåËØ•ÈîôËØØÁöÑÂëΩ‰ª§ËÆ∞ÂΩïÂà∞ AOF Êó•ÂøóÈáåÂêéÔºåRedis Âú®‰ΩøÁî®Êó•ÂøóÊÅ¢Â§çÊï∞ÊçÆÊó∂ÔºåÂ∞±ÂèØËÉΩ‰ºöÂá∫Èîô„ÄÇ</p>
<p>ËÄåÂ¶ÇÊûúÂÖàÊâßË°åÂÜôÊìç‰ΩúÂëΩ‰ª§ÂÜçËÆ∞ÂΩïÊó•ÂøóÁöÑËØùÔºåÂè™ÊúâÂú®ËØ•ÂëΩ‰ª§ÊâßË°åÊàêÂäüÂêéÔºåÊâçÂ∞ÜÂëΩ‰ª§ËÆ∞ÂΩïÂà∞ AOF Êó•ÂøóÈáåÔºåËøôÊ†∑Â∞±‰∏çÁî®È¢ùÂ§ñÁöÑÊ£ÄÊü•ÂºÄÈîÄÔºå‰øùËØÅËÆ∞ÂΩïÂú® AOF Êó•ÂøóÈáåÁöÑÂëΩ‰ª§ÈÉΩÊòØÂèØÊâßË°åÂπ∂‰∏îÊ≠£Á°ÆÁöÑ„ÄÇ</p>
</li>
<li>
<p><strong>‰∏ç‰ºöÈòªÂ°ûÂΩìÂâçÂÜôÊìç‰ΩúÂëΩ‰ª§ÁöÑÊâßË°å</strong>
ÂΩìÂÜôÊìç‰ΩúÂëΩ‰ª§ÊâßË°åÊàêÂäüÂêéÔºåÊâç‰ºöÂ∞ÜÂëΩ‰ª§ËÆ∞ÂΩïÂà∞ AOF Êó•Âøó„ÄÇ</p>
</li>
</ol>
<p>‰∏§‰∏™È£éÈô©Ôºö</p>
<ol>
<li>ÊâßË°åÂÜôÊìç‰ΩúÂëΩ‰ª§ÂíåËÆ∞ÂΩïÊó•ÂøóÊòØ‰∏§‰∏™ËøáÁ®ãÔºåÈÇ£ÂΩì Redis Âú®ËøòÊ≤°Êù•ÂæóÂèäÂ∞ÜÂëΩ‰ª§ÂÜôÂÖ•Âà∞Á°¨ÁõòÊó∂ÔºåÊúçÂä°Âô®ÂèëÁîüÂÆïÊú∫‰∫ÜÔºåËøô‰∏™Êï∞ÊçÆÂ∞±‰ºöÊúâ<strong>‰∏¢Â§±ÁöÑÈ£éÈô©</strong>„ÄÇ</li>
<li>ÂÜôÊìç‰ΩúÂëΩ‰ª§ÊâßË°åÊàêÂäüÂêéÊâçËÆ∞ÂΩïÂà∞ AOF Êó•ÂøóÔºåÊâÄ‰ª•‰∏ç‰ºöÈòªÂ°ûÂΩìÂâçÂÜôÊìç‰ΩúÂëΩ‰ª§ÁöÑÊâßË°åÔºå‰ΩÜÊòØ<strong>ÂèØËÉΩ‰ºöÁªô„Äå‰∏ã‰∏Ä‰∏™„ÄçÂëΩ‰ª§Â∏¶Êù•ÈòªÂ°ûÈ£éÈô©</strong>„ÄÇÂõ†‰∏∫Â∞ÜÂëΩ‰ª§ÂÜôÂÖ•Âà∞Êó•ÂøóÁöÑËøô‰∏™Êìç‰Ωú‰πüÊòØÂú®‰∏ªËøõÁ®ãÂÆåÊàêÁöÑÔºàÊâßË°åÂëΩ‰ª§‰πüÊòØÂú®‰∏ªËøõÁ®ãÔºâÔºå‰πüÂ∞±ÊòØËØ¥Ëøô‰∏§‰∏™Êìç‰ΩúÊòØÂêåÊ≠•ÁöÑ„ÄÇÂ¶ÇÊûúÂú®Â∞ÜÊó•ÂøóÂÜÖÂÆπÂÜôÂÖ•Âà∞Á°¨ÁõòÊó∂ÔºåÊúçÂä°Âô®ÁöÑÁ°¨ÁõòÁöÑ I/O ÂéãÂäõÂ§™Â§ßÔºåÂ∞±‰ºöÂØºËá¥ÂÜôÁ°¨ÁõòÁöÑÈÄüÂ∫¶ÂæàÊÖ¢ÔºåËøõËÄåÈòªÂ°û‰Ωè‰∫ÜÔºå‰πüÂ∞±‰ºöÂØºËá¥ÂêéÁª≠ÁöÑÂëΩ‰ª§Êó†Ê≥ïÊâßË°å„ÄÇ</li>
</ol>
<p>‰∏§‰∏™È£éÈô©ÁöÑÂÖ±ÊÄßÂ∞±ÊòØË∑ü„Äå AOF Êó•ÂøóÂÜôÂõûÁ°¨ÁõòÁöÑÊó∂Êú∫„ÄçÊúâÂÖ≥„ÄÇ</p>
<h2 id="‰∏âÁßçÂÜôÂõûÁ≠ñÁï•">‰∏âÁßçÂÜôÂõûÁ≠ñÁï•
</h2><p>RedisÂÜôÂÖ•AOFÊó•ÂøóËøáÁ®ãÔºö</p>
<p><img src="/image/AOF%e8%bf%87%e7%a8%8b.png"
	
	
	
	loading="lazy"
	
	
></p>
<ol>
<li>Redis ÊâßË°åÂÆåÂÜôÊìç‰ΩúÂëΩ‰ª§ÂêéÔºå‰ºöÂ∞ÜÂëΩ‰ª§ËøΩÂä†Âà∞ server.aof_buf ÁºìÂÜ≤Âå∫Ôºõ</li>
<li>ÁÑ∂ÂêéÈÄöËøá write() Á≥ªÁªüË∞ÉÁî®ÔºåÂ∞Ü aof_buf ÁºìÂÜ≤Âå∫ÁöÑÊï∞ÊçÆÂÜôÂÖ•Âà∞ AOF Êñá‰ª∂ÔºåÊ≠§Êó∂Êï∞ÊçÆÂπ∂Ê≤°ÊúâÂÜôÂÖ•Âà∞Á°¨ÁõòÔºåËÄåÊòØÊã∑Ë¥ùÂà∞‰∫ÜÂÜÖÊ†∏ÁºìÂÜ≤Âå∫ page cacheÔºåÁ≠âÂæÖÂÜÖÊ†∏Â∞ÜÊï∞ÊçÆÂÜôÂÖ•Á°¨ÁõòÔºõ</li>
<li>ÂÖ∑‰ΩìÂÜÖÊ†∏ÁºìÂÜ≤Âå∫ÁöÑÊï∞ÊçÆ‰ªÄ‰πàÊó∂ÂÄôÂÜôÂÖ•Âà∞Á°¨ÁõòÔºåÁî±ÂÜÖÊ†∏ÂÜ≥ÂÆö„ÄÇ</li>
</ol>
<p>Redis Êèê‰æõ‰∫Ü 3 ÁßçÂÜôÂõûÁ°¨ÁõòÁöÑÁ≠ñÁï•ÔºåÊéßÂà∂ÁöÑÂ∞±ÊòØ‰∏äÈù¢ËØ¥ÁöÑÁ¨¨‰∏âÊ≠•ÁöÑËøáÁ®ã„ÄÇ</p>
<ul>
<li><strong>Always</strong>ÔºåËøô‰∏™ÂçïËØçÁöÑÊÑèÊÄùÊòØ„ÄåÊÄªÊòØ„ÄçÔºåÊâÄ‰ª•ÂÆÉÁöÑÊÑèÊÄùÊòØÊØèÊ¨°ÂÜôÊìç‰ΩúÂëΩ‰ª§ÊâßË°åÂÆåÂêéÔºåÂêåÊ≠•Â∞Ü AOF Êó•ÂøóÊï∞ÊçÆÂÜôÂõûÁ°¨ÁõòÔºõ</li>
<li><strong>Everysec</strong>ÔºåËøô‰∏™ÂçïËØçÁöÑÊÑèÊÄùÊòØ„ÄåÊØèÁßí„ÄçÔºåÊâÄ‰ª•ÂÆÉÁöÑÊÑèÊÄùÊòØÊØèÊ¨°ÂÜôÊìç‰ΩúÂëΩ‰ª§ÊâßË°åÂÆåÂêéÔºåÂÖàÂ∞ÜÂëΩ‰ª§ÂÜôÂÖ•Âà∞ AOF Êñá‰ª∂ÁöÑÂÜÖÊ†∏ÁºìÂÜ≤Âå∫ÔºåÁÑ∂ÂêéÊØèÈöî‰∏ÄÁßíÂ∞ÜÁºìÂÜ≤Âå∫ÈáåÁöÑÂÜÖÂÆπÂÜôÂõûÂà∞Á°¨ÁõòÔºõ</li>
<li><strong>No</strong>ÔºåÊÑèÂë≥ÁùÄ‰∏çÁî± Redis ÊéßÂà∂ÂÜôÂõûÁ°¨ÁõòÁöÑÊó∂Êú∫ÔºåËΩ¨‰∫§ÁªôÊìç‰ΩúÁ≥ªÁªüÊéßÂà∂ÂÜôÂõûÁöÑÊó∂Êú∫Ôºå‰πüÂ∞±ÊòØÊØèÊ¨°ÂÜôÊìç‰ΩúÂëΩ‰ª§ÊâßË°åÂÆåÂêéÔºåÂÖàÂ∞ÜÂëΩ‰ª§ÂÜôÂÖ•Âà∞ AOF Êñá‰ª∂ÁöÑÂÜÖÊ†∏ÁºìÂÜ≤Âå∫ÔºåÂÜçÁî±Êìç‰ΩúÁ≥ªÁªüÂÜ≥ÂÆö‰ΩïÊó∂Â∞ÜÁºìÂÜ≤Âå∫ÂÜÖÂÆπÂÜôÂõûÁ°¨Áõò„ÄÇ</li>
</ul>
<p>Ëøô 3 ÁßçÂÜôÂõûÁ≠ñÁï•ÈÉΩÊó†Ê≥ïËÉΩÂÆåÁæéËß£ÂÜ≥„Äå‰∏ªËøõÁ®ãÈòªÂ°û„ÄçÂíå„ÄåÂáèÂ∞ëÊï∞ÊçÆ‰∏¢Â§±„ÄçÁöÑÈóÆÈ¢òÔºåÂõ†‰∏∫‰∏§‰∏™ÈóÆÈ¢òÊòØÂØπÁ´ãÁöÑÔºåÂÅèÂêë‰∫é‰∏ÄËæπÁöÑËØùÔºåÂ∞±‰ºöË¶ÅÁâ∫Áâ≤Âè¶Â§ñ‰∏ÄËæπÔºåÂéüÂõ†Â¶Ç‰∏ãÔºö</p>
<ul>
<li>Always Á≠ñÁï•ÁöÑËØùÔºåÂèØ‰ª•ÊúÄÂ§ßÁ®ãÂ∫¶‰øùËØÅÊï∞ÊçÆ‰∏ç‰∏¢Â§±Ôºå‰ΩÜÊòØÁî±‰∫éÂÆÉÊØèÊâßË°å‰∏ÄÊù°ÂÜôÊìç‰ΩúÂëΩ‰ª§Â∞±ÂêåÊ≠•Â∞Ü AOF ÂÜÖÂÆπÂÜôÂõûÁ°¨ÁõòÔºåÊâÄ‰ª•ÊòØ‰∏çÂèØÈÅøÂÖç‰ºöÂΩ±Âìç‰∏ªËøõÁ®ãÁöÑÊÄßËÉΩÔºõ</li>
<li>No Á≠ñÁï•ÁöÑËØùÔºåÊòØ‰∫§Áî±Êìç‰ΩúÁ≥ªÁªüÊù•ÂÜ≥ÂÆö‰ΩïÊó∂Â∞Ü AOF Êó•ÂøóÂÜÖÂÆπÂÜôÂõûÁ°¨ÁõòÔºåÁõ∏ÊØî‰∫é Always Á≠ñÁï•ÊÄßËÉΩËæÉÂ•ΩÔºå‰ΩÜÊòØÊìç‰ΩúÁ≥ªÁªüÂÜôÂõûÁ°¨ÁõòÁöÑÊó∂Êú∫ÊòØ‰∏çÂèØÈ¢ÑÁü•ÁöÑÔºåÂ¶ÇÊûú AOF Êó•ÂøóÂÜÖÂÆπÊ≤°ÊúâÂÜôÂõûÁ°¨ÁõòÔºå‰∏ÄÊó¶ÊúçÂä°Âô®ÂÆïÊú∫ÔºåÂ∞±‰ºö‰∏¢Â§±‰∏çÂÆöÊï∞ÈáèÁöÑÊï∞ÊçÆ„ÄÇ</li>
<li>Everysec Á≠ñÁï•ÁöÑËØùÔºåÊòØÊäò‰∏≠ÁöÑ‰∏ÄÁßçÊñπÂºèÔºåÈÅøÂÖç‰∫Ü Always Á≠ñÁï•ÁöÑÊÄßËÉΩÂºÄÈîÄÔºå‰πüÊØî No Á≠ñÁï•Êõ¥ËÉΩÈÅøÂÖçÊï∞ÊçÆ‰∏¢Â§±ÔºåÂΩìÁÑ∂Â¶ÇÊûú‰∏ä‰∏ÄÁßíÁöÑÂÜôÊìç‰ΩúÂëΩ‰ª§Êó•ÂøóÊ≤°ÊúâÂÜôÂõûÂà∞Á°¨ÁõòÔºåÂèëÁîü‰∫ÜÂÆïÊú∫ÔºåËøô‰∏ÄÁßíÂÜÖÁöÑÊï∞ÊçÆËá™ÁÑ∂‰πü‰ºö‰∏¢Â§±„ÄÇ</li>
</ul>
<p>Ê†πÊçÆËá™Â∑±ÁöÑ‰∏öÂä°Âú∫ÊôØËøõË°åÈÄâÊã©Ôºö</p>
<ul>
<li>Â¶ÇÊûúË¶ÅÈ´òÊÄßËÉΩÔºåÂ∞±ÈÄâÊã© No Á≠ñÁï•Ôºõ</li>
<li>Â¶ÇÊûúË¶ÅÈ´òÂèØÈù†ÔºåÂ∞±ÈÄâÊã© Always Á≠ñÁï•Ôºõ</li>
<li>Â¶ÇÊûúÂÖÅËÆ∏Êï∞ÊçÆ‰∏¢Â§±‰∏ÄÁÇπÔºå‰ΩÜÂèàÊÉ≥ÊÄßËÉΩÈ´òÔºåÂ∞±ÈÄâÊã© Everysec Á≠ñÁï•„ÄÇ</li>
</ul>
<p><strong>‰ª•‰∏ä‰∏âÁßçÁ≠ñÁï•ÂÖ∂ÂÆûÊòØÂú®ÊéßÂà∂fsync()ÂáΩÊï∞ÁöÑË∞ÉÁî®Êó∂Êú∫Ôºö</strong></p>
<p>Â¶ÇÊûúÊÉ≥Ë¶ÅÂ∫îÁî®Á®ãÂ∫èÂêëÊñá‰ª∂ÂÜôÂÖ•Êï∞ÊçÆÂêéÔºåËÉΩÁ´ãÈ©¨Â∞ÜÊï∞ÊçÆÂêåÊ≠•Âà∞Á°¨ÁõòÔºåÂ∞±ÂèØ‰ª•Ë∞ÉÁî® fsync() ÂáΩÊï∞ÔºåËøôÊ†∑ÂÜÖÊ†∏Â∞±‰ºöÂ∞ÜÂÜÖÊ†∏ÁºìÂÜ≤Âå∫ÁöÑÊï∞ÊçÆÁõ¥Êé•ÂÜôÂÖ•Âà∞Á°¨ÁõòÔºåÁ≠âÂà∞Á°¨ÁõòÂÜôÊìç‰ΩúÂÆåÊàêÂêéÔºåËØ•ÂáΩÊï∞Êâç‰ºöËøîÂõû„ÄÇ</p>
<ul>
<li>Always Á≠ñÁï•Â∞±ÊòØÊØèÊ¨°ÂÜôÂÖ• AOF Êñá‰ª∂Êï∞ÊçÆÂêéÔºåÂ∞±ÊâßË°å fsync() ÂáΩÊï∞Ôºõ</li>
<li>Everysec Á≠ñÁï•Â∞±‰ºöÂàõÂª∫‰∏Ä‰∏™ÂºÇÊ≠•‰ªªÂä°Êù•ÊâßË°å fsync() ÂáΩÊï∞Ôºõ</li>
<li>No Á≠ñÁï•Â∞±ÊòØÊ∞∏‰∏çÊâßË°å fsync() ÂáΩÊï∞</li>
</ul>
<h2 id="aofÈáçÂÜôÊú∫Âà∂">AOFÈáçÂÜôÊú∫Âà∂
</h2><p>AOF Êó•ÂøóÊòØ‰∏Ä‰∏™Êñá‰ª∂ÔºåÈöèÁùÄÊâßË°åÁöÑÂÜôÊìç‰ΩúÂëΩ‰ª§Ë∂äÊù•Ë∂äÂ§öÔºåÊñá‰ª∂ÁöÑÂ§ßÂ∞è‰ºöË∂äÊù•Ë∂äÂ§ß„ÄÇ</p>
<p>Â¶ÇÊûúÂΩì AOF Êó•ÂøóÊñá‰ª∂ËøáÂ§ßÂ∞±‰ºöÂ∏¶Êù•ÊÄßËÉΩÈóÆÈ¢òÔºåÊØîÂ¶ÇÈáçÂêØ Redis ÂêéÔºåÈúÄË¶ÅËØª AOF Êñá‰ª∂ÁöÑÂÜÖÂÆπ‰ª•ÊÅ¢Â§çÊï∞ÊçÆÔºåÂ¶ÇÊûúÊñá‰ª∂ËøáÂ§ßÔºåÊï¥‰∏™ÊÅ¢Â§çÁöÑËøáÁ®ãÂ∞±‰ºöÂæàÊÖ¢„ÄÇ</p>
<p>ÊâÄ‰ª•ÔºåRedis ‰∏∫‰∫ÜÈÅøÂÖç AOF Êñá‰ª∂Ë∂äÂÜôË∂äÂ§ßÔºåÊèê‰æõ‰∫Ü <strong>AOF ÈáçÂÜôÊú∫Âà∂</strong>ÔºåÂΩì AOF Êñá‰ª∂ÁöÑÂ§ßÂ∞èË∂ÖËøáÊâÄËÆæÂÆöÁöÑÈòàÂÄºÂêéÔºåRedis Â∞±‰ºöÂêØÁî® AOF ÈáçÂÜôÊú∫Âà∂ÔºåÊù•ÂéãÁº© AOF Êñá‰ª∂„ÄÇ</p>
<p>AOF ÈáçÂÜôÊú∫Âà∂ÊòØÂú®ÈáçÂÜôÊó∂ÔºåËØªÂèñÂΩìÂâçÊï∞ÊçÆÂ∫ì‰∏≠ÁöÑÊâÄÊúâÈîÆÂÄºÂØπÔºåÁÑ∂ÂêéÂ∞ÜÊØè‰∏Ä‰∏™ÈîÆÂÄºÂØπÁî®‰∏ÄÊù°ÂëΩ‰ª§ËÆ∞ÂΩïÂà∞„ÄåÊñ∞ÁöÑ AOF Êñá‰ª∂„ÄçÔºåÁ≠âÂà∞ÂÖ®ÈÉ®ËÆ∞ÂΩïÂÆåÂêéÔºåÂ∞±Â∞ÜÊñ∞ÁöÑ AOF Êñá‰ª∂ÊõøÊç¢ÊéâÁé∞ÊúâÁöÑ AOF Êñá‰ª∂„ÄÇ</p>
<p>ÈáçÂÜôÂ∑•‰ΩúÂÆåÊàêÂêéÔºåÂ∞±‰ºöÂ∞ÜÊñ∞ÁöÑ AOF Êñá‰ª∂Ë¶ÜÁõñÁé∞ÊúâÁöÑ AOF Êñá‰ª∂ÔºåËøôÂ∞±Áõ∏ÂΩì‰∫éÂéãÁº©‰∫Ü AOF Êñá‰ª∂Ôºå‰ΩøÂæó AOF Êñá‰ª∂‰ΩìÁßØÂèòÂ∞è‰∫Ü„ÄÇ</p>
<p>ÁÑ∂ÂêéÔºåÂú®ÈÄöËøá AOF Êó•ÂøóÊÅ¢Â§çÊï∞ÊçÆÊó∂ÔºåÂè™Áî®ÊâßË°åËøôÊù°ÂëΩ‰ª§ÔºåÂ∞±ÂèØ‰ª•Áõ¥Êé•ÂÆåÊàêËøô‰∏™ÈîÆÂÄºÂØπÁöÑÂÜôÂÖ•‰∫Ü„ÄÇ</p>
<p>ÊâÄ‰ª•ÔºåÈáçÂÜôÊú∫Âà∂ÁöÑÂ¶ôÂ§ÑÂú®‰∫éÔºåÂ∞ΩÁÆ°Êüê‰∏™ÈîÆÂÄºÂØπË¢´Â§öÊù°ÂÜôÂëΩ‰ª§ÂèçÂ§ç‰øÆÊîπÔºå<strong>ÊúÄÁªà‰πüÂè™ÈúÄË¶ÅÊ†πÊçÆËøô‰∏™„ÄåÈîÆÂÄºÂØπ„ÄçÂΩìÂâçÁöÑÊúÄÊñ∞Áä∂ÊÄÅÔºåÁÑ∂ÂêéÁî®‰∏ÄÊù°ÂëΩ‰ª§ÂéªËÆ∞ÂΩïÈîÆÂÄºÂØπ</strong>Ôºå‰ª£Êõø‰πãÂâçËÆ∞ÂΩïËøô‰∏™ÈîÆÂÄºÂØπÁöÑÂ§öÊù°ÂëΩ‰ª§ÔºåËøôÊ†∑Â∞±ÂáèÂ∞ë‰∫Ü AOF Êñá‰ª∂‰∏≠ÁöÑÂëΩ‰ª§Êï∞Èáè„ÄÇÊúÄÂêéÂú®ÈáçÂÜôÂ∑•‰ΩúÂÆåÊàêÂêéÔºåÂ∞ÜÊñ∞ÁöÑ AOF Êñá‰ª∂Ë¶ÜÁõñÁé∞ÊúâÁöÑ AOF Êñá‰ª∂„ÄÇ</p>
<p><strong>‰∏∫‰ªÄ‰πàÈáçÂÜô AOF ÁöÑÊó∂ÂÄôÔºå‰∏çÁõ¥Êé•Â§çÁî®Áé∞ÊúâÁöÑ AOF Êñá‰ª∂ÔºåËÄåÊòØÂÖàÂÜôÂà∞Êñ∞ÁöÑ AOF Êñá‰ª∂ÂÜçË¶ÜÁõñËøáÂéªÂë¢Ôºü</strong></p>
<p>Âõ†‰∏∫<strong>Â¶ÇÊûú AOF ÈáçÂÜôËøáÁ®ã‰∏≠Â§±Ë¥•‰∫ÜÔºåÁé∞ÊúâÁöÑ AOF Êñá‰ª∂Â∞±‰ºöÈÄ†ÊàêÊ±°Êüì</strong>ÔºåÂèØËÉΩÊó†Ê≥ïÁî®‰∫éÊÅ¢Â§ç‰ΩøÁî®„ÄÇ</p>
<p>ÊâÄ‰ª• AOF ÈáçÂÜôËøáÁ®ãÔºåÂÖàÈáçÂÜôÂà∞Êñ∞ÁöÑ AOF Êñá‰ª∂ÔºåÈáçÂÜôÂ§±Ë¥•ÁöÑËØùÔºåÂ∞±Áõ¥Êé•Âà†Èô§Ëøô‰∏™Êñá‰ª∂Â∞±Â•ΩÔºå‰∏ç‰ºöÂØπÁé∞ÊúâÁöÑ AOF Êñá‰ª∂ÈÄ†ÊàêÂΩ±Âìç„ÄÇ</p>
<h2 id="aofÂêéÂè∞ÈáçÂÜô">AOFÂêéÂè∞ÈáçÂÜô
</h2><p>ÂÜôÂÖ• AOF Êó•ÂøóÁöÑÊìç‰ΩúËôΩÁÑ∂ÊòØÂú®‰∏ªËøõÁ®ãÂÆåÊàêÁöÑÔºåÂõ†‰∏∫ÂÆÉÂÜôÂÖ•ÁöÑÂÜÖÂÆπ‰∏çÂ§öÔºåÊâÄ‰ª•‰∏ÄËà¨‰∏çÂ§™ÂΩ±ÂìçÂëΩ‰ª§ÁöÑÊìç‰Ωú„ÄÇ</p>
<p>‰ΩÜÈáçÂÜôËøô‰∏™ËøáÁ®ãÂÖ∂ÂÆûÊòØÂæàËÄóÊó∂ÁöÑÔºåÂõ†‰∏∫ÈúÄË¶ÅËØªÂèñÊâÄÊúâÁºìÂ≠òÁöÑÈîÆÂÄºÂØπÊï∞ÊçÆÔºåÂπ∂‰∏∫ÊØè‰∏™ÈîÆÂÄºÂØπÁîüÊàê‰∏ÄÊù°ÂëΩ‰ª§ÔºåÁÑ∂ÂêéÂ∞ÜÂÖ∂ÂÜôÂÖ•Âà∞Êñ∞ÁöÑ AOF Êñá‰ª∂„ÄÇÊâÄ‰ª•ÈáçÂÜôÁöÑÊìç‰Ωú‰∏çËÉΩÊîæÂú®‰∏ªËøõÁ®ãÈáå„ÄÇ</p>
<p>Âõ†Ê≠§ÔºåRedis ÁöÑ<strong>ÈáçÂÜô AOF ËøáÁ®ãÊòØÁî±ÂêéÂè∞Â≠êËøõÁ®ã bgrewriteaof Êù•ÂÆåÊàêÁöÑ</strong>ÔºåËøô‰πàÂÅöÂèØ‰ª•ËææÂà∞‰∏§‰∏™Â•ΩÂ§ÑÔºö</p>
<ul>
<li>Â≠êËøõÁ®ãËøõË°å AOF ÈáçÂÜôÊúüÈó¥Ôºå‰∏ªËøõÁ®ãÂèØ‰ª•ÁªßÁª≠Â§ÑÁêÜÂëΩ‰ª§ËØ∑Ê±ÇÔºå‰ªéËÄåÈÅøÂÖçÈòªÂ°û‰∏ªËøõÁ®ãÔºõ</li>
<li>Â≠êËøõÁ®ãÂ∏¶Êúâ‰∏ªËøõÁ®ãÁöÑ<strong>Êï∞ÊçÆÂâØÊú¨</strong>ÔºåËøôÈáå‰ΩøÁî®Â≠êËøõÁ®ãËÄå‰∏çÊòØÁ∫øÁ®ãÔºåÂõ†‰∏∫Â¶ÇÊûúÊòØ‰ΩøÁî®Á∫øÁ®ãÔºåÂ§öÁ∫øÁ®ã‰πãÈó¥‰ºöÂÖ±‰∫´ÂÜÖÂ≠òÔºåÈÇ£‰πàÂú®‰øÆÊîπÂÖ±‰∫´ÂÜÖÂ≠òÊï∞ÊçÆÁöÑÊó∂ÂÄôÔºåÈúÄË¶ÅÈÄöËøáÂä†ÈîÅÊù•‰øùËØÅÊï∞ÊçÆÁöÑÂÆâÂÖ®ÔºåËÄåËøôÊ†∑Â∞±‰ºöÈôç‰ΩéÊÄßËÉΩ„ÄÇËÄå‰ΩøÁî®Â≠êËøõÁ®ãÔºåÂàõÂª∫Â≠êËøõÁ®ãÊó∂ÔºåÁà∂Â≠êËøõÁ®ãÊòØÂÖ±‰∫´ÂÜÖÂ≠òÊï∞ÊçÆÁöÑÔºå‰∏çËøáËøô‰∏™ÂÖ±‰∫´ÁöÑÂÜÖÂ≠òÂè™ËÉΩ‰ª•Âè™ËØªÁöÑÊñπÂºèÔºåËÄåÂΩìÁà∂Â≠êËøõÁ®ã‰ªªÊÑè‰∏ÄÊñπ‰øÆÊîπ‰∫ÜËØ•ÂÖ±‰∫´ÂÜÖÂ≠òÔºåÂ∞±‰ºöÂèëÁîü„ÄåÂÜôÊó∂Â§çÂà∂„ÄçÔºå‰∫éÊòØÁà∂Â≠êËøõÁ®ãÂ∞±Êúâ‰∫ÜÁã¨Á´ãÁöÑÊï∞ÊçÆÂâØÊú¨ÔºåÂ∞±‰∏çÁî®Âä†ÈîÅÊù•‰øùËØÅÊï∞ÊçÆÂÆâÂÖ®„ÄÇ</li>
</ul>
<p><strong>Â≠êËøõÁ®ãÊòØÊÄé‰πàÊã•Êúâ‰∏ªËøõÁ®ã‰∏ÄÊ†∑ÁöÑÊï∞ÊçÆÂâØÊú¨ÁöÑÂë¢Ôºü</strong></p>
<p>‰∏ªËøõÁ®ãÂú®ÈÄöËøá fork Á≥ªÁªüË∞ÉÁî®ÁîüÊàê bgrewriteaof Â≠êËøõÁ®ãÊó∂ÔºåÊìç‰ΩúÁ≥ªÁªü‰ºöÊää‰∏ªËøõÁ®ãÁöÑ„Äå<strong>È°µË°®</strong>„ÄçÂ§çÂà∂‰∏Ä‰ªΩÁªôÂ≠êËøõÁ®ãÔºåËøô‰∏™È°µË°®ËÆ∞ÂΩïÁùÄËôöÊãüÂú∞ÂùÄÂíåÁâ©ÁêÜÂú∞ÂùÄÊò†Â∞ÑÂÖ≥Á≥ªÔºåËÄå‰∏ç‰ºöÂ§çÂà∂Áâ©ÁêÜÂÜÖÂ≠òÔºå‰πüÂ∞±ÊòØËØ¥Ôºå‰∏§ËÄÖÁöÑËôöÊãüÁ©∫Èó¥‰∏çÂêåÔºå‰ΩÜÂÖ∂ÂØπÂ∫îÁöÑÁâ©ÁêÜÁ©∫Èó¥ÊòØÂêå‰∏Ä‰∏™„ÄÇ</p>
<p>ËøôÊ†∑‰∏ÄÊù•ÔºåÂ≠êËøõÁ®ãÂ∞±ÂÖ±‰∫´‰∫ÜÁà∂ËøõÁ®ãÁöÑÁâ©ÁêÜÂÜÖÂ≠òÊï∞ÊçÆ‰∫ÜÔºåËøôÊ†∑ËÉΩÂ§ü<strong>ËäÇÁ∫¶Áâ©ÁêÜÂÜÖÂ≠òËµÑÊ∫ê</strong>ÔºåÈ°µË°®ÂØπÂ∫îÁöÑÈ°µË°®È°πÁöÑÂ±ûÊÄß‰ºöÊ†áËÆ∞ËØ•Áâ©ÁêÜÂÜÖÂ≠òÁöÑÊùÉÈôê‰∏∫<strong>Âè™ËØª</strong>„ÄÇ</p>
<p>‰∏çËøáÔºåÂΩìÁà∂ËøõÁ®ãÊàñËÄÖÂ≠êËøõÁ®ãÂú®ÂêëËøô‰∏™ÂÜÖÂ≠òÂèëËµ∑ÂÜôÊìç‰ΩúÊó∂ÔºåCPU Â∞±‰ºöËß¶Âèë<strong>ÂÜô‰øùÊä§‰∏≠Êñ≠</strong>ÔºåËøô‰∏™ÂÜô‰øùÊä§‰∏≠Êñ≠ÊòØÁî±‰∫éËøùÂèçÊùÉÈôêÂØºËá¥ÁöÑÔºåÁÑ∂ÂêéÊìç‰ΩúÁ≥ªÁªü‰ºöÂú®„ÄåÂÜô‰øùÊä§‰∏≠Êñ≠Â§ÑÁêÜÂáΩÊï∞„ÄçÈáåËøõË°å<strong>Áâ©ÁêÜÂÜÖÂ≠òÁöÑÂ§çÂà∂</strong>ÔºåÂπ∂ÈáçÊñ∞ËÆæÁΩÆÂÖ∂ÂÜÖÂ≠òÊò†Â∞ÑÂÖ≥Á≥ªÔºåÂ∞ÜÁà∂Â≠êËøõÁ®ãÁöÑÂÜÖÂ≠òËØªÂÜôÊùÉÈôêËÆæÁΩÆ‰∏∫ÂèØËØªÂÜôÔºåÊúÄÂêéÊâç‰ºöÂØπÂÜÖÂ≠òËøõË°åÂÜôÊìç‰ΩúÔºåËøô‰∏™ËøáÁ®ãË¢´Áß∞‰∏∫„Äå<strong>ÂÜôÊó∂Â§çÂà∂(Copy On Write)</strong>„Äç„ÄÇ</p>
<p>ÂÜôÊó∂Â§çÂà∂È°æÂêçÊÄù‰πâÔºå<strong>Âú®ÂèëÁîüÂÜôÊìç‰ΩúÁöÑÊó∂ÂÄôÔºåÊìç‰ΩúÁ≥ªÁªüÊâç‰ºöÂéªÂ§çÂà∂Áâ©ÁêÜÂÜÖÂ≠ò</strong>ÔºåËøôÊ†∑ÊòØ‰∏∫‰∫ÜÈò≤Ê≠¢ fork ÂàõÂª∫Â≠êËøõÁ®ãÊó∂ÔºåÁî±‰∫éÁâ©ÁêÜÂÜÖÂ≠òÊï∞ÊçÆÁöÑÂ§çÂà∂Êó∂Èó¥ËøáÈïøËÄåÂØºËá¥Áà∂ËøõÁ®ãÈïøÊó∂Èó¥ÈòªÂ°ûÁöÑÈóÆÈ¢ò„ÄÇ</p>
<h2 id="ÊÄªÁªì-1">ÊÄªÁªì
</h2><p>Redis Êèê‰æõ‰∫Ü‰∏âÁßçÂ∞Ü AOF Êó•ÂøóÂÜôÂõûÁ°¨ÁõòÁöÑÁ≠ñÁï•ÔºåÂàÜÂà´ÊòØ Always„ÄÅEverysec Âíå NoÔºåËøô‰∏âÁßçÁ≠ñÁï•Âú®ÂèØÈù†ÊÄß‰∏äÊòØ‰ªéÈ´òÂà∞‰ΩéÔºåËÄåÂú®ÊÄßËÉΩ‰∏äÂàôÊòØ‰ªé‰ΩéÂà∞È´ò„ÄÇ</p>
<p>ÈöèÁùÄÊâßË°åÁöÑÂëΩ‰ª§Ë∂äÂ§öÔºåAOF Êñá‰ª∂ÁöÑ‰ΩìÁßØËá™ÁÑ∂‰πü‰ºöË∂äÊù•Ë∂äÂ§ßÔºå‰∏∫‰∫ÜÈÅøÂÖçÊó•ÂøóÊñá‰ª∂ËøáÂ§ßÔºå Redis Êèê‰æõ‰∫Ü AOF ÈáçÂÜôÊú∫Âà∂ÔºåÂÆÉ‰ºöÁõ¥Êé•Êâ´ÊèèÊï∞ÊçÆ‰∏≠ÊâÄÊúâÁöÑÈîÆÂÄºÂØπÊï∞ÊçÆÔºåÁÑ∂Âêé‰∏∫ÊØè‰∏Ä‰∏™ÈîÆÂÄºÂØπÁîüÊàê‰∏ÄÊù°ÂÜôÊìç‰ΩúÂëΩ‰ª§ÔºåÊé•ÁùÄÂ∞ÜËØ•ÂëΩ‰ª§ÂÜôÂÖ•Âà∞Êñ∞ÁöÑ AOF Êñá‰ª∂ÔºåÈáçÂÜôÂÆåÊàêÂêéÔºåÂ∞±ÊõøÊç¢ÊéâÁé∞ÊúâÁöÑ AOF Êó•Âøó„ÄÇÈáçÂÜôÁöÑËøáÁ®ãÊòØÁî±ÂêéÂè∞Â≠êËøõÁ®ãÂÆåÊàêÁöÑÔºåËøôÊ†∑ÂèØ‰ª•‰ΩøÂæó‰∏ªËøõÁ®ãÂèØ‰ª•ÁªßÁª≠Ê≠£Â∏∏Â§ÑÁêÜÂëΩ‰ª§„ÄÇ</p>
<p>Áî® AOF Êó•ÂøóÁöÑÊñπÂºèÊù•ÊÅ¢Â§çÊï∞ÊçÆÂÖ∂ÂÆûÊòØÂæàÊÖ¢ÁöÑÔºåÂõ†‰∏∫ Redis ÊâßË°åÂëΩ‰ª§Áî±ÂçïÁ∫øÁ®ãË¥üË¥£ÁöÑÔºåËÄå AOF Êó•ÂøóÊÅ¢Â§çÊï∞ÊçÆÁöÑÊñπÂºèÊòØÈ°∫Â∫èÊâßË°åÊó•ÂøóÈáåÁöÑÊØè‰∏ÄÊù°ÂëΩ‰ª§ÔºåÂ¶ÇÊûú AOF Êó•ÂøóÂæàÂ§ßÔºåËøô‰∏™„ÄåÈáçÊîæ„ÄçÁöÑËøáÁ®ãÂ∞±‰ºöÂæàÊÖ¢‰∫Ü„ÄÇ</p>

</section>


    <footer class="article-footer">
    

    </footer>


    
</article>

    

    

     
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2022 - 
        
        2024 ÂàòÁÖúÈºé
    </section>
    
    <section class="powerby">
        ‰ΩøÁî® <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> ÊûÑÂª∫ <br />
        ‰∏ªÈ¢ò <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.27.0">Stack</a></b> Áî± <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a> ËÆæËÆ°
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
